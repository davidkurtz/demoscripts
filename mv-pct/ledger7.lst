Connected.
00:51:02 SQL> alter session set nls_date_Format = 'hh24:mi:ss dd/mm/yyyy';

Session altered.

Elapsed: 00:00:00.00
00:51:02 SQL> drop table ps_ledger purge;

Table dropped.

Elapsed: 00:00:04.09
00:51:06 SQL> drop materialized view mv_ledger_2019;

Materialized view dropped.

Elapsed: 00:00:00.66
00:51:07 SQL> drop table mv_ledger_2019 purge;
drop table mv_ledger_2019 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
00:51:07 SQL> drop materialized view mv_ledger_2020;

Materialized view dropped.

Elapsed: 00:00:00.66
00:51:08 SQL> drop table mv_ledger_2020 purge;
drop table mv_ledger_2020 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
00:51:08 SQL> DROP TABLE PSTREESELECT05 PURGE;

Table dropped.

Elapsed: 00:00:00.08
00:51:08 SQL> DROP TABLE PSTREESELECT10 PURGE;

Table dropped.

Elapsed: 00:00:00.27
00:51:08 SQL> purge recyclebin;

Recyclebin purged.

Elapsed: 00:00:00.00
00:51:08 SQL> 
00:51:08 SQL> CREATE TABLE ps_ledger
00:51:08   2  (business_unit VARCHAR2(5) NOT NULL
00:51:08   3  ,ledger VARCHAR2(10) NOT NULL
00:51:08   4  ,account VARCHAR2(10) NOT NULL
00:51:08   5  ,altacct VARCHAR2(10) NOT NULL
00:51:08   6  ,deptid VARCHAR2(10) NOT NULL
00:51:08   7  ,operating_unit VARCHAR2(8) NOT NULL
00:51:08   8  ,product VARCHAR2(6) NOT NULL
00:51:08   9  ,fund_code VARCHAR2(5) NOT NULL
00:51:08  10  ,class_fld VARCHAR2(5) NOT NULL
00:51:08  11  ,program_code VARCHAR2(5) NOT NULL
00:51:08  12  ,budget_ref VARCHAR2(8) NOT NULL
00:51:08  13  ,affiliate VARCHAR2(5) NOT NULL
00:51:08  14  ,affiliate_intra1 VARCHAR2(10) NOT NULL
00:51:08  15  ,affiliate_intra2 VARCHAR2(10) NOT NULL
00:51:08  16  ,chartfield1 VARCHAR2(10) NOT NULL
00:51:08  17  ,chartfield2 VARCHAR2(10) NOT NULL
00:51:08  18  ,chartfield3 VARCHAR2(10) NOT NULL
00:51:08  19  ,project_id VARCHAR2(15) NOT NULL
00:51:08  20  ,book_code VARCHAR2(4) NOT NULL
00:51:08  21  ,gl_adjust_type VARCHAR2(4) NOT NULL
00:51:08  22  ,currency_cd VARCHAR2(3) NOT NULL
00:51:08  23  ,statistics_code VARCHAR2(3) NOT NULL
00:51:08  24  ,fiscal_year SMALLINT NOT NULL
00:51:08  25  ,accounting_period SMALLINT NOT NULL
00:51:08  26  ,posted_total_amt DECIMAL(26,3) NOT NULL
00:51:08  27  ,posted_base_amt DECIMAL(26,3) NOT NULL
00:51:08  28  ,posted_tran_amt DECIMAL(26,3) NOT NULL
00:51:08  29  ,base_currency VARCHAR2(3) NOT NULL
00:51:08  30  ,dttm_stamp_sec TIMESTAMP
00:51:08  31  ,process_instance DECIMAL(10) NOT NULL
00:51:08  32  ) PCTFREE 10 PCTUSED 80
00:51:08  33  PARTITION BY RANGE (ACCOUNTING_PERIOD)
00:51:08  34  SUBPARTITION BY RANGE (FISCAL_YEAR)
00:51:08  35  SUBPARTITION TEMPLATE
00:51:08  36  (SUBPARTITION ledger_2018 VALUES LESS THAN (2019)
00:51:08  37  ,SUBPARTITION ledger_2019 VALUES LESS THAN (2020)
00:51:08  38  ,SUBPARTITION ledger_2020 VALUES LESS THAN (2021)
00:51:08  39  ,SUBPARTITION ledger_2021 VALUES LESS THAN (2022))
00:51:08  40  (PARTITION ap_bf VALUES LESS THAN (1)
00:51:08  41  ,PARTITION ap_01 VALUES LESS THAN (2)
00:51:08  42  ,PARTITION ap_02 VALUES LESS THAN (3)
00:51:08  43  ,PARTITION ap_03 VALUES LESS THAN (4)
00:51:08  44  ,PARTITION ap_04 VALUES LESS THAN (5)
00:51:08  45  ,PARTITION ap_05 VALUES LESS THAN (6)
00:51:08  46  ,PARTITION ap_06 VALUES LESS THAN (7)
00:51:08  47  ,PARTITION ap_07 VALUES LESS THAN (8)
00:51:08  48  ,PARTITION ap_08 VALUES LESS THAN (9)
00:51:08  49  ,PARTITION ap_09 VALUES LESS THAN (10)
00:51:08  50  ,PARTITION ap_10 VALUES LESS THAN (11)
00:51:08  51  ,PARTITION ap_11 VALUES LESS THAN (12)
00:51:08  52  ,PARTITION ap_12 VALUES LESS THAN (13)
00:51:08  53  ,PARTITION ap_cf VALUES LESS THAN (MAXVALUE))
00:51:08  54  ENABLE ROW MOVEMENT NOLOGGING
00:51:08  55  /

Table created.

Elapsed: 00:00:00.25
00:51:08 SQL> 
00:51:08 SQL> set serveroutput on
00:51:08 SQL> DECLARE
00:51:08   2   l_sql CLOB;
00:51:08   3  BEGIN
00:51:08   4   FOR i IN (
00:51:08   5  	select *
00:51:08   6  	from user_tab_subpartitions
00:51:08   7  	where table_name = 'PS_LEDGER'
00:51:08   8  	and subpartition_name like 'AP%LEDGER%201%'
00:51:08   9  	and (compression = 'DISABLED' OR pct_free>0)
00:51:08  10  	order by table_name, partition_position, subpartition_position
00:51:08  11   ) LOOP
00:51:08  12  	l_sql := 'ALTER TABLE '||i.table_name||' MOVE SUBPARTITION '||i.subpartition_name||' COMPRESS UPDATE INDEXES';
00:51:08  13  	dbms_output.put_line(l_sql);
00:51:08  14  	EXECUTE IMMEDIATE l_sql;
00:51:08  15   END LOOP;
00:51:08  16  END;
00:51:08  17  /
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_BF_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_BF_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_01_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_01_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_02_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_02_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_03_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_03_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_04_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_04_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_05_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_05_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_06_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_06_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_07_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_07_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_08_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_08_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_09_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_09_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_10_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_10_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_11_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_11_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_12_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_12_LEDGER_2019 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_CF_LEDGER_2018 COMPRESS UPDATE INDEXES
ALTER TABLE PS_LEDGER MOVE SUBPARTITION AP_CF_LEDGER_2019 COMPRESS UPDATE INDEXES

PL/SQL procedure successfully completed.

Elapsed: 00:00:02.74
00:51:11 SQL> 
00:51:11 SQL> @treeselectors
00:51:11 SQL> REM treeselectors.sql
00:51:11 SQL> 
00:51:11 SQL> DROP TABLE PSTREESELECT05 PURGE;
DROP TABLE PSTREESELECT05 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
00:51:11 SQL> CREATE TABLE PSTREESELECT05
00:51:11   2  (SELECTOR_NUM INTEGER NOT NULL,
00:51:11   3   TREE_NODE_NUM INTEGER NOT NULL,
00:51:11   4   RANGE_FROM_05 VARCHAR2(05) NOT NULL,
00:51:11   5   RANGE_TO_05   VARCHAR2(05) NOT NULL)
00:51:11   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
00:51:11   7   (PARTITION pstreeselector VALUES LESS THAN (2))
00:51:11   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.05
00:51:11 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT05 ON PSTREESELECT05 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_05);

Index created.

Elapsed: 00:00:00.02
00:51:11 SQL> 
00:51:11 SQL> DROP TABLE PSTREESELECT10 PURGE;
DROP TABLE PSTREESELECT10 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
00:51:11 SQL> CREATE TABLE PSTREESELECT10
00:51:11   2  (SELECTOR_NUM INTEGER NOT NULL,
00:51:11   3   TREE_NODE_NUM INTEGER NOT NULL,
00:51:11   4   RANGE_FROM_10 VARCHAR2(10) NOT NULL,
00:51:11   5   RANGE_TO_10   VARCHAR2(10) NOT NULL)
00:51:11   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
00:51:11   7   (PARTITION pstreeselector VALUES LESS THAN (2))
00:51:11   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.03
00:51:11 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT10 ON PSTREESELECT10 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_10);

Index created.

Elapsed: 00:00:00.01
00:51:11 SQL> 
00:51:11 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
00:51:11 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
00:51:11 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.04
00:51:11 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.03
00:51:11 SQL> 
00:51:11 SQL> @popledger
00:51:11 SQL> REM popledger.sql
00:51:11 SQL> set autotrace off echo on pages 99 lines 200 trimspool on
00:51:11 SQL> 
00:51:11 SQL> truncate table ps_ledger;

Table truncated.

Elapsed: 00:00:00.02
00:51:11 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, LEDGER, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
00:51:11 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
00:51:11 SQL> 
00:51:11 SQL> ALTER TABLE PS_LEDGER PARALLEL 8;

Table altered.

Elapsed: 00:00:00.02
00:51:11 SQL> 
00:51:11 SQL> insert /*+APPEND PARALLEL ENABLE_PARALLEL_DML*/ into ps_ledger
00:51:11   2  with n as (
00:51:11   3  SELECT rownum n from dual connect by level <= 1e2
00:51:11   4  ), fy as (
00:51:11   5  SELECT /*+MATERIALIZE*/ 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
00:51:11   6  ), ap as (
00:51:11   7  SELECT /*+MATERIALIZE*/ FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
00:51:11   8  UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
00:51:11   9  UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
00:51:11  10  ), l as (
00:51:11  11  SELECT /*+MATERIALIZE*/ 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
00:51:11  12  UNION ALL SELECT 'BUDGET' FROM DUAL
00:51:11  13  )
00:51:11  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
00:51:11  15  ,      l.ledger
00:51:11  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
00:51:11  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
00:51:11  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
00:51:11  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
00:51:11  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
00:51:11  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
00:51:11  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
00:51:11  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
00:51:11  24  ,      ' ' budget_ref
00:51:11  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
00:51:11  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
00:51:11  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
00:51:11  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
00:51:11  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
00:51:11  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
00:51:11  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
00:51:11  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
00:51:11  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
00:51:11  34  ,      'GBP' currency_cd
00:51:11  35  ,      ' ' statistics_code
00:51:11  36  ,      fy.fiscal_year
00:51:11  37  ,      ap.accounting_period
00:51:11  38  ,      dbms_random.value(0,1e6) posted_total_amt
00:51:11  39  ,      0 posted_base_amt
00:51:11  40  ,      0 posted_tran_amt
00:51:11  41  ,      'GBP' base_currency
00:51:11  42  ,      SYSDATE dttm_stamp_sec
00:51:11  43  ,      0 process_instance
00:51:11  44  FROM   fy,ap, l, n
00:51:11  45  WHERE  l.ledger = 'BUDGET' or (fy.fiscal_year < 2020 or (fy.fiscal_year = 2020 AND ap.accounting_period <= 6))
00:51:11  46  /

2938423 rows created.

Elapsed: 00:06:23.12
00:57:35 SQL> commit;

Commit complete.

Elapsed: 00:00:00.06
00:57:35 SQL> exec dbms_stats.gather_table_stats('SCOTT','PS_LEDGER');

PL/SQL procedure successfully completed.

Elapsed: 00:01:31.02
00:59:06 SQL> 
00:59:06 SQL> CREATE /*UNIQUE*/ INDEX ps_ledger ON ps_ledger
00:59:06   2  (business_unit,ledger,account,altacct,deptid
00:59:06   3  ,operating_unit,product,fund_code,class_fld,program_code
00:59:06   4  ,budget_ref,affiliate,affiliate_intra1,affiliate_intra2,chartfield1
00:59:06   5  ,chartfield2,chartfield3,project_id,book_code,gl_adjust_type
00:59:06   6  /*,date_code*/,currency_cd,statistics_code,fiscal_year,accounting_period
00:59:06   7  ) COMPRESS 2 NOPARALLEL
00:59:06   8  /

Index created.

Elapsed: 00:00:53.08
00:59:59 SQL> 
00:59:59 SQL> CREATE INDEX psxledger ON ps_ledger
00:59:59   2  (ledger, fiscal_year, accounting_period, business_unit, account, chartfield1
00:59:59   3  ) LOCAL COMPRESS 4 PARALLEL
00:59:59   4  /

Index created.

Elapsed: 00:00:13.55
01:00:12 SQL> 
01:00:12 SQL> CREATE INDEX psyledger ON ps_ledger
01:00:12   2  (ledger, fiscal_year, business_unit, account, chartfield1, accounting_period
01:00:12   3  ) LOCAL COMPRESS 3 PARALLEL
01:00:12   4  /

Index created.

Elapsed: 00:00:12.51
01:00:25 SQL> 
01:00:25 SQL> ALTER INDEX ps_ledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.01
01:00:25 SQL> ALTER INDEX psxledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.03
01:00:25 SQL> ALTER INDEX psyledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.02
01:00:25 SQL> 
01:00:25 SQL> break on report on ledger skip 1
01:00:25 SQL> compute sum of count(*) on report
01:00:25 SQL> set autotrace off
01:00:25 SQL> select ledger, fiscal_year, count(*), max(accounting_period)
01:00:25   2  from ps_ledger
01:00:25   3  group by ledger, fiscal_year
01:00:25   4  order by 1,2
01:00:25   5  /

LEDGER     FISCAL_YEAR   COUNT(*) MAX(ACCOUNTING_PERIOD)
---------- ----------- ---------- ----------------------
ACTUALS           2018    1000000                    999
                  2019    1000000                    999
                  2020     538423                      6

BUDGET            2018     100000                    999
                  2019     100000                    999
                  2020     100000                    999
                  2021     100000                    999

**********             ----------
sum                       2938423

7 rows selected.

Elapsed: 00:00:03.35
01:00:28 SQL> compute sum of count(*) on fiscal_year
01:00:28 SQL> break on report on fiscal_year skip 1 on ledger skip 1
01:00:28 SQL> select ledger, fiscal_year, accounting_period, count(*)
01:00:28   2  from ps_ledger
01:00:28   3  group by ledger, fiscal_year, accounting_period
01:00:28   4  order by 1,2,3
01:00:28   5  /

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
ACTUALS           2018                 0      76928
                                       1      76658
                                       2      76625
                                       3      76473
                                       4      76519
                                       5      77311
                                       6      76455
                                       7      77170
                                       8      76945
                                       9      76737
                                      10      76573
                                      11      76677
                                      12      76929
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2019                 0      76675
                                       1      76584
                                       2      76663
                                       3      76270
                                       4      76876
                                       5      77083
                                       6      76587
                                       7      76539
                                       8      77076
                                       9      76936
                                      10      77044
                                      11      77174
                                      12      76493
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2020                 0      77095
                                       1      77066
                                       2      77019
                                       3      76527
                                       4      76888
                                       5      76912
                                       6      76916

********** ***********                   ----------
           sum                               538423

BUDGET            2018                 0       7637
                                       1       7610
                                       2       7747
                                       3       7632
                                       4       7859
                                       5       7673
                                       6       7539
                                       7       7693
                                       8       7602
                                       9       7670
                                      10       7727
                                      11       7729
                                      12       7682
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2019                 0       7844
                                       1       7649
                                       2       7781
                                       3       7550
                                       4       7773
                                       5       7573
                                       6       7563
                                       7       7616
                                       8       7699
                                       9       7709
                                      10       7694
                                      11       7687
                                      12       7662
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2020                 0       7578
                                       1       7765
                                       2       7577
                                       3       7757
                                       4       7764
                                       5       7595
                                       6       7813
                                       7       7587
                                       8       7662

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
BUDGET            2020                 9       7570
                                      10       7656
                                      11       7700
                                      12       7776
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2021                 0       7701
                                       1       7776
                                       2       7762
                                       3       7773
                                       4       7697
                                       5       7625
                                       6       7708
                                       7       7513
                                       8       7635
                                       9       7753
                                      10       7633
                                      11       7522
                                      12       7702
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

                                         ----------
sum                                         2938423

97 rows selected.

Elapsed: 00:00:03.30
01:00:31 SQL> break on ledger skip 1 on fiscal_year skip 1
01:00:31 SQL> select ledger, account, count(*)
01:00:31   2  from ps_ledger
01:00:31   3  where 1=2
01:00:31   4  group by ledger, account
01:00:31   5  order by 1,3
01:00:31   6  /

no rows selected

Elapsed: 00:00:00.01
01:00:31 SQL> 
01:00:31 SQL> TRUNCATE TABLE PSTREESELECT05;

Table truncated.

Elapsed: 00:00:00.03
01:00:31 SQL> TRUNCATE TABLE PSTREESELECT10;

Table truncated.

Elapsed: 00:00:00.02
01:00:31 SQL> 
01:00:31 SQL> INSERT INTO PSTREESELECT05
01:00:31   2  WITH x as (SELECT DISTINCT business_unit FROM ps_ledger)
01:00:31   3  , y as (SELECT 30982, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, business_unit FROM x)
01:00:31   4  select y.*, business_unit FROM y
01:00:31   5  /

2 rows created.

Elapsed: 00:00:02.75
01:00:34 SQL> INSERT INTO PSTREESELECT10
01:00:34   2  WITH x as (SELECT DISTINCT account FROM ps_ledger)
01:00:34   3  , y as (SELECT 30984, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, account FROM x)
01:00:34   4  select y.*, account FROM y
01:00:34   5  where mod(tree_node_num,100)<25
01:00:34   6  /

258 rows created.

Elapsed: 00:00:03.99
01:00:38 SQL> INSERT INTO PSTREESELECT10
01:00:38   2  WITH x as (SELECT DISTINCT chartfield1 FROM ps_ledger)
01:00:38   3  , y as (SELECT 30985, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, chartfield1 FROM x)
01:00:38   4  select y.*, chartfield1 FROM y
01:00:38   5  where mod(tree_node_num,100)<10
01:00:38   6  /

104 rows created.

Elapsed: 00:00:03.94
01:00:42 SQL> commit;

Commit complete.

Elapsed: 00:00:00.00
01:00:42 SQL> 
01:00:42 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT05');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.29
01:00:42 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT10');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.72
01:00:43 SQL> 
01:00:43 SQL> ALTER TABLE PS_LEDGER NOPARALLEL;

Table altered.

Elapsed: 00:00:00.02
01:00:43 SQL> 
01:00:43 SQL> /*explain plan for
01:00:43 SQL> SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:00:43 SQL> FROM   PS_LEDGER A
01:00:43 SQL> ,      PSTREESELECT05 L1
01:00:43 SQL> ,      PSTREESELECT10 L
01:00:43 SQL> ,      PSTREESELECT10 L2
01:00:43 SQL> WHERE  A.LEDGER='ACTUALS'
01:00:43 SQL> AND    A.FISCAL_YEAR=2020
01:00:43 SQL> AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 2
01:00:43 SQL> AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:00:43 SQL> AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:00:43 SQL> AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:00:43 SQL> AND    A.CURRENCY_CD='GBP'
01:00:43 SQL> GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:00:43 SQL> /
01:00:43 SQL> @@xp*/
01:00:43 SQL> 
01:00:43 SQL> CREATE MATERIALIZED VIEW mv_ledger_2019
01:00:43   2  PARTITION BY RANGE (ACCOUNTING_PERIOD)
01:00:43   3  (PARTITION ap_bf VALUES LESS THAN (1)
01:00:43   4  ,PARTITION ap_01 VALUES LESS THAN (2)
01:00:43   5  ,PARTITION ap_02 VALUES LESS THAN (3)
01:00:43   6  ,PARTITION ap_03 VALUES LESS THAN (4)
01:00:43   7  ,PARTITION ap_04 VALUES LESS THAN (5)
01:00:43   8  ,PARTITION ap_05 VALUES LESS THAN (6)
01:00:43   9  ,PARTITION ap_06 VALUES LESS THAN (7)
01:00:43  10  ,PARTITION ap_07 VALUES LESS THAN (8)
01:00:43  11  ,PARTITION ap_08 VALUES LESS THAN (9)
01:00:43  12  ,PARTITION ap_09 VALUES LESS THAN (10)
01:00:43  13  ,PARTITION ap_10 VALUES LESS THAN (11)
01:00:43  14  ,PARTITION ap_11 VALUES LESS THAN (12)
01:00:43  15  ,PARTITION ap_12 VALUES LESS THAN (13)
01:00:43  16  ,PARTITION ap_cf VALUES LESS THAN (MAXVALUE)
01:00:43  17  ) PCTFREE 0 COMPRESS
01:00:43  18  REFRESH COMPLETE ON DEMAND
01:00:43  19  ENABLE QUERY REWRITE AS
01:00:43  20  SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
01:00:43  21  sum(posted_total_amt) posted_total_amt
01:00:43  22  FROM ps_ledger
01:00:43  23  WHERE fiscal_year = 2019
01:00:43  24  AND   ledger = 'ACTUALS'
01:00:43  25  AND   currency_cd = 'GBP'
01:00:43  26  GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
01:00:43  27  /

Materialized view created.

Elapsed: 00:00:17.01
01:01:00 SQL> 
01:01:00 SQL> CREATE MATERIALIZED VIEW mv_ledger_2020
01:01:00   2  PARTITION BY RANGE (ACCOUNTING_PERIOD)
01:01:00   3  (PARTITION ap_bf VALUES LESS THAN (1)
01:01:00   4  ,PARTITION ap_01 VALUES LESS THAN (2)
01:01:00   5  ,PARTITION ap_02 VALUES LESS THAN (3)
01:01:00   6  ,PARTITION ap_03 VALUES LESS THAN (4)
01:01:00   7  ,PARTITION ap_04 VALUES LESS THAN (5)
01:01:00   8  ,PARTITION ap_05 VALUES LESS THAN (6)
01:01:00   9  ,PARTITION ap_06 VALUES LESS THAN (7)
01:01:00  10  ,PARTITION ap_07 VALUES LESS THAN (8)
01:01:00  11  ,PARTITION ap_08 VALUES LESS THAN (9)
01:01:00  12  ,PARTITION ap_09 VALUES LESS THAN (10)
01:01:00  13  ,PARTITION ap_10 VALUES LESS THAN (11)
01:01:00  14  ,PARTITION ap_11 VALUES LESS THAN (12)
01:01:00  15  ,PARTITION ap_12 VALUES LESS THAN (13)
01:01:00  16  ,PARTITION ap_cf VALUES LESS THAN (MAXVALUE)
01:01:00  17  ) PCTFREE 0 COMPRESS PARALLEL
01:01:00  18  REFRESH COMPLETE ON DEMAND
01:01:00  19  ENABLE QUERY REWRITE AS
01:01:00  20  SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
01:01:00  21  sum(posted_total_amt) posted_total_amt
01:01:00  22  FROM ps_ledger
01:01:00  23  WHERE fiscal_year = 2020
01:01:00  24  AND   ledger = 'ACTUALS'
01:01:00  25  AND   currency_cd = 'GBP'
01:01:00  26  GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
01:01:00  27  /

Materialized view created.

Elapsed: 00:00:05.94
01:01:06 SQL> 
01:01:06 SQL> @@mvpop
01:01:06 SQL> REM mvpop.sql
01:01:06 SQL> set autotrace off
01:01:06 SQL> break on table_name skip 1 on partition_name
01:01:06 SQL> column table_name format a20
01:01:06 SQL> column mview_name format a20
01:01:06 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               COMPLETE VALID
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
01:01:06 SQL> 
01:01:06 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
01:01:06 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);
01:01:06 SQL> 
01:01:06 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'C',atomic_refresh=>FALSE);
01:01:06 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'C',atomic_refresh=>FALSE);
01:01:06 SQL> 
01:01:06 SQL> ALTER MATERIALIZED VIEW mv_ledger_2019 NOPARALLEL;

Materialized view altered.

Elapsed: 00:00:00.02
01:01:06 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
01:01:06 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
01:01:06 SQL> 
01:01:06 SQL> ALTER MATERIALIZED VIEW mv_ledger_2020 NOPARALLEL;

Materialized view altered.

Elapsed: 00:00:00.02
01:01:06 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
01:01:06 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
01:01:06 SQL> 
01:01:06 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2019');

PL/SQL procedure successfully completed.

Elapsed: 00:00:33.32
01:01:40 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:14.36
01:01:54 SQL> @@mvvol
01:01:54 SQL> REM mvvol.sql
01:01:54 SQL> 
01:01:54 SQL> set autotrace off
01:01:54 SQL> break on table_name skip 1 on partition_name
01:01:54 SQL> column table_name format a15
01:01:54 SQL> column column_name format a20
01:01:54 SQL> column mview_name format a20
01:01:54 SQL> column partition_position format 999 heading 'Part|Pos'
01:01:54 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
01:01:54 SQL> column partition_name format a20
01:01:54 SQL> column subpartition_name format a25
01:01:54 SQL> column num_rows format 9999999
01:01:54 SQL> column num_distinct heading 'Num|Distinct' format 9999999
01:01:54 SQL> column num_buckets heading 'Num|Buckets'	format 9999
01:01:54 SQL> column blocks format 99999
01:01:54 SQL> column rpb format 999.9 heading 'Rows|per|Block'
01:01:54 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               COMPLETE VALID
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
01:01:54 SQL> 
01:01:54 SQL> select count(*) from mv_ledger_2019;

  COUNT(*)
----------
    946935

Elapsed: 00:00:00.06
01:01:54 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
    509624

Elapsed: 00:00:00.03
01:01:54 SQL> 
01:01:54 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
01:01:54   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
01:01:54   3  , COALESCE(c.compression, b.compression) compression
01:01:54   4  , COALESCE(c.compress_for, b.compress_for) compress_for
01:01:54   5  from user_tab_statistics a
01:01:54   6  	LEFT OUTER JOIN user_tab_partitions b
01:01:54   7  	  ON a.table_name = b.table_name
01:01:54   8  	  AND a.partition_name = b.partition_name
01:01:54   9  	LEFT OUTER JOIN user_tab_subpartitions c
01:01:54  10  	  ON a.table_name = c.table_name
01:01:54  11  	  AND a.partition_name = c.partition_name
01:01:54  12  	  AND a.subpartition_name = c.subpartition_name
01:01:54  13  where a.table_name like '%LEDGER%'
01:01:54  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
01:01:54  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2019     1 AP_BF                                                  72660    251  289.5 ENABLED  BASIC
                   2 AP_01                                                  72527    251  289.0 ENABLED  BASIC
                   3 AP_02                                                  72532    251  289.0 ENABLED  BASIC
                   4 AP_03                                                  72225    250  288.9 ENABLED  BASIC
                   5 AP_04                                                  72747    251  289.8 ENABLED  BASIC
                   6 AP_05                                                  72939    252  289.4 ENABLED  BASIC
                   7 AP_06                                                  72509    251  288.9 ENABLED  BASIC
                   8 AP_07                                                  72486    250  289.9 ENABLED  BASIC
                   9 AP_08                                                  73046    252  289.9 ENABLED  BASIC
                  10 AP_09                                                  72842    252  289.1 ENABLED  BASIC
                  11 AP_10                                                  72832    252  289.0 ENABLED  BASIC
                  12 AP_11                                                  73077    252  290.0 ENABLED  BASIC
                  13 AP_12                                                  72514    251  288.9 ENABLED  BASIC
                  14 AP_CF                                                   1999     25   80.0 ENABLED  BASIC
                                                                           946935   3291  287.7

MV_LEDGER_2020     1 AP_BF                                                  72936    256  284.9 ENABLED  BASIC
                   2 AP_01                                                  72875    256  284.7 ENABLED  BASIC
                   3 AP_02                                                  72820    256  284.5 ENABLED  BASIC
                   4 AP_03                                                  72491    256  283.2 ENABLED  BASIC
                   5 AP_04                                                  72799    256  284.4 ENABLED  BASIC
                   6 AP_05                                                  72814    256  284.4 ENABLED  BASIC
                   7 AP_06                                                  72889    256  284.7 ENABLED  BASIC
                   8 AP_07                                                      0      0        ENABLED  BASIC
                   9 AP_08                                                      0      0        ENABLED  BASIC
                  10 AP_09                                                      0      0        ENABLED  BASIC
                  11 AP_10                                                      0      0        ENABLED  BASIC
                  12 AP_11                                                      0      0        ENABLED  BASIC
                  13 AP_12                                                      0      0        ENABLED  BASIC
                  14 AP_CF                                                      0      0        ENABLED  BASIC
                                                                           509624   1792  284.4

PS_LEDGER          1 AP_BF                                                 261458   5147   50.8 NONE
                   1                         1 AP_BF_LEDGER_2018            84565   1372   61.6 ENABLED  BASIC
                   1                         2 AP_BF_LEDGER_2019            84519   1371   61.6 ENABLED  BASIC
                   1                         3 AP_BF_LEDGER_2020            84673   2193   38.6 DISABLED
                   1                         4 AP_BF_LEDGER_2021             7701    211   36.5 DISABLED
                   2 AP_01                                                 261108   5174   50.5 NONE
                   2                         1 AP_01_LEDGER_2018            84268   1368   61.6 ENABLED  BASIC
                   2                         2 AP_01_LEDGER_2019            84233   1366   61.7 ENABLED  BASIC
                   2                         3 AP_01_LEDGER_2020            84831   2224   38.1 DISABLED
                   2                         4 AP_01_LEDGER_2021             7776    216   36.0 DISABLED
                   3 AP_02                                                 261174   5172   50.5 NONE
                   3                         1 AP_02_LEDGER_2018            84372   1369   61.6 ENABLED  BASIC
                   3                         2 AP_02_LEDGER_2019            84444   1370   61.6 ENABLED  BASIC
                   3                         3 AP_02_LEDGER_2020            84596   2218   38.1 DISABLED
                   3                         4 AP_02_LEDGER_2021             7762    215   36.1 DISABLED
                   4 AP_03                                                 259982   5149   50.5 NONE
                   4                         1 AP_03_LEDGER_2018            84105   1364   61.7 ENABLED  BASIC
                   4                         2 AP_03_LEDGER_2019            83820   1360   61.6 ENABLED  BASIC
                   4                         3 AP_03_LEDGER_2020            84284   2210   38.1 DISABLED
                   4                         4 AP_03_LEDGER_2021             7773    215   36.2 DISABLED
                   5 AP_04                                                 261376   5177   50.5 NONE
                   5                         1 AP_04_LEDGER_2018            84378   1369   61.6 ENABLED  BASIC
                   5                         2 AP_04_LEDGER_2019            84649   1374   61.6 ENABLED  BASIC
                   5                         3 AP_04_LEDGER_2020            84652   2220   38.1 DISABLED
                   5                         4 AP_04_LEDGER_2021             7697    214   36.0 DISABLED
                   6 AP_05                                                 261772   5180   50.5 NONE
                   6                         1 AP_05_LEDGER_2018            84984   1378   61.7 ENABLED  BASIC
                   6                         2 AP_05_LEDGER_2019            84656   1374   61.6 ENABLED  BASIC
                   6                         3 AP_05_LEDGER_2020            84507   2216   38.1 DISABLED
                   6                         4 AP_05_LEDGER_2021             7625    212   36.0 DISABLED
                   7 AP_06                                                 260581   5165   50.5 NONE
                   7                         1 AP_06_LEDGER_2018            83994   1363   61.6 ENABLED  BASIC
                   7                         2 AP_06_LEDGER_2019            84150   1366   61.6 ENABLED  BASIC
                   7                         3 AP_06_LEDGER_2020            84729   2222   38.1 DISABLED
                   7                         4 AP_06_LEDGER_2021             7708    214   36.0 DISABLED
                   8 AP_07                                                 184118   3163   58.2 NONE
                   8                         1 AP_07_LEDGER_2018            84863   1377   61.6 ENABLED  BASIC
                   8                         2 AP_07_LEDGER_2019            84155   1366   61.6 ENABLED  BASIC
                   8                         3 AP_07_LEDGER_2020             7587    211   36.0 DISABLED
                   8                         4 AP_07_LEDGER_2021             7513    209   35.9 DISABLED
                   9 AP_08                                                 184619   3173   58.2 NONE
                   9                         1 AP_08_LEDGER_2018            84547   1372   61.6 ENABLED  BASIC
                   9                         2 AP_08_LEDGER_2019            84775   1376   61.6 ENABLED  BASIC
                   9                         3 AP_08_LEDGER_2020             7662    213   36.0 DISABLED
                   9                         4 AP_08_LEDGER_2021             7635    212   36.0 DISABLED
                  10 AP_09                                                 184375   3168   58.2 NONE
                  10                         1 AP_09_LEDGER_2018            84407   1370   61.6 ENABLED  BASIC
                  10                         2 AP_09_LEDGER_2019            84645   1373   61.6 ENABLED  BASIC
                  10                         3 AP_09_LEDGER_2020             7570    210   36.0 DISABLED
                  10                         4 AP_09_LEDGER_2021             7753    215   36.1 DISABLED
                  11 AP_10                                                 184327   3166   58.2 NONE
                  11                         1 AP_10_LEDGER_2018            84300   1368   61.6 ENABLED  BASIC
                  11                         2 AP_10_LEDGER_2019            84738   1374   61.7 ENABLED  BASIC
                  11                         3 AP_10_LEDGER_2020             7656    212   36.1 DISABLED
                  11                         4 AP_10_LEDGER_2021             7633    212   36.0 DISABLED
                  12 AP_11                                                 184489   3167   58.3 NONE
                  12                         1 AP_11_LEDGER_2018            84406   1369   61.7 ENABLED  BASIC
                  12                         2 AP_11_LEDGER_2019            84861   1376   61.7 ENABLED  BASIC
                  12                         3 AP_11_LEDGER_2020             7700    213   36.2 DISABLED
                  12                         4 AP_11_LEDGER_2021             7522    209   36.0 DISABLED
                  13 AP_12                                                 184244   3168   58.2 NONE
                  13                         1 AP_12_LEDGER_2018            84611   1373   61.6 ENABLED  BASIC

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
PS_LEDGER         13 AP_12                   2 AP_12_LEDGER_2019            84155   1365   61.7 ENABLED  BASIC
                  13                         3 AP_12_LEDGER_2020             7776    216   36.0 DISABLED
                  13                         4 AP_12_LEDGER_2021             7702    214   36.0 DISABLED
                  14 AP_CF                                                   4800    154   31.2 NONE
                  14                         1 AP_CF_LEDGER_2018             2200     53   41.5 ENABLED  BASIC
                  14                         2 AP_CF_LEDGER_2019             2200     53   41.5 ENABLED  BASIC
                  14                         3 AP_CF_LEDGER_2020              200     24    8.3 DISABLED
                  14                         4 AP_CF_LEDGER_2021              200     24    8.3 DISABLED
                                                                          2938423  55323   53.1


101 rows selected.

Elapsed: 00:00:00.06
01:01:54 SQL> 
01:01:54 SQL> column extension format a40
01:01:54 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
01:01:54   2  from user_tab_col_statistics s
01:01:54   3  	LEFT OUTER JOIN user_stat_extensions e
01:01:54   4  	ON e.table_name = s.table_name
01:01:54   5  	AND e.extension_name = s.column_name
01:01:54   6  where s.table_name like 'MV_LEDGER%'
01:01:54   7  order by 1,2
01:01:54   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  ACCOUNT                   999       1 NONE            01:01:14 19/11/2020
                ACCOUNTING_PERIOD          15       1 NONE            01:01:14 19/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       01:01:14 19/11/2020
                CHARTFIELD1              1000       1 NONE            01:01:14 19/11/2020
                FISCAL_YEAR                 1       1 NONE            01:01:14 19/11/2020
                POSTED_TOTAL_AMT       946935       1 NONE            01:01:14 19/11/2020
                SYS_NC00007$                2       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$             1000       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )


MV_LEDGER_2020  ACCOUNT                   999       1 NONE            01:01:43 19/11/2020
                ACCOUNTING_PERIOD           7       1 NONE            01:01:43 19/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       01:01:43 19/11/2020
                CHARTFIELD1               999       1 NONE            01:01:43 19/11/2020
                FISCAL_YEAR                 1       1 NONE            01:01:43 19/11/2020
                POSTED_TOTAL_AMT       509624       1 NONE            01:01:43 19/11/2020
                SYS_NC00007$                2       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              999       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$                7       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )



22 rows selected.

Elapsed: 00:00:00.07
01:01:54 SQL> column extension format a40
01:01:54 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
01:01:54   2  from user_part_col_statistics s
01:01:54   3  	LEFT OUTER JOIN user_stat_extensions e
01:01:54   4  	ON e.table_name = s.table_name
01:01:54   5  	AND e.extension_name = s.column_name
01:01:54   6  where s.table_name like 'MV_LEDGER%'
01:01:54   7  order by 1,2
01:01:54   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  AP_01                SYS_NC00011$                1       1 NONE            01:01:06 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:06 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:01:06 19/11/2020
                                     CHARTFIELD1               991       1 NONE            01:01:06 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:06 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:06 19/11/2020
                                     POSTED_TOTAL_AMT        72527       1 NONE            01:01:06 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:06 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:01:06 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            01:01:06 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:06 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_02                SYS_NC00011$                1       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:07 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:01:07 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:01:07 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:07 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:07 19/11/2020
                                     POSTED_TOTAL_AMT        71872       1 NONE            01:01:07 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_03                SYS_NC00011$                1       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:07 19/11/2020
                                     ACCOUNT                   989       1 NONE            01:01:07 19/11/2020
                                     CHARTFIELD1               991       1 NONE            01:01:07 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:07 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:07 19/11/2020
                                     POSTED_TOTAL_AMT        71584       1 NONE            01:01:07 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              989       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:07 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_04                POSTED_TOTAL_AMT        72120       1 NONE            01:01:08 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:08 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:01:08 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:01:08 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:08 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            01:01:08 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:08 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:01:08 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:01:08 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:08 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:08 19/11/2020
                AP_05                SYS_NC00011$                1       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:09 19/11/2020
                                     ACCOUNT                   994       1 NONE            01:01:09 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:09 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:09 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:09 19/11/2020
                                     POSTED_TOTAL_AMT        72656       1 NONE            01:01:09 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_06                SYS_NC00011$                1       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:09 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:01:09 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:01:09 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:09 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:09 19/11/2020
                                     POSTED_TOTAL_AMT        72509       1 NONE            01:01:09 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:09 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_07                SYS_NC00011$                1       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:10 19/11/2020
                                     ACCOUNT                   994       1 NONE            01:01:10 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:01:10 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:10 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:10 19/11/2020
                                     POSTED_TOTAL_AMT        72486       1 NONE            01:01:10 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_08                SYS_NC00011$                1       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:10 19/11/2020

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  AP_08                ACCOUNT                   996       1 NONE            01:01:10 19/11/2020
                                     CHARTFIELD1               989       1 NONE            01:01:10 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:10 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:10 19/11/2020
                                     POSTED_TOTAL_AMT        73046       1 NONE            01:01:10 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              996       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              989       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:10 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_09                SYS_NC00011$                1       1 NONE            01:01:11 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:11 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:01:11 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:11 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:11 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:11 19/11/2020
                                     POSTED_TOTAL_AMT        72504       1 NONE            01:01:11 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:11 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:01:11 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:11 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:11 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_10                SYS_NC00011$                1       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:12 19/11/2020
                                     ACCOUNT                   989       1 NONE            01:01:12 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:01:12 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:12 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:12 19/11/2020
                                     POSTED_TOTAL_AMT        72416       1 NONE            01:01:12 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              989       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_11                SYS_NC00011$                1       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:12 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:01:12 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:01:12 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:12 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:12 19/11/2020
                                     POSTED_TOTAL_AMT        72168       1 NONE            01:01:12 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:12 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_12                SYS_NC00011$                1       1 NONE            01:01:13 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:13 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:01:13 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:13 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:13 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:13 19/11/2020
                                     POSTED_TOTAL_AMT        72514       1 NONE            01:01:13 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:13 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:01:13 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:13 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:13 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_BF                SYS_NC00011$                1       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:14 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:01:14 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:14 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:14 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:14 19/11/2020
                                     POSTED_TOTAL_AMT        72112       1 NONE            01:01:14 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_CF                SYS_NC00011$                2       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:14 19/11/2020
                                     ACCOUNT                   751       1 NONE            01:01:14 19/11/2020
                                     CHARTFIELD1               766       1 NONE            01:01:14 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:14 19/11/2020
                                     ACCOUNTING_PERIOD           2       1 NONE            01:01:14 19/11/2020
                                     POSTED_TOTAL_AMT         1999       1 NONE            01:01:14 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              751       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              766       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:14 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))

MV_LEDGER_2020  AP_01                SYS_NC00011$                1       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:40 19/11/2020
                                     ACCOUNT                   996       1 NONE            01:01:40 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:01:40 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:40 19/11/2020

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  AP_01                ACCOUNTING_PERIOD           1       1 NONE            01:01:40 19/11/2020
                                     POSTED_TOTAL_AMT        72576       1 NONE            01:01:40 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              996       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_02                SYS_NC00011$                1       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:40 19/11/2020
                                     ACCOUNT                   990       1 NONE            01:01:40 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:40 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:40 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:40 19/11/2020
                                     POSTED_TOTAL_AMT        72288       1 NONE            01:01:40 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              990       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:40 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_03                SYS_NC00011$                1       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:41 19/11/2020
                                     ACCOUNT                   991       1 NONE            01:01:41 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:41 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:41 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:41 19/11/2020
                                     POSTED_TOTAL_AMT        72491       1 NONE            01:01:41 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_04                SYS_NC00011$                1       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:41 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:01:41 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:41 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:41 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:41 19/11/2020
                                     POSTED_TOTAL_AMT        72456       1 NONE            01:01:41 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:41 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_05                SYS_NC00011$                1       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:42 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:01:42 19/11/2020
                                     CHARTFIELD1               996       1 NONE            01:01:42 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:42 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:42 19/11/2020
                                     POSTED_TOTAL_AMT        71968       1 NONE            01:01:42 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              996       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_06                SYS_NC00011$                1       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:42 19/11/2020
                                     ACCOUNT                   997       1 NONE            01:01:42 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:01:42 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:42 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:42 19/11/2020
                                     POSTED_TOTAL_AMT        72889       1 NONE            01:01:42 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              997       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:42 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_07                SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_08                SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  AP_08                SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_09                BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                AP_10                SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_11                SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_12                SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_BF                SYS_NC00011$                1       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:01:43 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:01:43 19/11/2020
                                     POSTED_TOTAL_AMT        72784       1 NONE            01:01:43 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_CF                SYS_NC00011$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     SYS_NC00010$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00009$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00008$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00007$                0       0 NONE            01:01:43 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     POSTED_TOTAL_AMT            0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:01:43 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:01:43 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:01:43 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:01:43 19/11/2020
                                     BUSINESS_UNIT               0       0 NONE            01:01:43 19/11/2020


308 rows selected.

Elapsed: 00:00:00.32
01:01:55 SQL> 
01:01:55 SQL> column extension format a40
01:01:55 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
01:01:55   2  from user_subpart_col_statistics s
01:01:55   3  	LEFT OUTER JOIN user_stat_extensions e
01:01:55   4  	ON e.table_name = s.table_name
01:01:55   5  	AND e.extension_name = s.column_name
01:01:55   6  where s.table_name like 'MV_LEDGER%'
01:01:55   7  order by 1,2
01:01:55   8  ;

no rows selected

Elapsed: 00:00:00.00
01:01:55 SQL> @@mvsql
01:01:55 SQL> REM mvsql.sql
01:01:55 SQL> set autotrace off
01:01:55 SQL> 
01:01:55 SQL> REM 2018
01:01:55 SQL> set lines 200 pages 999
01:01:55 SQL> explain plan for
01:01:55   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:01:55   3  FROM   PS_LEDGER A
01:01:55   4  ,      PSTREESELECT05 L1
01:01:55   5  ,      PSTREESELECT10 L
01:01:55   6  ,      PSTREESELECT10 L2
01:01:55   7  WHERE  A.LEDGER='ACTUALS'
01:01:55   8  AND    A.FISCAL_YEAR=2018
01:01:55   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
01:01:55  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:01:55  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:01:55  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:01:55  13  AND    A.CURRENCY_CD='GBP'
01:01:55  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:01:55  15  /

Explained.

Elapsed: 00:00:00.25
01:01:55 SQL> @@xp
01:01:55 SQL> REM xp.sql
01:01:55 SQL> REM spool xp
01:01:55 SQL> REM set pages 9999 lines 200 autotrace off
01:01:55 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2690363151

-----------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                   |   717 | 66681 |  2244   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY              |                   |   717 | 66681 |  2244   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                 |                   |   717 | 66681 |  2243   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN         | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                |                   |  2776 |   200K|  2241   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN    |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN       | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT            |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN      | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR|                   | 26693 |  1173K|  2238   (1)| 00:00:01 |     2 |     7 |
|  10 |      PARTITION RANGE SINGLE |                   | 26693 |  1173K|  2238   (1)| 00:00:01 |     1 |     1 |
|* 11 |       TABLE ACCESS FULL     | PS_LEDGER         | 26693 |  1173K|  2238   (1)| 00:00:01 |       |       |
-----------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."FISCAL_YEAR"=2018 AND "A"."LEDGER"='ACTUALS' AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDA
        TA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA
        [L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.12
01:01:55 SQL> REM spool off
01:01:55 SQL> 
01:01:55 SQL> REM 2019
01:01:55 SQL> explain plan for
01:01:55   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:01:55   3  FROM   PS_LEDGER A
01:01:55   4  ,      PSTREESELECT05 L1
01:01:55   5  ,      PSTREESELECT10 L
01:01:55   6  ,      PSTREESELECT10 L2
01:01:55   7  WHERE  A.LEDGER='ACTUALS'
01:01:55   8  AND    A.FISCAL_YEAR=2019
01:01:55   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
01:01:55  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:01:55  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:01:55  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:01:55  13  AND    A.CURRENCY_CD='GBP'
01:01:55  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:01:55  15  /

Explained.

Elapsed: 00:00:00.29
01:01:55 SQL> @@xp
01:01:55 SQL> REM xp.sql
01:01:55 SQL> REM spool xp
01:01:55 SQL> REM set pages 9999 lines 200 autotrace off
01:01:55 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1498194812

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1848 |   138K|   421   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1848 |   138K|   421   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1848 |   138K|   420   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7157 |   405K|   418   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   | 68816 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 68816 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.16
01:01:55 SQL> REM spool off
01:01:55 SQL> 
01:01:55 SQL> REM 2020
01:01:55 SQL> explain plan for
01:01:55   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:01:55   3  FROM   PS_LEDGER A
01:01:55   4  ,      PSTREESELECT05 L1
01:01:55   5  ,      PSTREESELECT10 L
01:01:55   6  ,      PSTREESELECT10 L2
01:01:55   7  WHERE  A.LEDGER='ACTUALS'
01:01:55   8  AND    A.FISCAL_YEAR=2020
01:01:55   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
01:01:55  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:01:55  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:01:55  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:01:55  13  AND    A.CURRENCY_CD='GBP'
01:01:55  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:01:55  15  /

Explained.

Elapsed: 00:00:00.27
01:01:56 SQL> @@xp
01:01:56 SQL> REM xp.sql
01:01:56 SQL> REM spool xp
01:01:56 SQL> REM set pages 9999 lines 200 autotrace off
01:01:56 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3016493666

------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   | 13375 |  1005K|       |   673   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   | 13375 |  1005K|  1176K|   673   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   | 13375 |  1005K|       |   429   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   | 51791 |  2933K|       |   427   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   |   497K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   497K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  10 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGE
        R_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]
        ></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D
        5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CD
        ATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></
        s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v>
        </o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><
        t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h
        ></f></q>


83 rows selected.

Elapsed: 00:00:00.13
01:01:56 SQL> REM spool off
01:01:56 SQL> 
01:01:56 SQL> explain plan for
01:01:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:01:56   3  FROM   PS_LEDGER A
01:01:56   4  ,      PSTREESELECT05 L1
01:01:56   5  ,      PSTREESELECT10 L
01:01:56   6  ,      PSTREESELECT10 L2
01:01:56   7  WHERE  A.LEDGER='ACTUALS'
01:01:56   8  AND    A.FISCAL_YEAR=2019
01:01:56   9  AND    A.ACCOUNTING_PERIOD = 7
01:01:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:01:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:01:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:01:56  13  AND    A.CURRENCY_CD='GBP'
01:01:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:01:56  15  /

Explained.

Elapsed: 00:00:00.24
01:01:56 SQL> @@xp
01:01:56 SQL> REM xp.sql
01:01:56 SQL> REM spool xp
01:01:56 SQL> REM set pages 9999 lines 200 autotrace off
01:01:56 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 387550712

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1967 |   147K|    76   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1967 |   147K|    76   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1967 |   147K|    75   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7576 |   429K|    73   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE       |                   | 72486 |  2052K|    70   (2)| 00:00:01 |     8 |     8 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 72486 |  2052K|    70   (2)| 00:00:01 |     8 |     8 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"=7)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.13
01:01:56 SQL> REM spool off
01:01:56 SQL> 
01:01:56 SQL> REM 2020
01:01:56 SQL> explain plan for
01:01:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:01:56   3  FROM   PS_LEDGER A
01:01:56   4  ,      PSTREESELECT05 L1
01:01:56   5  ,      PSTREESELECT10 L
01:01:56   6  ,      PSTREESELECT10 L2
01:01:56   7  WHERE  A.LEDGER='ACTUALS'
01:01:56   8  AND    A.FISCAL_YEAR=2020
01:01:56   9  AND    (A.ACCOUNTING_PERIOD = 7)
01:01:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:01:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:01:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:01:56  13  AND    A.CURRENCY_CD='GBP'
01:01:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:01:56  15  /

Explained.

Elapsed: 00:00:00.25
01:01:56 SQL> @@xp
01:01:56 SQL> REM xp.sql
01:01:56 SQL> REM spool xp
01:01:56 SQL> REM set pages 9999 lines 200 autotrace off
01:01:56 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2698791447

-------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                               | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                        |                   |     1 |    92 |     6  (17)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                          |                   |     1 |    92 |     6  (17)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                             |                   |     1 |    92 |     5   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                         |                   |     1 |    92 |     5   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                          |                   |     1 |    73 |     4   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                      |                   |     1 |    73 |     4   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR             |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                       |                   |     1 |    55 |     3   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                   |                   |     1 |    55 |     3   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR          |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE       |                   |     1 |    44 |     2   (0)| 00:00:01 |     8 |     8 |
|  * 12 |             MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |     1 |    44 |     2   (0)| 00:00:01 |     8 |     8 |
|  * 13 |           INDEX RANGE SCAN              | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 14 |          INDEX RANGE SCAN               | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 15 |        INDEX RANGE SCAN                 | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 16 |       INDEX RANGE SCAN                  | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 17 |     INDEX RANGE SCAN                    | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 18 |    INDEX RANGE SCAN                     | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
  12 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4
  13 - SEL$1E60250C / L1@SEL$1
  14 - SEL$1E60250C / L1@SEL$1
  15 - SEL$1E60250C / L@SEL$1
  16 - SEL$1E60250C / L@SEL$1
  17 - SEL$1E60250C / L2@SEL$1
  18 - SEL$1E60250C / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      USE_NL(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L1"@"SEL$1")
      LEADING(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  12 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"=7)
  13 - access("L1"."SELECTOR_NUM"=30982 AND "MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  14 - access("L1"."SELECTOR_NUM"=30982)
  15 - access("L"."SELECTOR_NUM"=30985 AND "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
  16 - access("L"."SELECTOR_NUM"=30985)
  17 - access("L2"."SELECTOR_NUM"=30984 AND "MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
  18 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


103 rows selected.

Elapsed: 00:00:00.17
01:01:57 SQL> REM spool off
01:01:57 SQL> 
01:01:57 SQL> set autotrace off
01:01:57 SQL> 
01:01:57 SQL> @@pop2020m7
01:01:57 SQL> REM pop2020m7.sql
01:01:57 SQL> set autotrace off
01:01:57 SQL> insert into ps_ledger
01:01:57   2  with n as (
01:01:57   3  SELECT rownum n from dual connect by level <= 1e6/13
01:01:57   4  --), fy as (
01:01:57   5  --SELECT 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
01:01:57   6  --), ap as (
01:01:57   7  --SELECT FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
01:01:57   8  --UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
01:01:57   9  --UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
01:01:57  10  --), l as (
01:01:57  11  --SELECT 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
01:01:57  12  --UNION ALL SELECT 'BUDGET' FROM DUAL
01:01:57  13  )
01:01:57  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
01:01:57  15  ,      'ACTUALS' ledger
01:01:57  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
01:01:57  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
01:01:57  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
01:01:57  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
01:01:57  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
01:01:57  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
01:01:57  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
01:01:57  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
01:01:57  24  ,      ' ' budget_ref
01:01:57  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
01:01:57  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
01:01:57  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
01:01:57  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
01:01:57  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
01:01:57  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
01:01:57  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
01:01:57  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
01:01:57  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
01:01:57  34  ,      'GBP' currency_cd
01:01:57  35  ,      ' ' statistics_code
01:01:57  36  ,      2020 fiscal_year
01:01:57  37  ,      7 accounting_period
01:01:57  38  ,      dbms_random.value(0,1e6) posted_total_amt
01:01:57  39  ,      0 posted_base_amt
01:01:57  40  ,      0 posted_tran_amt
01:01:57  41  ,      'GBP' base_currency
01:01:57  42  ,      SYSDATE dttm_stamp_sec
01:01:57  43  ,      0 process_instance
01:01:57  44  FROM   n
01:01:57  45  --WHERE  l.ledger = 'ACTUALS'
01:01:57  46  --AND    fy.fiscal_year = 2020
01:01:57  47  --AND    ap.accounting_period = 7
01:01:57  48  /

76923 rows created.

Elapsed: 00:00:56.17
01:02:53 SQL> set lines 200 pages 999 autotrace off
01:02:53 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               COMPLETE VALID
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
01:02:53 SQL> commit;

Commit complete.

Elapsed: 00:00:00.04
01:02:53 SQL> column owner format a10
01:02:53 SQL> column table_name format a15
01:02:53 SQL> column mview_name format a15
01:02:53 SQL> column detailobj_owner format a10 heading 'Detailobj|Owner'
01:02:53 SQL> column detailobj_name  format a15
01:02:53 SQL> column detailobj_alias format a20
01:02:53 SQL> column detail_partition_name format a20
01:02:53 SQL> column detail_subpartition_name format a20
01:02:53 SQL> column parent_table_partition format a20
01:02:53 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME      STALENESS           LAST_REF COMPILE_STATE
--------------- ------------------- -------- -------------------
MV_LEDGER_2019  NEEDS_COMPILE       COMPLETE NEEDS_COMPILE
MV_LEDGER_2020  NEEDS_COMPILE       COMPLETE NEEDS_COMPILE

Elapsed: 00:00:00.00
01:02:53 SQL> select * from user_mview_detail_relations;

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAILOBJ DETAILOBJ_ALIAS      D NUM_FRESH_PCT_PARTITIONS NUM_STALE_PCT_PARTITIONS
---------- --------------- ---------- --------------- --------- -------------------- - ------------------------ ------------------------
SCOTT      MV_LEDGER_2019  SCOTT      PS_LEDGER       TABLE     PS_LEDGER            Y                       55                        1
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       TABLE     PS_LEDGER            Y                       55                        1

Elapsed: 00:00:13.47
01:03:06 SQL> select * from user_mview_detail_partition;

no rows selected

Elapsed: 00:00:00.00
01:03:06 SQL> select * from user_mview_detail_subpartition where freshness != 'FRESH';

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAIL_PARTITION_NAM DETAIL_SUBPARTITION_ DETAIL_SUBPARTITION_POSITION FRESH
---------- --------------- ---------- --------------- -------------------- -------------------- ---------------------------- -----
SCOTT      MV_LEDGER_2019  SCOTT      PS_LEDGER       AP_07                AP_07_LEDGER_2020                               3 STALE
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       AP_07                AP_07_LEDGER_2020                               3 STALE

Elapsed: 00:00:00.02
01:03:06 SQL> 
01:03:06 SQL> @@mvsql
01:03:06 SQL> REM mvsql.sql
01:03:06 SQL> set autotrace off
01:03:06 SQL> 
01:03:06 SQL> REM 2018
01:03:06 SQL> set lines 200 pages 999
01:03:06 SQL> explain plan for
01:03:06   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:03:06   3  FROM   PS_LEDGER A
01:03:06   4  ,      PSTREESELECT05 L1
01:03:06   5  ,      PSTREESELECT10 L
01:03:06   6  ,      PSTREESELECT10 L2
01:03:06   7  WHERE  A.LEDGER='ACTUALS'
01:03:06   8  AND    A.FISCAL_YEAR=2018
01:03:06   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
01:03:06  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:03:06  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:03:06  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:03:06  13  AND    A.CURRENCY_CD='GBP'
01:03:06  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:03:06  15  /

Explained.

Elapsed: 00:00:00.17
01:03:06 SQL> @@xp
01:03:06 SQL> REM xp.sql
01:03:06 SQL> REM spool xp
01:03:06 SQL> REM set pages 9999 lines 200 autotrace off
01:03:06 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2690363151

-----------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                   |   717 | 66681 |  2244   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY              |                   |   717 | 66681 |  2244   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                 |                   |   717 | 66681 |  2243   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN         | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                |                   |  2776 |   200K|  2241   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN    |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN       | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT            |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN      | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR|                   | 26693 |  1173K|  2238   (1)| 00:00:01 |     2 |     7 |
|  10 |      PARTITION RANGE SINGLE |                   | 26693 |  1173K|  2238   (1)| 00:00:01 |     1 |     1 |
|* 11 |       TABLE ACCESS FULL     | PS_LEDGER         | 26693 |  1173K|  2238   (1)| 00:00:01 |       |       |
-----------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."FISCAL_YEAR"=2018 AND "A"."LEDGER"='ACTUALS' AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDA
        TA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA
        [L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.11
01:03:07 SQL> REM spool off
01:03:07 SQL> 
01:03:07 SQL> REM 2019
01:03:07 SQL> explain plan for
01:03:07   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:03:07   3  FROM   PS_LEDGER A
01:03:07   4  ,      PSTREESELECT05 L1
01:03:07   5  ,      PSTREESELECT10 L
01:03:07   6  ,      PSTREESELECT10 L2
01:03:07   7  WHERE  A.LEDGER='ACTUALS'
01:03:07   8  AND    A.FISCAL_YEAR=2019
01:03:07   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
01:03:07  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:03:07  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:03:07  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:03:07  13  AND    A.CURRENCY_CD='GBP'
01:03:07  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:03:07  15  /

Explained.

Elapsed: 00:00:00.24
01:03:07 SQL> @@xp
01:03:07 SQL> REM xp.sql
01:03:07 SQL> REM spool xp
01:03:07 SQL> REM set pages 9999 lines 200 autotrace off
01:03:07 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1498194812

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1848 |   138K|   421   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1848 |   138K|   421   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1848 |   138K|   420   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7157 |   405K|   418   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   | 68816 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 68816 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.13
01:03:07 SQL> REM spool off
01:03:07 SQL> 
01:03:07 SQL> REM 2020
01:03:07 SQL> explain plan for
01:03:07   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:03:07   3  FROM   PS_LEDGER A
01:03:07   4  ,      PSTREESELECT05 L1
01:03:07   5  ,      PSTREESELECT10 L
01:03:07   6  ,      PSTREESELECT10 L2
01:03:07   7  WHERE  A.LEDGER='ACTUALS'
01:03:07   8  AND    A.FISCAL_YEAR=2020
01:03:07   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
01:03:07  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:03:07  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:03:07  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:03:07  13  AND    A.CURRENCY_CD='GBP'
01:03:07  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:03:07  15  /

Explained.

Elapsed: 00:00:00.24
01:03:07 SQL> @@xp
01:03:07 SQL> REM xp.sql
01:03:07 SQL> REM spool xp
01:03:07 SQL> REM set pages 9999 lines 200 autotrace off
01:03:07 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3016493666

------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   | 13375 |  1005K|       |   673   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   | 13375 |  1005K|  1176K|   673   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   | 13375 |  1005K|       |   429   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   | 51791 |  2933K|       |   427   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   |   497K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   497K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  10 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGE
        R_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]
        ></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D
        5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CD
        ATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></
        s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v>
        </o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><
        t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h
        ></f></q>


83 rows selected.

Elapsed: 00:00:00.13
01:03:07 SQL> REM spool off
01:03:07 SQL> 
01:03:07 SQL> explain plan for
01:03:07   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:03:07   3  FROM   PS_LEDGER A
01:03:07   4  ,      PSTREESELECT05 L1
01:03:07   5  ,      PSTREESELECT10 L
01:03:07   6  ,      PSTREESELECT10 L2
01:03:07   7  WHERE  A.LEDGER='ACTUALS'
01:03:07   8  AND    A.FISCAL_YEAR=2019
01:03:07   9  AND    A.ACCOUNTING_PERIOD = 7
01:03:07  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:03:07  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:03:07  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:03:07  13  AND    A.CURRENCY_CD='GBP'
01:03:07  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:03:07  15  /

Explained.

Elapsed: 00:00:00.22
01:03:07 SQL> @@xp
01:03:07 SQL> REM xp.sql
01:03:07 SQL> REM spool xp
01:03:07 SQL> REM set pages 9999 lines 200 autotrace off
01:03:07 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 387550712

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1967 |   147K|    76   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1967 |   147K|    76   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1967 |   147K|    75   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7576 |   429K|    73   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE       |                   | 72486 |  2052K|    70   (2)| 00:00:01 |     8 |     8 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 72486 |  2052K|    70   (2)| 00:00:01 |     8 |     8 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"=7)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.13
01:03:08 SQL> REM spool off
01:03:08 SQL> 
01:03:08 SQL> REM 2020
01:03:08 SQL> explain plan for
01:03:08   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:03:08   3  FROM   PS_LEDGER A
01:03:08   4  ,      PSTREESELECT05 L1
01:03:08   5  ,      PSTREESELECT10 L
01:03:08   6  ,      PSTREESELECT10 L2
01:03:08   7  WHERE  A.LEDGER='ACTUALS'
01:03:08   8  AND    A.FISCAL_YEAR=2020
01:03:08   9  AND    (A.ACCOUNTING_PERIOD = 7)
01:03:08  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:03:08  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:03:08  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:03:08  13  AND    A.CURRENCY_CD='GBP'
01:03:08  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:03:08  15  /

Explained.

Elapsed: 00:00:00.13
01:03:08 SQL> @@xp
01:03:08 SQL> REM xp.sql
01:03:08 SQL> REM spool xp
01:03:08 SQL> REM set pages 9999 lines 200 autotrace off
01:03:08 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1321682226

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     8 |     8 |
|    12 |             PARTITION RANGE SINGLE                    |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    31 |    31 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    31 |    31 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.17
01:03:08 SQL> REM spool off
01:03:08 SQL> 
01:03:08 SQL> set autotrace off
01:03:08 SQL> 
01:03:08 SQL> @@mvtrc
01:03:08 SQL> REM mvtrc.sql
01:03:08 SQL> disconnect
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.9.0.0.0
01:03:08 SQL> connect scott/tiger@oracle_pdb
Connected.
01:03:08 SQL> alter session set nls_date_Format = 'hh24:mi:ss dd/mm/yyyy';

Session altered.

Elapsed: 00:00:00.01
01:03:08 SQL> 
01:03:08 SQL> column name format a20
01:03:08 SQL> column value format a70
01:03:08 SQL> select * from v$diag_info where name like '%Trace%';

   INST_ID NAME                 VALUE                                                                      CON_ID
---------- -------------------- ---------------------------------------------------------------------- ----------
         1 Diag Trace           /u01/app/oracle/diag/rdbms/oracle/oracle/trace                                  0
         1 Default Trace File   /u01/app/oracle/diag/rdbms/oracle/oracle/trace/oracle_ora_19391.trc             0

Elapsed: 00:00:00.05
01:03:08 SQL> 
01:03:08 SQL> alter session set tracefile_identifier=PCT;

Session altered.

Elapsed: 00:00:00.00
01:03:08 SQL> alter session set sql_trace = true;

Session altered.

Elapsed: 00:00:00.00
01:03:08 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:06.28
01:03:14 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:04.94
01:03:19 SQL> alter session set sql_trace = false;

Session altered.

Elapsed: 00:00:00.00
01:03:19 SQL> 
01:03:19 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.67
01:03:20 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.25
01:03:20 SQL> 
01:03:20 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2019');

PL/SQL procedure successfully completed.

Elapsed: 00:00:30.38
01:03:51 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:15.82
01:04:06 SQL> 
01:04:06 SQL> @@mvvol
01:04:06 SQL> REM mvvol.sql
01:04:06 SQL> 
01:04:06 SQL> set autotrace off
01:04:06 SQL> break on table_name skip 1 on partition_name
01:04:06 SQL> column table_name format a15
01:04:06 SQL> column column_name format a20
01:04:06 SQL> column mview_name format a20
01:04:06 SQL> column partition_position format 999 heading 'Part|Pos'
01:04:06 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
01:04:06 SQL> column partition_name format a20
01:04:06 SQL> column subpartition_name format a25
01:04:06 SQL> column num_rows format 9999999
01:04:06 SQL> column num_distinct heading 'Num|Distinct' format 9999999
01:04:06 SQL> column num_buckets heading 'Num|Buckets'	format 9999
01:04:06 SQL> column blocks format 99999
01:04:06 SQL> column rpb format 999.9 heading 'Rows|per|Block'
01:04:06 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               FAST_PCT VALID
MV_LEDGER_2020       FRESH               FAST_PCT VALID

Elapsed: 00:00:00.00
01:04:06 SQL> 
01:04:06 SQL> select count(*) from mv_ledger_2019;

  COUNT(*)
----------
    946935

Elapsed: 00:00:00.05
01:04:06 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
    582459

Elapsed: 00:00:00.04
01:04:07 SQL> 
01:04:07 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
01:04:07   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
01:04:07   3  , COALESCE(c.compression, b.compression) compression
01:04:07   4  , COALESCE(c.compress_for, b.compress_for) compress_for
01:04:07   5  from user_tab_statistics a
01:04:07   6  	LEFT OUTER JOIN user_tab_partitions b
01:04:07   7  	  ON a.table_name = b.table_name
01:04:07   8  	  AND a.partition_name = b.partition_name
01:04:07   9  	LEFT OUTER JOIN user_tab_subpartitions c
01:04:07  10  	  ON a.table_name = c.table_name
01:04:07  11  	  AND a.partition_name = c.partition_name
01:04:07  12  	  AND a.subpartition_name = c.subpartition_name
01:04:07  13  where a.table_name like '%LEDGER%'
01:04:07  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
01:04:07  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2019     1 AP_BF                                                  72660    251  289.5 ENABLED  BASIC
                   2 AP_01                                                  72527    251  289.0 ENABLED  BASIC
                   3 AP_02                                                  72532    251  289.0 ENABLED  BASIC
                   4 AP_03                                                  72225    250  288.9 ENABLED  BASIC
                   5 AP_04                                                  72747    251  289.8 ENABLED  BASIC
                   6 AP_05                                                  72939    252  289.4 ENABLED  BASIC
                   7 AP_06                                                  72509    251  288.9 ENABLED  BASIC
                   8 AP_07                                                  72486    251  288.8 ENABLED  BASIC
                   9 AP_08                                                  73046    252  289.9 ENABLED  BASIC
                  10 AP_09                                                  72842    252  289.1 ENABLED  BASIC
                  11 AP_10                                                  72832    252  289.0 ENABLED  BASIC
                  12 AP_11                                                  73077    252  290.0 ENABLED  BASIC
                  13 AP_12                                                  72514    251  288.9 ENABLED  BASIC
                  14 AP_CF                                                   1999     25   80.0 ENABLED  BASIC
                                                                           946935   3292  287.6

MV_LEDGER_2020     1 AP_BF                                                  72936    256  284.9 ENABLED  BASIC
                   2 AP_01                                                  72875    256  284.7 ENABLED  BASIC
                   3 AP_02                                                  72820    256  284.5 ENABLED  BASIC
                   4 AP_03                                                  72491    256  283.2 ENABLED  BASIC
                   5 AP_04                                                  72799    256  284.4 ENABLED  BASIC
                   6 AP_05                                                  72814    256  284.4 ENABLED  BASIC
                   7 AP_06                                                  72889    256  284.7 ENABLED  BASIC
                   8 AP_07                                                  72835    193  377.4 ENABLED  BASIC
                   9 AP_08                                                      0      0        ENABLED  BASIC
                  10 AP_09                                                      0      0        ENABLED  BASIC
                  11 AP_10                                                      0      0        ENABLED  BASIC
                  12 AP_11                                                      0      0        ENABLED  BASIC
                  13 AP_12                                                      0      0        ENABLED  BASIC
                  14 AP_CF                                                      0      0        ENABLED  BASIC
                                                                           582459   1985  293.4

PS_LEDGER          1 AP_BF                                                 261458   5147   50.8 NONE
                   1                         1 AP_BF_LEDGER_2018            84565   1372   61.6 ENABLED  BASIC
                   1                         2 AP_BF_LEDGER_2019            84519   1371   61.6 ENABLED  BASIC
                   1                         3 AP_BF_LEDGER_2020            84673   2193   38.6 DISABLED
                   1                         4 AP_BF_LEDGER_2021             7701    211   36.5 DISABLED
                   2 AP_01                                                 261108   5174   50.5 NONE
                   2                         1 AP_01_LEDGER_2018            84268   1368   61.6 ENABLED  BASIC
                   2                         2 AP_01_LEDGER_2019            84233   1366   61.7 ENABLED  BASIC
                   2                         3 AP_01_LEDGER_2020            84831   2224   38.1 DISABLED
                   2                         4 AP_01_LEDGER_2021             7776    216   36.0 DISABLED
                   3 AP_02                                                 261174   5172   50.5 NONE
                   3                         1 AP_02_LEDGER_2018            84372   1369   61.6 ENABLED  BASIC
                   3                         2 AP_02_LEDGER_2019            84444   1370   61.6 ENABLED  BASIC
                   3                         3 AP_02_LEDGER_2020            84596   2218   38.1 DISABLED
                   3                         4 AP_02_LEDGER_2021             7762    215   36.1 DISABLED
                   4 AP_03                                                 259982   5149   50.5 NONE
                   4                         1 AP_03_LEDGER_2018            84105   1364   61.7 ENABLED  BASIC
                   4                         2 AP_03_LEDGER_2019            83820   1360   61.6 ENABLED  BASIC
                   4                         3 AP_03_LEDGER_2020            84284   2210   38.1 DISABLED
                   4                         4 AP_03_LEDGER_2021             7773    215   36.2 DISABLED
                   5 AP_04                                                 261376   5177   50.5 NONE
                   5                         1 AP_04_LEDGER_2018            84378   1369   61.6 ENABLED  BASIC
                   5                         2 AP_04_LEDGER_2019            84649   1374   61.6 ENABLED  BASIC
                   5                         3 AP_04_LEDGER_2020            84652   2220   38.1 DISABLED
                   5                         4 AP_04_LEDGER_2021             7697    214   36.0 DISABLED
                   6 AP_05                                                 261772   5180   50.5 NONE
                   6                         1 AP_05_LEDGER_2018            84984   1378   61.7 ENABLED  BASIC
                   6                         2 AP_05_LEDGER_2019            84656   1374   61.6 ENABLED  BASIC
                   6                         3 AP_05_LEDGER_2020            84507   2216   38.1 DISABLED
                   6                         4 AP_05_LEDGER_2021             7625    212   36.0 DISABLED
                   7 AP_06                                                 260581   5165   50.5 NONE
                   7                         1 AP_06_LEDGER_2018            83994   1363   61.6 ENABLED  BASIC
                   7                         2 AP_06_LEDGER_2019            84150   1366   61.6 ENABLED  BASIC
                   7                         3 AP_06_LEDGER_2020            84729   2222   38.1 DISABLED
                   7                         4 AP_06_LEDGER_2021             7708    214   36.0 DISABLED
                   8 AP_07                                                 184118   3163   58.2 NONE
                   8                         1 AP_07_LEDGER_2018            84863   1377   61.6 ENABLED  BASIC
                   8                         2 AP_07_LEDGER_2019            84155   1366   61.6 ENABLED  BASIC
                   8                         3 AP_07_LEDGER_2020             7587    211   36.0 DISABLED
                   8                         4 AP_07_LEDGER_2021             7513    209   35.9 DISABLED
                   9 AP_08                                                 184619   3173   58.2 NONE
                   9                         1 AP_08_LEDGER_2018            84547   1372   61.6 ENABLED  BASIC
                   9                         2 AP_08_LEDGER_2019            84775   1376   61.6 ENABLED  BASIC
                   9                         3 AP_08_LEDGER_2020             7662    213   36.0 DISABLED
                   9                         4 AP_08_LEDGER_2021             7635    212   36.0 DISABLED
                  10 AP_09                                                 184375   3168   58.2 NONE
                  10                         1 AP_09_LEDGER_2018            84407   1370   61.6 ENABLED  BASIC
                  10                         2 AP_09_LEDGER_2019            84645   1373   61.6 ENABLED  BASIC
                  10                         3 AP_09_LEDGER_2020             7570    210   36.0 DISABLED
                  10                         4 AP_09_LEDGER_2021             7753    215   36.1 DISABLED
                  11 AP_10                                                 184327   3166   58.2 NONE
                  11                         1 AP_10_LEDGER_2018            84300   1368   61.6 ENABLED  BASIC
                  11                         2 AP_10_LEDGER_2019            84738   1374   61.7 ENABLED  BASIC
                  11                         3 AP_10_LEDGER_2020             7656    212   36.1 DISABLED
                  11                         4 AP_10_LEDGER_2021             7633    212   36.0 DISABLED
                  12 AP_11                                                 184489   3167   58.3 NONE
                  12                         1 AP_11_LEDGER_2018            84406   1369   61.7 ENABLED  BASIC
                  12                         2 AP_11_LEDGER_2019            84861   1376   61.7 ENABLED  BASIC
                  12                         3 AP_11_LEDGER_2020             7700    213   36.2 DISABLED
                  12                         4 AP_11_LEDGER_2021             7522    209   36.0 DISABLED
                  13 AP_12                                                 184244   3168   58.2 NONE
                  13                         1 AP_12_LEDGER_2018            84611   1373   61.6 ENABLED  BASIC
                  13                         2 AP_12_LEDGER_2019            84155   1365   61.7 ENABLED  BASIC
                  13                         3 AP_12_LEDGER_2020             7776    216   36.0 DISABLED
                  13                         4 AP_12_LEDGER_2021             7702    214   36.0 DISABLED
                  14 AP_CF                                                   4800    154   31.2 NONE
                  14                         1 AP_CF_LEDGER_2018             2200     53   41.5 ENABLED  BASIC
                  14                         2 AP_CF_LEDGER_2019             2200     53   41.5 ENABLED  BASIC
                  14                         3 AP_CF_LEDGER_2020              200     24    8.3 DISABLED
                  14                         4 AP_CF_LEDGER_2021              200     24    8.3 DISABLED
                                                                          2938423  55323   53.1


101 rows selected.

Elapsed: 00:00:00.08
01:04:07 SQL> 
01:04:07 SQL> column extension format a40
01:04:07 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
01:04:07   2  from user_tab_col_statistics s
01:04:07   3  	LEFT OUTER JOIN user_stat_extensions e
01:04:07   4  	ON e.table_name = s.table_name
01:04:07   5  	AND e.extension_name = s.column_name
01:04:07   6  where s.table_name like 'MV_LEDGER%'
01:04:07   7  order by 1,2
01:04:07   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  ACCOUNT                   999       1 NONE            01:03:28 19/11/2020
                ACCOUNTING_PERIOD          15       1 NONE            01:03:28 19/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       01:03:28 19/11/2020
                CHARTFIELD1              1000       1 NONE            01:03:28 19/11/2020
                FISCAL_YEAR                 1       1 NONE            01:03:28 19/11/2020
                POSTED_TOTAL_AMT       946935       1 NONE            01:03:28 19/11/2020
                SYS_NC00007$                2       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$             1000       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )


MV_LEDGER_2020  ACCOUNT                   999       1 NONE            01:03:55 19/11/2020
                ACCOUNTING_PERIOD           8       1 NONE            01:03:55 19/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       01:03:55 19/11/2020
                CHARTFIELD1               999       1 NONE            01:03:55 19/11/2020
                FISCAL_YEAR                 1       1 NONE            01:03:55 19/11/2020
                POSTED_TOTAL_AMT       582459       1 NONE            01:03:55 19/11/2020
                SYS_NC00007$                2       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              999       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$                8       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )



22 rows selected.

Elapsed: 00:00:00.07
01:04:07 SQL> column extension format a40
01:04:07 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
01:04:07   2  from user_part_col_statistics s
01:04:07   3  	LEFT OUTER JOIN user_stat_extensions e
01:04:07   4  	ON e.table_name = s.table_name
01:04:07   5  	AND e.extension_name = s.column_name
01:04:07   6  where s.table_name like 'MV_LEDGER%'
01:04:07   7  order by 1,2
01:04:07   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  AP_01                SYS_NC00011$                1       1 NONE            01:03:20 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:20 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:03:20 19/11/2020
                                     CHARTFIELD1               991       1 NONE            01:03:20 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:20 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:20 19/11/2020
                                     POSTED_TOTAL_AMT        72527       1 NONE            01:03:20 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:20 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:03:20 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            01:03:20 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:20 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_02                SYS_NC00011$                1       1 NONE            01:03:21 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:21 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:03:21 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:03:21 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:21 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:21 19/11/2020
                                     POSTED_TOTAL_AMT        71872       1 NONE            01:03:21 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:21 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:03:21 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:03:21 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:21 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_03                SYS_NC00011$                1       1 NONE            01:03:22 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:22 19/11/2020
                                     ACCOUNT                   989       1 NONE            01:03:22 19/11/2020
                                     CHARTFIELD1               991       1 NONE            01:03:22 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:22 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:22 19/11/2020
                                     POSTED_TOTAL_AMT        71584       1 NONE            01:03:22 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:22 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              989       1 NONE            01:03:22 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            01:03:22 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:22 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_04                POSTED_TOTAL_AMT        72120       1 NONE            01:03:23 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:23 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:03:23 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:03:23 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:23 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:23 19/11/2020
                AP_05                SYS_NC00011$                1       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:23 19/11/2020
                                     ACCOUNT                   994       1 NONE            01:03:23 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:23 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:23 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:23 19/11/2020
                                     POSTED_TOTAL_AMT        72656       1 NONE            01:03:23 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:23 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_06                SYS_NC00011$                1       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:24 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:03:24 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:03:24 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:24 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:24 19/11/2020
                                     POSTED_TOTAL_AMT        72509       1 NONE            01:03:24 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_07                SYS_NC00011$                1       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:24 19/11/2020
                                     ACCOUNT                   994       1 NONE            01:03:24 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:03:24 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:24 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:24 19/11/2020
                                     POSTED_TOTAL_AMT        72486       1 NONE            01:03:24 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:24 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_08                SYS_NC00011$                1       1 NONE            01:03:25 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:25 19/11/2020
                                     ACCOUNT                   996       1 NONE            01:03:25 19/11/2020
                                     CHARTFIELD1               989       1 NONE            01:03:25 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:25 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:25 19/11/2020
                                     POSTED_TOTAL_AMT        73046       1 NONE            01:03:25 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:25 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              996       1 NONE            01:03:25 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              989       1 NONE            01:03:25 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:25 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_09                SYS_NC00011$                1       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:26 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:03:26 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:26 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:26 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:26 19/11/2020
                                     POSTED_TOTAL_AMT        72504       1 NONE            01:03:26 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_10                SYS_NC00011$                1       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:26 19/11/2020
                                     ACCOUNT                   989       1 NONE            01:03:26 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:03:26 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:26 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:26 19/11/2020
                                     POSTED_TOTAL_AMT        72416       1 NONE            01:03:26 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              989       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:26 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_11                SYS_NC00011$                1       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:27 19/11/2020
                                     ACCOUNT                   995       1 NONE            01:03:27 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:03:27 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:27 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:27 19/11/2020
                                     POSTED_TOTAL_AMT        72168       1 NONE            01:03:27 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_12                SYS_NC00011$                1       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:27 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:03:27 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:27 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:27 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:27 19/11/2020
                                     POSTED_TOTAL_AMT        72514       1 NONE            01:03:27 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:27 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_BF                SYS_NC00011$                1       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:28 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:03:28 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:28 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:28 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:28 19/11/2020
                                     POSTED_TOTAL_AMT        72112       1 NONE            01:03:28 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_CF                SYS_NC00011$                2       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:28 19/11/2020
                                     ACCOUNT                   751       1 NONE            01:03:28 19/11/2020
                                     CHARTFIELD1               766       1 NONE            01:03:28 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:28 19/11/2020
                                     ACCOUNTING_PERIOD           2       1 NONE            01:03:28 19/11/2020
                                     POSTED_TOTAL_AMT         1999       1 NONE            01:03:28 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              751       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              766       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:28 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))

MV_LEDGER_2020  AP_01                SYS_NC00011$                1       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:51 19/11/2020
                                     ACCOUNT                   996       1 NONE            01:03:51 19/11/2020
                                     CHARTFIELD1               995       1 NONE            01:03:51 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:51 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:51 19/11/2020
                                     POSTED_TOTAL_AMT        72576       1 NONE            01:03:51 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              996       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_02                SYS_NC00011$                1       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:51 19/11/2020
                                     ACCOUNT                   990       1 NONE            01:03:51 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:51 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:51 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:51 19/11/2020
                                     POSTED_TOTAL_AMT        72288       1 NONE            01:03:51 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              990       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:51 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_03                SYS_NC00011$                1       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:52 19/11/2020
                                     ACCOUNT                   991       1 NONE            01:03:52 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:52 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:52 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:52 19/11/2020
                                     POSTED_TOTAL_AMT        72491       1 NONE            01:03:52 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_04                SYS_NC00011$                1       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:52 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:03:52 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:52 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:52 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:52 19/11/2020
                                     POSTED_TOTAL_AMT        72456       1 NONE            01:03:52 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:52 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_05                SYS_NC00011$                1       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:53 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:03:53 19/11/2020
                                     CHARTFIELD1               996       1 NONE            01:03:53 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:53 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:53 19/11/2020
                                     POSTED_TOTAL_AMT        71968       1 NONE            01:03:53 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              996       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_06                SYS_NC00011$                1       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:53 19/11/2020
                                     ACCOUNT                   997       1 NONE            01:03:53 19/11/2020
                                     CHARTFIELD1               993       1 NONE            01:03:53 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:53 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:53 19/11/2020
                                     POSTED_TOTAL_AMT        72889       1 NONE            01:03:53 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              997       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:53 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_07                SYS_NC00011$                1       1 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:54 19/11/2020
                                     ACCOUNT                   992       1 NONE            01:03:54 19/11/2020
                                     CHARTFIELD1               992       1 NONE            01:03:54 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:54 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:54 19/11/2020
                                     POSTED_TOTAL_AMT        72835       1 NONE            01:03:54 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_08                SYS_NC00011$                0       0 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:03:54 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:03:54 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:03:54 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:03:54 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:03:54 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:03:54 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:03:54 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_09                BUSINESS_UNIT               0       0 NONE            01:03:55 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:03:55 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:03:55 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:03:55 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     ACCOUNT                     0       0 NONE            01:03:55 19/11/2020
                AP_10                SYS_NC00011$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:03:55 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:03:55 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:03:55 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:03:55 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_11                SYS_NC00011$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:03:55 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:03:55 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:03:55 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:03:55 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_12                SYS_NC00011$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:03:55 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:03:55 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:03:55 19/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            01:03:55 19/11/2020
                                     SYS_NC00007$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_BF                SYS_NC00011$                1       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       01:03:55 19/11/2020
                                     ACCOUNT                   993       1 NONE            01:03:55 19/11/2020
                                     CHARTFIELD1               994       1 NONE            01:03:55 19/11/2020
                                     FISCAL_YEAR                 1       1 NONE            01:03:55 19/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            01:03:55 19/11/2020
                                     POSTED_TOTAL_AMT        72784       1 NONE            01:03:55 19/11/2020
                                     SYS_NC00007$                2       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_CF                SYS_NC00011$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     SYS_NC00010$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00009$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00008$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00007$                0       0 NONE            01:03:55 19/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     POSTED_TOTAL_AMT            0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            01:03:55 19/11/2020
                                     FISCAL_YEAR                 0       0 NONE            01:03:55 19/11/2020
                                     CHARTFIELD1                 0       0 NONE            01:03:55 19/11/2020
                                     ACCOUNT                     0       0 NONE            01:03:55 19/11/2020
                                     BUSINESS_UNIT               0       0 NONE            01:03:55 19/11/2020


308 rows selected.

Elapsed: 00:00:00.25
01:04:07 SQL> 
01:04:07 SQL> column extension format a40
01:04:07 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
01:04:07   2  from user_subpart_col_statistics s
01:04:07   3  	LEFT OUTER JOIN user_stat_extensions e
01:04:07   4  	ON e.table_name = s.table_name
01:04:07   5  	AND e.extension_name = s.column_name
01:04:07   6  where s.table_name like 'MV_LEDGER%'
01:04:07   7  order by 1,2
01:04:07   8  ;

no rows selected

Elapsed: 00:00:00.01
01:04:07 SQL> @@mvsql
01:04:07 SQL> REM mvsql.sql
01:04:07 SQL> set autotrace off
01:04:07 SQL> 
01:04:07 SQL> REM 2018
01:04:07 SQL> set lines 200 pages 999
01:04:07 SQL> explain plan for
01:04:07   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:04:07   3  FROM   PS_LEDGER A
01:04:07   4  ,      PSTREESELECT05 L1
01:04:07   5  ,      PSTREESELECT10 L
01:04:07   6  ,      PSTREESELECT10 L2
01:04:07   7  WHERE  A.LEDGER='ACTUALS'
01:04:07   8  AND    A.FISCAL_YEAR=2018
01:04:07   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
01:04:07  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:04:07  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:04:07  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:04:07  13  AND    A.CURRENCY_CD='GBP'
01:04:07  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:04:07  15  /

Explained.

Elapsed: 00:00:00.16
01:04:07 SQL> @@xp
01:04:07 SQL> REM xp.sql
01:04:07 SQL> REM spool xp
01:04:07 SQL> REM set pages 9999 lines 200 autotrace off
01:04:07 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2690363151

-----------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                   |   717 | 66681 |  2244   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY              |                   |   717 | 66681 |  2244   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                 |                   |   717 | 66681 |  2243   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN         | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                |                   |  2776 |   200K|  2241   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN    |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN       | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT            |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN      | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR|                   | 26693 |  1173K|  2238   (1)| 00:00:01 |     2 |     7 |
|  10 |      PARTITION RANGE SINGLE |                   | 26693 |  1173K|  2238   (1)| 00:00:01 |     1 |     1 |
|* 11 |       TABLE ACCESS FULL     | PS_LEDGER         | 26693 |  1173K|  2238   (1)| 00:00:01 |       |       |
-----------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."FISCAL_YEAR"=2018 AND "A"."LEDGER"='ACTUALS' AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDA
        TA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA
        [L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.13
01:04:07 SQL> REM spool off
01:04:07 SQL> 
01:04:07 SQL> REM 2019
01:04:07 SQL> explain plan for
01:04:07   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:04:07   3  FROM   PS_LEDGER A
01:04:07   4  ,      PSTREESELECT05 L1
01:04:07   5  ,      PSTREESELECT10 L
01:04:07   6  ,      PSTREESELECT10 L2
01:04:07   7  WHERE  A.LEDGER='ACTUALS'
01:04:07   8  AND    A.FISCAL_YEAR=2019
01:04:07   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
01:04:07  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:04:07  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:04:07  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:04:07  13  AND    A.CURRENCY_CD='GBP'
01:04:07  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:04:07  15  /

Explained.

Elapsed: 00:00:00.26
01:04:07 SQL> @@xp
01:04:07 SQL> REM xp.sql
01:04:07 SQL> REM spool xp
01:04:07 SQL> REM set pages 9999 lines 200 autotrace off
01:04:07 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1498194812

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1848 |   138K|   421   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1848 |   138K|   421   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1848 |   138K|   420   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7157 |   405K|   418   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   | 68816 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 68816 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.13
01:04:08 SQL> REM spool off
01:04:08 SQL> 
01:04:08 SQL> REM 2020
01:04:08 SQL> explain plan for
01:04:08   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:04:08   3  FROM   PS_LEDGER A
01:04:08   4  ,      PSTREESELECT05 L1
01:04:08   5  ,      PSTREESELECT10 L
01:04:08   6  ,      PSTREESELECT10 L2
01:04:08   7  WHERE  A.LEDGER='ACTUALS'
01:04:08   8  AND    A.FISCAL_YEAR=2020
01:04:08   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
01:04:08  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:04:08  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:04:08  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:04:08  13  AND    A.CURRENCY_CD='GBP'
01:04:08  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:04:08  15  /

Explained.

Elapsed: 00:00:00.30
01:04:08 SQL> @@xp
01:04:08 SQL> REM xp.sql
01:04:08 SQL> REM spool xp
01:04:08 SQL> REM set pages 9999 lines 200 autotrace off
01:04:08 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3016493666

------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   | 15101 |  1135K|       |   703   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   | 15101 |  1135K|  1328K|   703   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   | 15101 |  1135K|       |   430   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   | 58471 |  3311K|       |   428   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   |   561K|    15M|       |   423   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   561K|    15M|       |   423   (2)| 00:00:01 |     2 |     7 |
------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  10 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGE
        R_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]
        ></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D
        5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CD
        ATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></
        s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v>
        </o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><
        t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h
        ></f></q>


83 rows selected.

Elapsed: 00:00:00.12
01:04:08 SQL> REM spool off
01:04:08 SQL> 
01:04:08 SQL> explain plan for
01:04:08   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:04:08   3  FROM   PS_LEDGER A
01:04:08   4  ,      PSTREESELECT05 L1
01:04:08   5  ,      PSTREESELECT10 L
01:04:08   6  ,      PSTREESELECT10 L2
01:04:08   7  WHERE  A.LEDGER='ACTUALS'
01:04:08   8  AND    A.FISCAL_YEAR=2019
01:04:08   9  AND    A.ACCOUNTING_PERIOD = 7
01:04:08  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:04:08  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:04:08  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:04:08  13  AND    A.CURRENCY_CD='GBP'
01:04:08  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:04:08  15  /

Explained.

Elapsed: 00:00:00.22
01:04:08 SQL> @@xp
01:04:08 SQL> REM xp.sql
01:04:08 SQL> REM spool xp
01:04:08 SQL> REM set pages 9999 lines 200 autotrace off
01:04:08 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 387550712

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1967 |   147K|    77   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1967 |   147K|    77   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1967 |   147K|    76   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   258 |  4902 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7576 |   429K|    74   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE       |                   | 72486 |  2052K|    71   (2)| 00:00:01 |     8 |     8 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 72486 |  2052K|    71   (2)| 00:00:01 |     8 |     8 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"=7)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.14
01:04:08 SQL> REM spool off
01:04:08 SQL> 
01:04:08 SQL> REM 2020
01:04:08 SQL> explain plan for
01:04:08   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
01:04:08   3  FROM   PS_LEDGER A
01:04:08   4  ,      PSTREESELECT05 L1
01:04:08   5  ,      PSTREESELECT10 L
01:04:08   6  ,      PSTREESELECT10 L2
01:04:08   7  WHERE  A.LEDGER='ACTUALS'
01:04:08   8  AND    A.FISCAL_YEAR=2020
01:04:08   9  AND    (A.ACCOUNTING_PERIOD = 7)
01:04:08  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
01:04:08  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
01:04:08  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
01:04:08  13  AND    A.CURRENCY_CD='GBP'
01:04:08  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
01:04:08  15  /

Explained.

Elapsed: 00:00:00.31
01:04:09 SQL> @@xp
01:04:09 SQL> REM xp.sql
01:04:09 SQL> REM spool xp
01:04:09 SQL> REM set pages 9999 lines 200 autotrace off
01:04:09 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1321682226

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     8 |     8 |
|    12 |             PARTITION RANGE SINGLE                    |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    31 |    31 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    31 |    31 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.19
01:04:09 SQL> REM spool off
01:04:09 SQL> 
01:04:09 SQL> set autotrace off
01:04:09 SQL> @@mvcap
01:04:09 SQL> REM mvcap.sql
01:04:09 SQL> REM spool mvcap
01:04:09 SQL> set autotrace off
01:04:09 SQL> create table MV_CAPABILITIES_TABLE
01:04:09   2  (
01:04:09   3  	statement_id	  varchar(30) ,
01:04:09   4  	mvowner 	  varchar(30) ,
01:04:09   5  	mvname		  varchar(30) ,
01:04:09   6  	capability_name   varchar(30) ,
01:04:09   7  	possible	  character(1) ,
01:04:09   8  	related_text	  varchar(2000) ,
01:04:09   9  	related_num	  number ,
01:04:09  10  	msgno		  integer ,
01:04:09  11  	msgtxt		  varchar(2000) ,
01:04:09  12  	seq		  number
01:04:09  13  ) ;
create table MV_CAPABILITIES_TABLE
             *
ERROR at line 1:
ORA-00955: name is already used by an existing object


Elapsed: 00:00:00.00
01:04:09 SQL> 
01:04:09 SQL> truncate table MV_CAPABILITIES_TABLE;

Table truncated.

Elapsed: 00:00:00.06
01:04:09 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2019');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.67
01:04:10 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.05
01:04:10 SQL> break on mvname skip 1
01:04:10 SQL> column rel_text format a20
01:04:10 SQL> column msgtxt format a60
01:04:10 SQL> SELECT mvname, capability_name,  possible, SUBSTR(related_text,1,20) AS rel_text, SUBSTR(msgtxt,1,60) AS msgtxt
01:04:10   2  FROM MV_CAPABILITIES_TABLE
01:04:10   3  WHERE mvname like 'MV_LEDGER_20%'
01:04:10   4  ORDER BY mvname, seq;

MVNAME                         CAPABILITY_NAME                P REL_TEXT             MSGTXT
------------------------------ ------------------------------ - -------------------- ------------------------------------------------------------
MV_LEDGER_2019                 PCT                            Y
                               REFRESH_COMPLETE               Y
                               REFRESH_FAST                   Y
                               REWRITE                        Y
                               PCT_TABLE                      Y PS_LEDGER
                               REFRESH_FAST_AFTER_INSERT      N SCOTT.PS_LEDGER      the detail table does not have a materialized view log
                               REFRESH_FAST_AFTER_ONETAB_DML  N POSTED_TOTAL_AMT     SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      see the reason why REFRESH_FAST_AFTER_INSERT is disabled
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      COUNT(*) is not present in the select list
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ANY_DML     N                      see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
                               REFRESH_FAST_PCT               Y
                               REWRITE_FULL_TEXT_MATCH        Y
                               REWRITE_PARTIAL_TEXT_MATCH     Y
                               REWRITE_GENERAL                Y
                               REWRITE_PCT                    Y
                               PCT_TABLE_REWRITE              Y PS_LEDGER

MV_LEDGER_2020                 PCT                            Y
                               REFRESH_COMPLETE               Y
                               REFRESH_FAST                   Y
                               REWRITE                        Y
                               PCT_TABLE                      Y PS_LEDGER
                               REFRESH_FAST_AFTER_INSERT      N SCOTT.PS_LEDGER      the detail table does not have a materialized view log
                               REFRESH_FAST_AFTER_ONETAB_DML  N POSTED_TOTAL_AMT     SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      see the reason why REFRESH_FAST_AFTER_INSERT is disabled
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      COUNT(*) is not present in the select list
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ANY_DML     N                      see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
                               REFRESH_FAST_PCT               Y
                               REWRITE_FULL_TEXT_MATCH        Y
                               REWRITE_PARTIAL_TEXT_MATCH     Y
                               REWRITE_GENERAL                Y
                               REWRITE_PCT                    Y
                               PCT_TABLE_REWRITE              Y PS_LEDGER


34 rows selected.

Elapsed: 00:00:00.01
01:04:10 SQL> 
01:04:10 SQL> REM spool off
01:04:10 SQL> SPOOL OFF
