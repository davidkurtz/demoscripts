23:43:28 SQL> @@preledger.sql
23:43:28 SQL> REM preledger.sql
23:43:28 SQL> clear screen
23:43:28 SQL> connect scott/tiger@oracle_pdb
Connected.
23:43:28 SQL> set time on timi on autotrace off pages 99 lines 200 trimspool on echo on
23:43:28 SQL> alter session set nls_date_Format = 'hh24:mi:ss dd/mm/yyyy';

Session altered.

Elapsed: 00:00:00.00
23:43:28 SQL> drop table ps_ledger purge;

Table dropped.

Elapsed: 00:00:05.91
23:43:34 SQL> drop materialized view mv_ledger_2019;
drop materialized view mv_ledger_2019
*
ERROR at line 1:
ORA-12003: materialized view or zonemap "SCOTT"."MV_LEDGER_2019" does not exist


Elapsed: 00:00:00.00
23:43:34 SQL> drop table mv_ledger_2019 purge;
drop table mv_ledger_2019 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
23:43:34 SQL> drop materialized view mv_ledger_2020;

Materialized view dropped.

Elapsed: 00:00:00.62
23:43:35 SQL> drop table mv_ledger_2020 purge;
drop table mv_ledger_2020 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
23:43:35 SQL> DROP TABLE PSTREESELECT05 PURGE;

Table dropped.

Elapsed: 00:00:00.08
23:43:35 SQL> DROP TABLE PSTREESELECT10 PURGE;

Table dropped.

Elapsed: 00:00:00.25
23:43:35 SQL> purge recyclebin;

Recyclebin purged.

Elapsed: 00:00:00.00
23:43:35 SQL> 
23:43:35 SQL> CREATE TABLE ps_ledger
23:43:35   2  (business_unit VARCHAR2(5) NOT NULL
23:43:35   3  ,ledger VARCHAR2(10) NOT NULL
23:43:35   4  ,account VARCHAR2(10) NOT NULL
23:43:35   5  ,altacct VARCHAR2(10) NOT NULL
23:43:35   6  ,deptid VARCHAR2(10) NOT NULL
23:43:35   7  ,operating_unit VARCHAR2(8) NOT NULL
23:43:35   8  ,product VARCHAR2(6) NOT NULL
23:43:35   9  ,fund_code VARCHAR2(5) NOT NULL
23:43:35  10  ,class_fld VARCHAR2(5) NOT NULL
23:43:35  11  ,program_code VARCHAR2(5) NOT NULL
23:43:35  12  ,budget_ref VARCHAR2(8) NOT NULL
23:43:35  13  ,affiliate VARCHAR2(5) NOT NULL
23:43:35  14  ,affiliate_intra1 VARCHAR2(10) NOT NULL
23:43:35  15  ,affiliate_intra2 VARCHAR2(10) NOT NULL
23:43:35  16  ,chartfield1 VARCHAR2(10) NOT NULL
23:43:35  17  ,chartfield2 VARCHAR2(10) NOT NULL
23:43:35  18  ,chartfield3 VARCHAR2(10) NOT NULL
23:43:35  19  ,project_id VARCHAR2(15) NOT NULL
23:43:35  20  ,book_code VARCHAR2(4) NOT NULL
23:43:35  21  ,gl_adjust_type VARCHAR2(4) NOT NULL
23:43:35  22  ,currency_cd VARCHAR2(3) NOT NULL
23:43:35  23  ,statistics_code VARCHAR2(3) NOT NULL
23:43:35  24  ,fiscal_year SMALLINT NOT NULL
23:43:35  25  ,accounting_period SMALLINT NOT NULL
23:43:35  26  ,posted_total_amt DECIMAL(26,3) NOT NULL
23:43:35  27  ,posted_base_amt DECIMAL(26,3) NOT NULL
23:43:35  28  ,posted_tran_amt DECIMAL(26,3) NOT NULL
23:43:35  29  ,base_currency VARCHAR2(3) NOT NULL
23:43:35  30  ,dttm_stamp_sec TIMESTAMP
23:43:35  31  ,process_instance DECIMAL(10) NOT NULL
23:43:35  32  ) PCTFREE 10 PCTUSED 80
23:43:35  33  PARTITION BY RANGE (FISCAL_YEAR)
23:43:35  34  SUBPARTITION BY RANGE (ACCOUNTING_PERIOD)
23:43:35  35  SUBPARTITION TEMPLATE
23:43:35  36  (SUBPARTITION ap_bf VALUES LESS THAN (1)
23:43:35  37  ,SUBPARTITION ap_01 VALUES LESS THAN (2)
23:43:35  38  ,SUBPARTITION ap_02 VALUES LESS THAN (3)
23:43:35  39  ,SUBPARTITION ap_03 VALUES LESS THAN (4)
23:43:35  40  ,SUBPARTITION ap_04 VALUES LESS THAN (5)
23:43:35  41  ,SUBPARTITION ap_05 VALUES LESS THAN (6)
23:43:35  42  ,SUBPARTITION ap_06 VALUES LESS THAN (7)
23:43:35  43  ,SUBPARTITION ap_07 VALUES LESS THAN (8)
23:43:35  44  ,SUBPARTITION ap_08 VALUES LESS THAN (9)
23:43:35  45  ,SUBPARTITION ap_09 VALUES LESS THAN (10)
23:43:35  46  ,SUBPARTITION ap_10 VALUES LESS THAN (11)
23:43:35  47  ,SUBPARTITION ap_11 VALUES LESS THAN (12)
23:43:35  48  ,SUBPARTITION ap_12 VALUES LESS THAN (13)
23:43:35  49  ,SUBPARTITION ap_cf VALUES LESS THAN (MAXVALUE))
23:43:35  50   (PARTITION ledger_2018 VALUES LESS THAN (2019) PCTFREE 0 COMPRESS
23:43:35  51  ,PARTITION ledger_2019 VALUES LESS THAN (2020) PCTFREE 0 COMPRESS
23:43:35  52  ,PARTITION ledger_2020 VALUES LESS THAN (2021)
23:43:35  53  ,PARTITION ledger_2021 VALUES LESS THAN (2022)
23:43:35  54  )
23:43:35  55  ENABLE ROW MOVEMENT NOLOGGING
23:43:35  56  /

Table created.

Elapsed: 00:00:00.19
23:43:35 SQL> @treeselectors
23:43:35 SQL> REM treeselectors.sql
23:43:35 SQL> 
23:43:35 SQL> DROP TABLE PSTREESELECT05 PURGE;
DROP TABLE PSTREESELECT05 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
23:43:35 SQL> CREATE TABLE PSTREESELECT05
23:43:35   2  (SELECTOR_NUM INTEGER NOT NULL,
23:43:35   3   TREE_NODE_NUM INTEGER NOT NULL,
23:43:35   4   RANGE_FROM_05 VARCHAR2(05) NOT NULL,
23:43:35   5   RANGE_TO_05   VARCHAR2(05) NOT NULL)
23:43:35   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
23:43:35   7   (PARTITION pstreeselector VALUES LESS THAN (2))
23:43:35   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.03
23:43:35 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT05 ON PSTREESELECT05 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_05);

Index created.

Elapsed: 00:00:00.02
23:43:35 SQL> 
23:43:35 SQL> DROP TABLE PSTREESELECT10 PURGE;
DROP TABLE PSTREESELECT10 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
23:43:35 SQL> CREATE TABLE PSTREESELECT10
23:43:35   2  (SELECTOR_NUM INTEGER NOT NULL,
23:43:35   3   TREE_NODE_NUM INTEGER NOT NULL,
23:43:35   4   RANGE_FROM_10 VARCHAR2(10) NOT NULL,
23:43:35   5   RANGE_TO_10   VARCHAR2(10) NOT NULL)
23:43:35   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
23:43:35   7   (PARTITION pstreeselector VALUES LESS THAN (2))
23:43:35   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.03
23:43:35 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT10 ON PSTREESELECT10 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_10);

Index created.

Elapsed: 00:00:00.01
23:43:35 SQL> 
23:43:35 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
23:43:35 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.00
23:43:35 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.07
23:43:35 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.04
23:43:35 SQL> 
23:43:35 SQL> @popledger
23:43:35 SQL> REM popledger.sql
23:43:35 SQL> set autotrace off echo on pages 99 lines 200 trimspool on
23:43:35 SQL> 
23:43:35 SQL> truncate table ps_ledger;

Table truncated.

Elapsed: 00:00:00.02
23:43:35 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, LEDGER, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
23:43:35 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
23:43:35 SQL> 
23:43:35 SQL> ALTER TABLE PS_LEDGER PARALLEL 8;

Table altered.

Elapsed: 00:00:00.02
23:43:35 SQL> 
23:43:35 SQL> insert /*+APPEND PARALLEL ENABLE_PARALLEL_DML*/ into ps_ledger
23:43:35   2  with n as (
23:43:35   3  SELECT rownum n from dual connect by level <= 1e2
23:43:35   4  ), fy as (
23:43:35   5  SELECT /*+MATERIALIZE*/ 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
23:43:35   6  ), ap as (
23:43:35   7  SELECT /*+MATERIALIZE*/ FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
23:43:35   8  UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
23:43:35   9  UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
23:43:35  10  ), l as (
23:43:35  11  SELECT /*+MATERIALIZE*/ 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
23:43:35  12  UNION ALL SELECT 'BUDGET' FROM DUAL
23:43:35  13  )
23:43:35  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
23:43:35  15  ,      l.ledger
23:43:35  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
23:43:35  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
23:43:35  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
23:43:35  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
23:43:35  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
23:43:35  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
23:43:35  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
23:43:35  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
23:43:35  24  ,      ' ' budget_ref
23:43:35  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
23:43:35  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
23:43:35  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
23:43:35  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
23:43:35  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
23:43:35  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
23:43:35  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
23:43:35  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
23:43:35  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
23:43:35  34  ,      'GBP' currency_cd
23:43:35  35  ,      ' ' statistics_code
23:43:35  36  ,      fy.fiscal_year
23:43:35  37  ,      ap.accounting_period
23:43:35  38  ,      dbms_random.value(0,1e6) posted_total_amt
23:43:35  39  ,      0 posted_base_amt
23:43:35  40  ,      0 posted_tran_amt
23:43:35  41  ,      'GBP' base_currency
23:43:35  42  ,      SYSDATE dttm_stamp_sec
23:43:35  43  ,      0 process_instance
23:43:35  44  FROM   fy,ap, l, n
23:43:35  45  WHERE  l.ledger = 'BUDGET' or (fy.fiscal_year < 2020 or (fy.fiscal_year = 2020 AND ap.accounting_period <= 6))
23:43:35  46  /

2937239 rows created.

Elapsed: 00:08:31.37
23:52:07 SQL> commit;

Commit complete.

Elapsed: 00:00:00.06
23:52:07 SQL> exec dbms_stats.gather_table_stats('SCOTT','PS_LEDGER');

PL/SQL procedure successfully completed.

Elapsed: 00:01:32.53
23:53:39 SQL> 
23:53:39 SQL> CREATE /*UNIQUE*/ INDEX ps_ledger ON ps_ledger
23:53:39   2  (business_unit,ledger,account,altacct,deptid
23:53:39   3  ,operating_unit,product,fund_code,class_fld,program_code
23:53:39   4  ,budget_ref,affiliate,affiliate_intra1,affiliate_intra2,chartfield1
23:53:39   5  ,chartfield2,chartfield3,project_id,book_code,gl_adjust_type
23:53:39   6  /*,date_code*/,currency_cd,statistics_code,fiscal_year,accounting_period
23:53:39   7  ) COMPRESS 2 NOPARALLEL
23:53:39   8  /

Index created.

Elapsed: 00:00:54.01
23:54:33 SQL> 
23:54:33 SQL> CREATE INDEX psxledger ON ps_ledger
23:54:33   2  (ledger, fiscal_year, accounting_period, business_unit, account, chartfield1
23:54:33   3  ) LOCAL COMPRESS 4 PARALLEL
23:54:33   4  /

Index created.

Elapsed: 00:00:10.76
23:54:44 SQL> 
23:54:44 SQL> CREATE INDEX psyledger ON ps_ledger
23:54:44   2  (ledger, fiscal_year, business_unit, account, chartfield1, accounting_period
23:54:44   3  ) LOCAL COMPRESS 3 PARALLEL
23:54:44   4  /

Index created.

Elapsed: 00:00:08.89
23:54:53 SQL> 
23:54:53 SQL> ALTER INDEX ps_ledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.01
23:54:53 SQL> ALTER INDEX psxledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.02
23:54:53 SQL> ALTER INDEX psyledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.02
23:54:53 SQL> 
23:54:53 SQL> break on report on ledger skip 1
23:54:53 SQL> compute sum of count(*) on report
23:54:53 SQL> set autotrace off
23:54:53 SQL> select ledger, fiscal_year, count(*), max(accounting_period)
23:54:53   2  from ps_ledger
23:54:53   3  group by ledger, fiscal_year
23:54:53   4  order by 1,2
23:54:53   5  /

LEDGER     FISCAL_YEAR   COUNT(*) MAX(ACCOUNTING_PERIOD)
---------- ----------- ---------- ----------------------
ACTUALS           2018    1000000                    999
                  2019    1000000                    999
                  2020     537239                      6

BUDGET            2018     100000                    999
                  2019     100000                    999
                  2020     100000                    999
                  2021     100000                    999

**********             ----------
sum                       2937239

7 rows selected.

Elapsed: 00:00:03.31
23:54:56 SQL> compute sum of count(*) on fiscal_year
23:54:56 SQL> break on report on fiscal_year skip 1 on ledger skip 1
23:54:56 SQL> select ledger, fiscal_year, accounting_period, count(*)
23:54:56   2  from ps_ledger
23:54:56   3  group by ledger, fiscal_year, accounting_period
23:54:56   4  order by 1,2,3
23:54:56   5  /

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
ACTUALS           2018                 0      76797
                                       1      76960
                                       2      76936
                                       3      76938
                                       4      76862
                                       5      76888
                                       6      77146
                                       7      76761
                                       8      76641
                                       9      76799
                                      10      76312
                                      11      76413
                                      12      76547
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2019                 0      77010
                                       1      77057
                                       2      76753
                                       3      76848
                                       4      76779
                                       5      75984
                                       6      77115
                                       7      76571
                                       8      76578
                                       9      77080
                                      10      76239
                                      11      76753
                                      12      77233
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2020                 0      76506
                                       1      77127
                                       2      76816
                                       3      76973
                                       4      76730
                                       5      76608
                                       6      76479

********** ***********                   ----------
           sum                               537239

BUDGET            2018                 0       7756
                                       1       7657
                                       2       7671
                                       3       7654
                                       4       7682
                                       5       7675
                                       6       7667
                                       7       7619
                                       8       7761
                                       9       7805
                                      10       7625
                                      11       7573
                                      12       7655
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2019                 0       7708
                                       1       7720
                                       2       7725
                                       3       7729
                                       4       7681
                                       5       7761
                                       6       7703
                                       7       7646
                                       8       7649
                                       9       7522
                                      10       7610
                                      11       7707
                                      12       7639
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2020                 0       7699
                                       1       7767
                                       2       7503
                                       3       7749
                                       4       7615
                                       5       7678
                                       6       7649
                                       7       7754
                                       8       7680

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
BUDGET            2020                 9       7722
                                      10       7659
                                      11       7646
                                      12       7679
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2021                 0       7709
                                       1       7585
                                       2       7743
                                       3       7607
                                       4       7795
                                       5       7633
                                       6       7666
                                       7       7545
                                       8       7692
                                       9       7575
                                      10       7932
                                      11       7644
                                      12       7674
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

                                         ----------
sum                                         2937239

97 rows selected.

Elapsed: 00:00:03.26
23:55:00 SQL> break on ledger skip 1 on fiscal_year skip 1
23:55:00 SQL> select ledger, account, count(*)
23:55:00   2  from ps_ledger
23:55:00   3  where 1=2
23:55:00   4  group by ledger, account
23:55:00   5  order by 1,3
23:55:00   6  /

no rows selected

Elapsed: 00:00:00.00
23:55:00 SQL> 
23:55:00 SQL> TRUNCATE TABLE PSTREESELECT05;

Table truncated.

Elapsed: 00:00:00.02
23:55:00 SQL> TRUNCATE TABLE PSTREESELECT10;

Table truncated.

Elapsed: 00:00:00.01
23:55:00 SQL> 
23:55:00 SQL> INSERT INTO PSTREESELECT05
23:55:00   2  WITH x as (SELECT DISTINCT business_unit FROM ps_ledger)
23:55:00   3  , y as (SELECT 30982, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, business_unit FROM x)
23:55:00   4  select y.*, business_unit FROM y
23:55:00   5  /

2 rows created.

Elapsed: 00:00:02.73
23:55:02 SQL> INSERT INTO PSTREESELECT10
23:55:02   2  WITH x as (SELECT DISTINCT account FROM ps_ledger)
23:55:02   3  , y as (SELECT 30984, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, account FROM x)
23:55:02   4  select y.*, account FROM y
23:55:02   5  where mod(tree_node_num,100)<25
23:55:02   6  /

238 rows created.

Elapsed: 00:00:03.67
23:55:06 SQL> INSERT INTO PSTREESELECT10
23:55:06   2  WITH x as (SELECT DISTINCT chartfield1 FROM ps_ledger)
23:55:06   3  , y as (SELECT 30985, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, chartfield1 FROM x)
23:55:06   4  select y.*, chartfield1 FROM y
23:55:06   5  where mod(tree_node_num,100)<10
23:55:06   6  /

104 rows created.

Elapsed: 00:00:03.73
23:55:10 SQL> commit;

Commit complete.

Elapsed: 00:00:00.01
23:55:10 SQL> 
23:55:10 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT05');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.21
23:55:10 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT10');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.65
23:55:11 SQL> 
23:55:11 SQL> ALTER TABLE PS_LEDGER NOPARALLEL;

Table altered.

Elapsed: 00:00:00.02
23:55:11 SQL> 
23:55:11 SQL> /*explain plan for
23:55:11 SQL> SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:55:11 SQL> FROM   PS_LEDGER A
23:55:11 SQL> ,      PSTREESELECT05 L1
23:55:11 SQL> ,      PSTREESELECT10 L
23:55:11 SQL> ,      PSTREESELECT10 L2
23:55:11 SQL> WHERE  A.LEDGER='ACTUALS'
23:55:11 SQL> AND    A.FISCAL_YEAR=2020
23:55:11 SQL> AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 2
23:55:11 SQL> AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:55:11 SQL> AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:55:11 SQL> AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:55:11 SQL> AND    A.CURRENCY_CD='GBP'
23:55:11 SQL> GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:55:11 SQL> /
23:55:11 SQL> @@xp*/
23:55:11 SQL> 
23:55:11 SQL> CREATE MATERIALIZED VIEW mv_ledger_2019
23:55:11   2  PARTITION BY RANGE (ACCOUNTING_PERIOD)
23:55:11   3  (PARTITION ap_bf VALUES LESS THAN (1)
23:55:11   4  ,PARTITION ap_01 VALUES LESS THAN (2)
23:55:11   5  ,PARTITION ap_02 VALUES LESS THAN (3)
23:55:11   6  ,PARTITION ap_03 VALUES LESS THAN (4)
23:55:11   7  ,PARTITION ap_04 VALUES LESS THAN (5)
23:55:11   8  ,PARTITION ap_05 VALUES LESS THAN (6)
23:55:11   9  ,PARTITION ap_06 VALUES LESS THAN (7)
23:55:11  10  ,PARTITION ap_07 VALUES LESS THAN (8)
23:55:11  11  ,PARTITION ap_08 VALUES LESS THAN (9)
23:55:11  12  ,PARTITION ap_09 VALUES LESS THAN (10)
23:55:11  13  ,PARTITION ap_10 VALUES LESS THAN (11)
23:55:11  14  ,PARTITION ap_11 VALUES LESS THAN (12)
23:55:11  15  ,PARTITION ap_12 VALUES LESS THAN (13)
23:55:11  16  ,PARTITION ap_cf VALUES LESS THAN (MAXVALUE)
23:55:11  17  ) PCTFREE 0 COMPRESS
23:55:11  18  REFRESH COMPLETE ON DEMAND
23:55:11  19  ENABLE QUERY REWRITE AS
23:55:11  20  SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
23:55:11  21  sum(posted_total_amt) posted_total_amt
23:55:11  22  FROM ps_ledger
23:55:11  23  WHERE fiscal_year = 2019
23:55:11  24  AND   ledger = 'ACTUALS'
23:55:11  25  AND   currency_cd = 'GBP'
23:55:11  26  GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
23:55:11  27  /

Materialized view created.

Elapsed: 00:00:14.24
23:55:25 SQL> 
23:55:25 SQL> CREATE MATERIALIZED VIEW mv_ledger_2020
23:55:25   2  PARTITION BY RANGE (ACCOUNTING_PERIOD)
23:55:25   3  (PARTITION ap_bf VALUES LESS THAN (1)
23:55:25   4  ,PARTITION ap_01 VALUES LESS THAN (2)
23:55:25   5  ,PARTITION ap_02 VALUES LESS THAN (3)
23:55:25   6  ,PARTITION ap_03 VALUES LESS THAN (4)
23:55:25   7  ,PARTITION ap_04 VALUES LESS THAN (5)
23:55:25   8  ,PARTITION ap_05 VALUES LESS THAN (6)
23:55:25   9  ,PARTITION ap_06 VALUES LESS THAN (7)
23:55:25  10  ,PARTITION ap_07 VALUES LESS THAN (8)
23:55:25  11  ,PARTITION ap_08 VALUES LESS THAN (9)
23:55:25  12  ,PARTITION ap_09 VALUES LESS THAN (10)
23:55:25  13  ,PARTITION ap_10 VALUES LESS THAN (11)
23:55:25  14  ,PARTITION ap_11 VALUES LESS THAN (12)
23:55:25  15  ,PARTITION ap_12 VALUES LESS THAN (13)
23:55:25  16  ,PARTITION ap_cf VALUES LESS THAN (MAXVALUE)
23:55:25  17  ) PCTFREE 0 COMPRESS PARALLEL
23:55:25  18  REFRESH COMPLETE ON DEMAND
23:55:25  19  ENABLE QUERY REWRITE AS
23:55:25  20  SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
23:55:25  21  sum(posted_total_amt) posted_total_amt
23:55:25  22  FROM ps_ledger
23:55:25  23  WHERE fiscal_year = 2020
23:55:25  24  AND   ledger = 'ACTUALS'
23:55:25  25  AND   currency_cd = 'GBP'
23:55:25  26  GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
23:55:25  27  /

Materialized view created.

Elapsed: 00:00:05.26
23:55:30 SQL> 
23:55:30 SQL> @@mvpop
23:55:30 SQL> REM mvpop.sql
23:55:30 SQL> set autotrace off
23:55:30 SQL> break on table_name skip 1 on partition_name
23:55:30 SQL> column table_name format a20
23:55:30 SQL> column mview_name format a20
23:55:30 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               COMPLETE VALID
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
23:55:30 SQL> 
23:55:30 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
23:55:30 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);
23:55:30 SQL> 
23:55:30 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'C',atomic_refresh=>FALSE);
23:55:30 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'C',atomic_refresh=>FALSE);
23:55:30 SQL> 
23:55:30 SQL> ALTER MATERIALIZED VIEW mv_ledger_2019 NOPARALLEL;

Materialized view altered.

Elapsed: 00:00:00.02
23:55:30 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
23:55:30 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
23:55:30 SQL> 
23:55:30 SQL> ALTER MATERIALIZED VIEW mv_ledger_2020 NOPARALLEL;

Materialized view altered.

Elapsed: 00:00:00.02
23:55:30 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
23:55:30 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
23:55:30 SQL> 
23:55:30 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2019');

PL/SQL procedure successfully completed.

Elapsed: 00:00:30.56
23:56:01 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:14.38
23:56:15 SQL> @@mvvol
23:56:15 SQL> REM mvvol.sql
23:56:15 SQL> 
23:56:15 SQL> set autotrace off
23:56:15 SQL> break on table_name skip 1 on partition_name
23:56:15 SQL> column table_name format a15
23:56:15 SQL> column column_name format a20
23:56:15 SQL> column mview_name format a20
23:56:15 SQL> column partition_position format 999 heading 'Part|Pos'
23:56:15 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
23:56:15 SQL> column partition_name format a20
23:56:15 SQL> column subpartition_name format a25
23:56:15 SQL> column num_rows format 9999999
23:56:15 SQL> column num_distinct heading 'Num|Distinct' format 9999999
23:56:15 SQL> column num_buckets heading 'Num|Buckets'	format 9999
23:56:15 SQL> column blocks format 99999
23:56:15 SQL> column rpb format 999.9 heading 'Rows|per|Block'
23:56:15 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               COMPLETE VALID
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.01
23:56:15 SQL> 
23:56:15 SQL> select count(*) from mv_ledger_2019;

  COUNT(*)
----------
    946762

Elapsed: 00:00:00.06
23:56:15 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
    508689

Elapsed: 00:00:00.03
23:56:15 SQL> 
23:56:15 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
23:56:15   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
23:56:15   3  , COALESCE(c.compression, b.compression) compression
23:56:15   4  , COALESCE(c.compress_for, b.compress_for) compress_for
23:56:15   5  from user_tab_statistics a
23:56:15   6  	LEFT OUTER JOIN user_tab_partitions b
23:56:15   7  	  ON a.table_name = b.table_name
23:56:15   8  	  AND a.partition_name = b.partition_name
23:56:15   9  	LEFT OUTER JOIN user_tab_subpartitions c
23:56:15  10  	  ON a.table_name = c.table_name
23:56:15  11  	  AND a.partition_name = c.partition_name
23:56:15  12  	  AND a.subpartition_name = c.subpartition_name
23:56:15  13  where a.table_name like '%LEDGER%'
23:56:15  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
23:56:15  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2019     1 AP_BF                                                  72886    252  289.2 ENABLED  BASIC
                   2 AP_01                                                  72925    252  289.4 ENABLED  BASIC
                   3 AP_02                                                  72736    251  289.8 ENABLED  BASIC
                   4 AP_03                                                  72745    251  289.8 ENABLED  BASIC
                   5 AP_04                                                  72649    251  289.4 ENABLED  BASIC
                   6 AP_05                                                  71947    249  288.9 ENABLED  BASIC
                   7 AP_06                                                  72903    252  289.3 ENABLED  BASIC
                   8 AP_07                                                  72510    250  290.0 ENABLED  BASIC
                   9 AP_08                                                  72520    251  288.9 ENABLED  BASIC
                  10 AP_09                                                  72965    252  289.5 ENABLED  BASIC
                  11 AP_10                                                  72209    250  288.8 ENABLED  BASIC
                  12 AP_11                                                  72647    251  289.4 ENABLED  BASIC
                  13 AP_12                                                  73121    253  289.0 ENABLED  BASIC
                  14 AP_CF                                                   1999     25   80.0 ENABLED  BASIC
                                                                           946762   3290  287.8

MV_LEDGER_2020     1 AP_BF                                                  72475    256  283.1 ENABLED  BASIC
                   2 AP_01                                                  72981    256  285.1 ENABLED  BASIC
                   3 AP_02                                                  72726    256  284.1 ENABLED  BASIC
                   4 AP_03                                                  72844    256  284.5 ENABLED  BASIC
                   5 AP_04                                                  72709    256  284.0 ENABLED  BASIC
                   6 AP_05                                                  72535    256  283.3 ENABLED  BASIC
                   7 AP_06                                                  72419    256  282.9 ENABLED  BASIC
                   8 AP_07                                                      0      0        ENABLED  BASIC
                   9 AP_08                                                      0      0        ENABLED  BASIC
                  10 AP_09                                                      0      0        ENABLED  BASIC
                  11 AP_10                                                      0      0        ENABLED  BASIC
                  12 AP_11                                                      0      0        ENABLED  BASIC
                  13 AP_12                                                      0      0        ENABLED  BASIC
                  14 AP_CF                                                      0      0        ENABLED  BASIC
                                                                           508689   1792  283.9

PS_LEDGER          1 LEDGER_2018                                          1100000  17865   61.6 ENABLED  BASIC
                   1                         1 LEDGER_2018_AP_BF            84553   1372   61.6 ENABLED  BASIC
                   1                         2 LEDGER_2018_AP_01            84617   1372   61.7 ENABLED  BASIC
                   1                         3 LEDGER_2018_AP_02            84607   1373   61.6 ENABLED  BASIC
                   1                         4 LEDGER_2018_AP_03            84592   1373   61.6 ENABLED  BASIC
                   1                         5 LEDGER_2018_AP_04            84544   1372   61.6 ENABLED  BASIC
                   1                         6 LEDGER_2018_AP_05            84563   1372   61.6 ENABLED  BASIC
                   1                         7 LEDGER_2018_AP_06            84813   1376   61.6 ENABLED  BASIC
                   1                         8 LEDGER_2018_AP_07            84380   1369   61.6 ENABLED  BASIC
                   1                         9 LEDGER_2018_AP_08            84402   1369   61.7 ENABLED  BASIC
                   1                        10 LEDGER_2018_AP_09            84604   1373   61.6 ENABLED  BASIC
                   1                        11 LEDGER_2018_AP_10            83937   1362   61.6 ENABLED  BASIC
                   1                        12 LEDGER_2018_AP_11            83986   1363   61.6 ENABLED  BASIC
                   1                        13 LEDGER_2018_AP_12            84202   1366   61.6 ENABLED  BASIC
                   1                        14 LEDGER_2018_AP_CF             2200     53   41.5 ENABLED  BASIC
                   2 LEDGER_2019                                          1100000  17863   61.6 ENABLED  BASIC
                   2                         1 LEDGER_2019_AP_BF            84718   1374   61.7 ENABLED  BASIC
                   2                         2 LEDGER_2019_AP_01            84777   1375   61.7 ENABLED  BASIC
                   2                         3 LEDGER_2019_AP_02            84478   1370   61.7 ENABLED  BASIC
                   2                         4 LEDGER_2019_AP_03            84577   1372   61.6 ENABLED  BASIC
                   2                         5 LEDGER_2019_AP_04            84460   1370   61.6 ENABLED  BASIC
                   2                         6 LEDGER_2019_AP_05            83745   1359   61.6 ENABLED  BASIC
                   2                         7 LEDGER_2019_AP_06            84818   1376   61.6 ENABLED  BASIC
                   2                         8 LEDGER_2019_AP_07            84217   1367   61.6 ENABLED  BASIC
                   2                         9 LEDGER_2019_AP_08            84227   1366   61.7 ENABLED  BASIC
                   2                        10 LEDGER_2019_AP_09            84602   1373   61.6 ENABLED  BASIC
                   2                        11 LEDGER_2019_AP_10            83849   1360   61.7 ENABLED  BASIC
                   2                        12 LEDGER_2019_AP_11            84460   1371   61.6 ENABLED  BASIC
                   2                        13 LEDGER_2019_AP_12            84872   1377   61.6 ENABLED  BASIC
                   2                        14 LEDGER_2019_AP_CF             2200     53   41.5 ENABLED  BASIC
                   3 LEDGER_2020                                           637239  16771   38.0 NONE
                   3                         1 LEDGER_2020_AP_BF            84205   2180   38.6 DISABLED
                   3                         2 LEDGER_2020_AP_01            84894   2226   38.1 DISABLED
                   3                         3 LEDGER_2020_AP_02            84319   2211   38.1 DISABLED
                   3                         4 LEDGER_2020_AP_03            84722   2222   38.1 DISABLED
                   3                         5 LEDGER_2020_AP_04            84345   2212   38.1 DISABLED
                   3                         6 LEDGER_2020_AP_05            84286   2211   38.1 DISABLED
                   3                         7 LEDGER_2020_AP_06            84128   2206   38.1 DISABLED
                   3                         8 LEDGER_2020_AP_07             7754    215   36.1 DISABLED
                   3                         9 LEDGER_2020_AP_08             7680    213   36.1 DISABLED
                   3                        10 LEDGER_2020_AP_09             7722    214   36.1 DISABLED
                   3                        11 LEDGER_2020_AP_10             7659    212   36.1 DISABLED
                   3                        12 LEDGER_2020_AP_11             7646    212   36.1 DISABLED
                   3                        13 LEDGER_2020_AP_12             7679    213   36.1 DISABLED
                   3                        14 LEDGER_2020_AP_CF              200     24    8.3 DISABLED
                   4 LEDGER_2021                                           100000   2792   35.8 NONE
                   4                         1 LEDGER_2021_AP_BF             7709    211   36.5 DISABLED
                   4                         2 LEDGER_2021_AP_01             7585    211   35.9 DISABLED
                   4                         3 LEDGER_2021_AP_02             7743    215   36.0 DISABLED
                   4                         4 LEDGER_2021_AP_03             7607    211   36.1 DISABLED
                   4                         5 LEDGER_2021_AP_04             7795    216   36.1 DISABLED
                   4                         6 LEDGER_2021_AP_05             7633    212   36.0 DISABLED
                   4                         7 LEDGER_2021_AP_06             7666    213   36.0 DISABLED
                   4                         8 LEDGER_2021_AP_07             7545    210   35.9 DISABLED
                   4                         9 LEDGER_2021_AP_08             7692    214   35.9 DISABLED
                   4                        10 LEDGER_2021_AP_09             7575    211   35.9 DISABLED
                   4                        11 LEDGER_2021_AP_10             7932    219   36.2 DISABLED
                   4                        12 LEDGER_2021_AP_11             7644    212   36.1 DISABLED
                   4                        13 LEDGER_2021_AP_12             7674    213   36.0 DISABLED
                   4                        14 LEDGER_2021_AP_CF              200     24    8.3 DISABLED
                                                                          2937239  55291   53.1


91 rows selected.

Elapsed: 00:00:00.06
23:56:15 SQL> 
23:56:15 SQL> column extension format a40
23:56:15 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
23:56:15   2  from user_tab_col_statistics s
23:56:15   3  	LEFT OUTER JOIN user_stat_extensions e
23:56:15   4  	ON e.table_name = s.table_name
23:56:15   5  	AND e.extension_name = s.column_name
23:56:15   6  where s.table_name like 'MV_LEDGER%'
23:56:15   7  order by 1,2
23:56:15   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  ACCOUNT                  1000       1 NONE            23:55:37 18/11/2020
                ACCOUNTING_PERIOD          15       1 NONE            23:55:37 18/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       23:55:37 18/11/2020
                CHARTFIELD1              1000       1 NONE            23:55:37 18/11/2020
                FISCAL_YEAR                 1       1 NONE            23:55:37 18/11/2020
                POSTED_TOTAL_AMT       935744       1 NONE            23:55:37 18/11/2020
                SYS_NC00007$                2       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$             1000       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$             1000       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )


MV_LEDGER_2020  ACCOUNT                   999       1 NONE            23:56:05 18/11/2020
                ACCOUNTING_PERIOD           7       1 NONE            23:56:05 18/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       23:56:05 18/11/2020
                CHARTFIELD1               998       1 NONE            23:56:05 18/11/2020
                FISCAL_YEAR                 1       1 NONE            23:56:05 18/11/2020
                POSTED_TOTAL_AMT       507104       1 NONE            23:56:05 18/11/2020
                SYS_NC00007$                2       1 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              998       1 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$                7       1 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )



22 rows selected.

Elapsed: 00:00:00.08
23:56:15 SQL> column extension format a40
23:56:15 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
23:56:15   2  from user_part_col_statistics s
23:56:15   3  	LEFT OUTER JOIN user_stat_extensions e
23:56:15   4  	ON e.table_name = s.table_name
23:56:15   5  	AND e.extension_name = s.column_name
23:56:15   6  where s.table_name like 'MV_LEDGER%'
23:56:15   7  order by 1,2
23:56:15   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  AP_01                SYS_NC00011$                1       1 NONE            23:55:30 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:30 18/11/2020
                                     ACCOUNT                   996       1 NONE            23:55:30 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:55:30 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:30 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:30 18/11/2020
                                     POSTED_TOTAL_AMT        72616       1 NONE            23:55:30 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:30 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              996       1 NONE            23:55:30 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:55:30 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:30 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_02                SYS_NC00011$                1       1 NONE            23:55:31 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:31 18/11/2020
                                     ACCOUNT                   995       1 NONE            23:55:31 18/11/2020
                                     CHARTFIELD1               992       1 NONE            23:55:31 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:31 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:31 18/11/2020
                                     POSTED_TOTAL_AMT        72736       1 NONE            23:55:31 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:31 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            23:55:31 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            23:55:31 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:31 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_03                SYS_NC00011$                1       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:32 18/11/2020
                                     ACCOUNT                   991       1 NONE            23:55:32 18/11/2020
                                     CHARTFIELD1               992       1 NONE            23:55:32 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:32 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:32 18/11/2020
                                     POSTED_TOTAL_AMT        72152       1 NONE            23:55:32 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_04                SYS_NC00011$                1       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:32 18/11/2020
                                     ACCOUNT                   992       1 NONE            23:55:32 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:55:32 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:32 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:32 18/11/2020
                                     POSTED_TOTAL_AMT        72649       1 NONE            23:55:32 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:32 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_05                SYS_NC00011$                1       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:33 18/11/2020
                                     ACCOUNT                   992       1 NONE            23:55:33 18/11/2020
                                     CHARTFIELD1               997       1 NONE            23:55:33 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:33 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:33 18/11/2020
                                     POSTED_TOTAL_AMT        71136       1 NONE            23:55:33 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              997       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_06                SYS_NC00011$                1       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:33 18/11/2020
                                     ACCOUNT                   991       1 NONE            23:55:33 18/11/2020
                                     CHARTFIELD1               993       1 NONE            23:55:33 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:33 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:33 18/11/2020
                                     POSTED_TOTAL_AMT        72903       1 NONE            23:55:33 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:33 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_07                SYS_NC00011$                1       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:34 18/11/2020
                                     ACCOUNT                   991       1 NONE            23:55:34 18/11/2020
                                     CHARTFIELD1               993       1 NONE            23:55:34 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:34 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:34 18/11/2020
                                     POSTED_TOTAL_AMT        72440       1 NONE            23:55:34 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_08                SYS_NC00011$                1       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:34 18/11/2020

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2019  AP_08                ACCOUNT                   995       1 NONE            23:55:34 18/11/2020
                                     CHARTFIELD1               992       1 NONE            23:55:34 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:34 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:34 18/11/2020
                                     POSTED_TOTAL_AMT        72520       1 NONE            23:55:34 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:34 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_09                SYS_NC00011$                1       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:35 18/11/2020
                                     ACCOUNT                   993       1 NONE            23:55:35 18/11/2020
                                     CHARTFIELD1               990       1 NONE            23:55:35 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:35 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:35 18/11/2020
                                     POSTED_TOTAL_AMT        72872       1 NONE            23:55:35 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              990       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_10                FISCAL_YEAR                 1       1 NONE            23:55:35 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:35 18/11/2020
                                     POSTED_TOTAL_AMT        70824       1 NONE            23:55:35 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            23:55:35 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     CHARTFIELD1               995       1 NONE            23:55:35 18/11/2020
                                     ACCOUNT                   993       1 NONE            23:55:35 18/11/2020
                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:35 18/11/2020
                AP_11                SYS_NC00011$                1       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:36 18/11/2020
                                     ACCOUNT                   994       1 NONE            23:55:36 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:55:36 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:36 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:36 18/11/2020
                                     POSTED_TOTAL_AMT        72240       1 NONE            23:55:36 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_12                SYS_NC00011$                1       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:36 18/11/2020
                                     ACCOUNT                   989       1 NONE            23:55:36 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:55:36 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:36 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:36 18/11/2020
                                     POSTED_TOTAL_AMT        72208       1 NONE            23:55:36 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              989       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:36 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_BF                SYS_NC00011$                1       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:37 18/11/2020
                                     ACCOUNT                   991       1 NONE            23:55:37 18/11/2020
                                     CHARTFIELD1               996       1 NONE            23:55:37 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:37 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:55:37 18/11/2020
                                     POSTED_TOTAL_AMT        71968       1 NONE            23:55:37 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              996       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_CF                SYS_NC00011$                2       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     SYS_NC00010$                1       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00009$              754       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00008$              745       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00007$                2       1 NONE            23:55:37 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     POSTED_TOTAL_AMT         1999       1 NONE            23:55:37 18/11/2020
                                     ACCOUNTING_PERIOD           2       1 NONE            23:55:37 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:55:37 18/11/2020
                                     CHARTFIELD1               754       1 NONE            23:55:37 18/11/2020
                                     ACCOUNT                   745       1 NONE            23:55:37 18/11/2020
                                     BUSINESS_UNIT               2       2 FREQUENCY       23:55:37 18/11/2020

MV_LEDGER_2020  AP_01                SYS_NC00011$                1       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:01 18/11/2020
                                     ACCOUNT                   992       1 NONE            23:56:01 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:56:01 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:01 18/11/2020

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  AP_01                ACCOUNTING_PERIOD           1       1 NONE            23:56:01 18/11/2020
                                     POSTED_TOTAL_AMT        72184       1 NONE            23:56:01 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_02                SYS_NC00011$                1       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:01 18/11/2020
                                     ACCOUNT                   993       1 NONE            23:56:01 18/11/2020
                                     CHARTFIELD1               991       1 NONE            23:56:01 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:01 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:56:01 18/11/2020
                                     POSTED_TOTAL_AMT        72064       1 NONE            23:56:01 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:01 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_03                SYS_NC00011$                1       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:02 18/11/2020
                                     ACCOUNT                   993       1 NONE            23:56:02 18/11/2020
                                     CHARTFIELD1               991       1 NONE            23:56:02 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:02 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:56:02 18/11/2020
                                     POSTED_TOTAL_AMT        72016       1 NONE            23:56:02 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_04                SYS_NC00011$                1       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:02 18/11/2020
                                     ACCOUNT                   991       1 NONE            23:56:02 18/11/2020
                                     CHARTFIELD1               989       1 NONE            23:56:02 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:02 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:56:02 18/11/2020
                                     POSTED_TOTAL_AMT        72709       1 NONE            23:56:02 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              989       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:02 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_05                SYS_NC00011$                1       1 NONE            23:56:03 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:03 18/11/2020
                                     ACCOUNT                   993       1 NONE            23:56:03 18/11/2020
                                     CHARTFIELD1               992       1 NONE            23:56:03 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:03 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:56:03 18/11/2020
                                     POSTED_TOTAL_AMT        72296       1 NONE            23:56:03 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:03 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            23:56:03 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            23:56:03 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:03 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_06                SYS_NC00011$                1       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     ACCOUNTING_PERIOD           1       1 NONE            23:56:04 18/11/2020
                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:04 18/11/2020
                                     ACCOUNT                   994       1 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT        70816       1 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_07                SYS_NC00011$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_08                SYS_NC00011$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  AP_08                SYS_NC00009$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_09                SYS_NC00011$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_10                SYS_NC00011$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_11                SYS_NC00011$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_12                SYS_NC00011$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_BF                SYS_NC00011$                1       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     BUSINESS_UNIT               2       2 FREQUENCY       23:56:04 18/11/2020
                                     ACCOUNT                   992       1 NONE            23:56:04 18/11/2020
                                     CHARTFIELD1               994       1 NONE            23:56:04 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            23:56:04 18/11/2020
                                     ACCOUNTING_PERIOD           1       1 NONE            23:56:04 18/11/2020
                                     POSTED_TOTAL_AMT        72475       1 NONE            23:56:04 18/11/2020
                                     SYS_NC00007$                2       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            23:56:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                AP_CF                SYS_NC00011$                0       0 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                                     SYS_NC00010$                0       0 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00009$                0       0 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00008$                0       0 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00007$                0       0 NONE            23:56:05 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     POSTED_TOTAL_AMT            0       0 NONE            23:56:05 18/11/2020
                                     ACCOUNTING_PERIOD           0       0 NONE            23:56:05 18/11/2020
                                     FISCAL_YEAR                 0       0 NONE            23:56:05 18/11/2020
                                     CHARTFIELD1                 0       0 NONE            23:56:05 18/11/2020
                                     ACCOUNT                     0       0 NONE            23:56:05 18/11/2020
                                     BUSINESS_UNIT               0       0 NONE            23:56:05 18/11/2020


308 rows selected.

Elapsed: 00:00:00.53
23:56:16 SQL> 
23:56:16 SQL> column extension format a40
23:56:16 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
23:56:16   2  from user_subpart_col_statistics s
23:56:16   3  	LEFT OUTER JOIN user_stat_extensions e
23:56:16   4  	ON e.table_name = s.table_name
23:56:16   5  	AND e.extension_name = s.column_name
23:56:16   6  where s.table_name like 'MV_LEDGER%'
23:56:16   7  order by 1,2
23:56:16   8  ;

no rows selected

Elapsed: 00:00:00.01
23:56:16 SQL> @@mvsql
23:56:16 SQL> REM mvsql.sql
23:56:16 SQL> set autotrace off
23:56:16 SQL> 
23:56:16 SQL> REM 2018
23:56:16 SQL> set lines 200 pages 999
23:56:16 SQL> explain plan for
23:56:16   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:56:16   3  FROM   PS_LEDGER A
23:56:16   4  ,      PSTREESELECT05 L1
23:56:16   5  ,      PSTREESELECT10 L
23:56:16   6  ,      PSTREESELECT10 L2
23:56:16   7  WHERE  A.LEDGER='ACTUALS'
23:56:16   8  AND    A.FISCAL_YEAR=2018
23:56:16   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
23:56:16  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:56:16  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:56:16  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:56:16  13  AND    A.CURRENCY_CD='GBP'
23:56:16  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:56:16  15  /

Explained.

Elapsed: 00:00:00.16
23:56:16 SQL> @@xp
23:56:16 SQL> REM xp.sql
23:56:16 SQL> REM spool xp
23:56:16 SQL> REM set pages 9999 lines 200 autotrace off
23:56:16 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3827045647

------------------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                   |   990 | 92070 |  2245   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY               |                   |   990 | 92070 |  2245   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                  |                   |   990 | 92070 |  2244   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN          | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                 |                   |  4161 |   300K|  2242   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN     |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN        | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT             |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN       | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE   |                   | 39970 |  1756K|  2239   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR|                   | 39970 |  1756K|  2239   (1)| 00:00:01 |     2 |     7 |
|* 11 |       TABLE ACCESS FULL      | PS_LEDGER         | 39970 |  1756K|  2239   (1)| 00:00:01 |     1 |    14 |
------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDAT
        A[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L
        2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.12
23:56:16 SQL> REM spool off
23:56:16 SQL> 
23:56:16 SQL> REM 2019
23:56:16 SQL> explain plan for
23:56:16   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:56:16   3  FROM   PS_LEDGER A
23:56:16   4  ,      PSTREESELECT05 L1
23:56:16   5  ,      PSTREESELECT10 L
23:56:16   6  ,      PSTREESELECT10 L2
23:56:16   7  WHERE  A.LEDGER='ACTUALS'
23:56:16   8  AND    A.FISCAL_YEAR=2019
23:56:16   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
23:56:16  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:56:16  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:56:16  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:56:16  13  AND    A.CURRENCY_CD='GBP'
23:56:16  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:56:16  15  /

Explained.

Elapsed: 00:00:00.24
23:56:17 SQL> @@xp
23:56:17 SQL> REM xp.sql
23:56:17 SQL> REM spool xp
23:56:17 SQL> REM set pages 9999 lines 200 autotrace off
23:56:17 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1498194812

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1703 |   128K|   421   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1703 |   128K|   421   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1703 |   128K|   420   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7156 |   405K|   418   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   | 68804 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 68804 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.15
23:56:17 SQL> REM spool off
23:56:17 SQL> 
23:56:17 SQL> REM 2020
23:56:17 SQL> explain plan for
23:56:17   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:56:17   3  FROM   PS_LEDGER A
23:56:17   4  ,      PSTREESELECT05 L1
23:56:17   5  ,      PSTREESELECT10 L
23:56:17   6  ,      PSTREESELECT10 L2
23:56:17   7  WHERE  A.LEDGER='ACTUALS'
23:56:17   8  AND    A.FISCAL_YEAR=2020
23:56:17   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
23:56:17  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:56:17  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:56:17  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:56:17  13  AND    A.CURRENCY_CD='GBP'
23:56:17  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:56:17  15  /

Explained.

Elapsed: 00:00:00.25
23:56:17 SQL> @@xp
23:56:17 SQL> REM xp.sql
23:56:17 SQL> REM spool xp
23:56:17 SQL> REM set pages 9999 lines 200 autotrace off
23:56:17 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3016493666

------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   | 12328 |   927K|       |   653   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   | 12328 |   927K|  1080K|   653   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   | 12328 |   927K|       |   429   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   | 51748 |  2931K|       |   427   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   |   496K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   496K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  10 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGE
        R_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]
        ></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D
        5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CD
        ATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></
        s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v>
        </o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><
        t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h
        ></f></q>


83 rows selected.

Elapsed: 00:00:00.13
23:56:17 SQL> REM spool off
23:56:17 SQL> 
23:56:17 SQL> explain plan for
23:56:17   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:56:17   3  FROM   PS_LEDGER A
23:56:17   4  ,      PSTREESELECT05 L1
23:56:17   5  ,      PSTREESELECT10 L
23:56:17   6  ,      PSTREESELECT10 L2
23:56:17   7  WHERE  A.LEDGER='ACTUALS'
23:56:17   8  AND    A.FISCAL_YEAR=2019
23:56:17   9  AND    A.ACCOUNTING_PERIOD = 7
23:56:17  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:56:17  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:56:17  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:56:17  13  AND    A.CURRENCY_CD='GBP'
23:56:17  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:56:17  15  /

Explained.

Elapsed: 00:00:00.24
23:56:17 SQL> @@xp
23:56:17 SQL> REM xp.sql
23:56:17 SQL> REM spool xp
23:56:17 SQL> REM set pages 9999 lines 200 autotrace off
23:56:17 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 387550712

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1824 |   137K|    76   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1824 |   137K|    76   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1824 |   137K|    75   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7594 |   430K|    73   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE       |                   | 72510 |  2053K|    70   (2)| 00:00:01 |     8 |     8 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 72510 |  2053K|    70   (2)| 00:00:01 |     8 |     8 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"=7)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.14
23:56:17 SQL> REM spool off
23:56:17 SQL> 
23:56:17 SQL> REM 2020
23:56:17 SQL> explain plan for
23:56:17   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:56:17   3  FROM   PS_LEDGER A
23:56:17   4  ,      PSTREESELECT05 L1
23:56:17   5  ,      PSTREESELECT10 L
23:56:17   6  ,      PSTREESELECT10 L2
23:56:17   7  WHERE  A.LEDGER='ACTUALS'
23:56:17   8  AND    A.FISCAL_YEAR=2020
23:56:17   9  AND    (A.ACCOUNTING_PERIOD = 7)
23:56:17  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:56:17  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:56:17  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:56:17  13  AND    A.CURRENCY_CD='GBP'
23:56:17  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:56:17  15  /

Explained.

Elapsed: 00:00:00.22
23:56:18 SQL> @@xp
23:56:18 SQL> REM xp.sql
23:56:18 SQL> REM spool xp
23:56:18 SQL> REM set pages 9999 lines 200 autotrace off
23:56:18 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2698791447

-------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                               | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                        |                   |     1 |    92 |     6  (17)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                          |                   |     1 |    92 |     6  (17)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                             |                   |     1 |    92 |     5   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                         |                   |     1 |    92 |     5   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                          |                   |     1 |    73 |     4   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                      |                   |     1 |    73 |     4   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR             |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                       |                   |     1 |    55 |     3   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                   |                   |     1 |    55 |     3   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR          |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE       |                   |     1 |    44 |     2   (0)| 00:00:01 |     8 |     8 |
|  * 12 |             MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |     1 |    44 |     2   (0)| 00:00:01 |     8 |     8 |
|  * 13 |           INDEX RANGE SCAN              | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 14 |          INDEX RANGE SCAN               | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 15 |        INDEX RANGE SCAN                 | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 16 |       INDEX RANGE SCAN                  | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 17 |     INDEX RANGE SCAN                    | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 18 |    INDEX RANGE SCAN                     | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
  12 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4
  13 - SEL$1E60250C / L1@SEL$1
  14 - SEL$1E60250C / L1@SEL$1
  15 - SEL$1E60250C / L@SEL$1
  16 - SEL$1E60250C / L@SEL$1
  17 - SEL$1E60250C / L2@SEL$1
  18 - SEL$1E60250C / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      USE_NL(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L1"@"SEL$1")
      LEADING(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  12 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"=7)
  13 - access("L1"."SELECTOR_NUM"=30982 AND "MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  14 - access("L1"."SELECTOR_NUM"=30982)
  15 - access("L"."SELECTOR_NUM"=30985 AND "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
  16 - access("L"."SELECTOR_NUM"=30985)
  17 - access("L2"."SELECTOR_NUM"=30984 AND "MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
  18 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


103 rows selected.

Elapsed: 00:00:00.17
23:56:18 SQL> REM spool off
23:56:18 SQL> 
23:56:18 SQL> set autotrace off
23:56:18 SQL> 
23:56:18 SQL> @@pop2020m7
23:56:18 SQL> REM pop2020m7.sql
23:56:18 SQL> set autotrace off
23:56:18 SQL> insert into ps_ledger
23:56:18   2  with n as (
23:56:18   3  SELECT rownum n from dual connect by level <= 1e6/13
23:56:18   4  --), fy as (
23:56:18   5  --SELECT 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
23:56:18   6  --), ap as (
23:56:18   7  --SELECT FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
23:56:18   8  --UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
23:56:18   9  --UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
23:56:18  10  --), l as (
23:56:18  11  --SELECT 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
23:56:18  12  --UNION ALL SELECT 'BUDGET' FROM DUAL
23:56:18  13  )
23:56:18  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
23:56:18  15  ,      'ACTUALS' ledger
23:56:18  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
23:56:18  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
23:56:18  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
23:56:18  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
23:56:18  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
23:56:18  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
23:56:18  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
23:56:18  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
23:56:18  24  ,      ' ' budget_ref
23:56:18  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
23:56:18  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
23:56:18  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
23:56:18  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
23:56:18  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
23:56:18  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
23:56:18  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
23:56:18  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
23:56:18  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
23:56:18  34  ,      'GBP' currency_cd
23:56:18  35  ,      ' ' statistics_code
23:56:18  36  ,      2020 fiscal_year
23:56:18  37  ,      7 accounting_period
23:56:18  38  ,      dbms_random.value(0,1e6) posted_total_amt
23:56:18  39  ,      0 posted_base_amt
23:56:18  40  ,      0 posted_tran_amt
23:56:18  41  ,      'GBP' base_currency
23:56:18  42  ,      SYSDATE dttm_stamp_sec
23:56:18  43  ,      0 process_instance
23:56:18  44  FROM   n
23:56:18  45  --WHERE  l.ledger = 'ACTUALS'
23:56:18  46  --AND    fy.fiscal_year = 2020
23:56:18  47  --AND    ap.accounting_period = 7
23:56:18  48  /

76923 rows created.

Elapsed: 00:00:51.40
23:57:09 SQL> set lines 200 pages 999 autotrace off
23:57:09 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               COMPLETE VALID
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
23:57:09 SQL> commit;

Commit complete.

Elapsed: 00:00:00.07
23:57:09 SQL> column owner format a10
23:57:09 SQL> column table_name format a15
23:57:09 SQL> column mview_name format a15
23:57:09 SQL> column detailobj_owner format a10 heading 'Detailobj|Owner'
23:57:09 SQL> column detailobj_name  format a15
23:57:09 SQL> column detailobj_alias format a20
23:57:09 SQL> column detail_partition_name format a20
23:57:09 SQL> column detail_subpartition_name format a20
23:57:09 SQL> column parent_table_partition format a20
23:57:09 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME      STALENESS           LAST_REF COMPILE_STATE
--------------- ------------------- -------- -------------------
MV_LEDGER_2019  NEEDS_COMPILE       COMPLETE NEEDS_COMPILE
MV_LEDGER_2020  NEEDS_COMPILE       COMPLETE NEEDS_COMPILE

Elapsed: 00:00:00.00
23:57:09 SQL> select * from user_mview_detail_relations;

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAILOBJ DETAILOBJ_ALIAS      D NUM_FRESH_PCT_PARTITIONS NUM_STALE_PCT_PARTITIONS
---------- --------------- ---------- --------------- --------- -------------------- - ------------------------ ------------------------
SCOTT      MV_LEDGER_2019  SCOTT      PS_LEDGER       TABLE     PS_LEDGER            Y                       55                        1
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       TABLE     PS_LEDGER            Y                       55                        1

Elapsed: 00:00:13.46
23:57:23 SQL> select * from user_mview_detail_partition;

no rows selected

Elapsed: 00:00:00.00
23:57:23 SQL> select * from user_mview_detail_subpartition where freshness != 'FRESH';

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAIL_PARTITION_NAM DETAIL_SUBPARTITION_ DETAIL_SUBPARTITION_POSITION FRESH
---------- --------------- ---------- --------------- -------------------- -------------------- ---------------------------- -----
SCOTT      MV_LEDGER_2019  SCOTT      PS_LEDGER       LEDGER_2020          LEDGER_2020_AP_07                               8 STALE
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       LEDGER_2020          LEDGER_2020_AP_07                               8 STALE

Elapsed: 00:00:00.29
23:57:23 SQL> 
23:57:23 SQL> @@mvsql
23:57:23 SQL> REM mvsql.sql
23:57:23 SQL> set autotrace off
23:57:23 SQL> 
23:57:23 SQL> REM 2018
23:57:23 SQL> set lines 200 pages 999
23:57:23 SQL> explain plan for
23:57:23   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:57:23   3  FROM   PS_LEDGER A
23:57:23   4  ,      PSTREESELECT05 L1
23:57:23   5  ,      PSTREESELECT10 L
23:57:23   6  ,      PSTREESELECT10 L2
23:57:23   7  WHERE  A.LEDGER='ACTUALS'
23:57:23   8  AND    A.FISCAL_YEAR=2018
23:57:23   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
23:57:23  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:57:23  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:57:23  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:57:23  13  AND    A.CURRENCY_CD='GBP'
23:57:23  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:57:23  15  /

Explained.

Elapsed: 00:00:00.17
23:57:23 SQL> @@xp
23:57:23 SQL> REM xp.sql
23:57:23 SQL> REM spool xp
23:57:23 SQL> REM set pages 9999 lines 200 autotrace off
23:57:23 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3827045647

------------------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                   |   990 | 92070 |  2245   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY               |                   |   990 | 92070 |  2245   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                  |                   |   990 | 92070 |  2244   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN          | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                 |                   |  4161 |   300K|  2242   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN     |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN        | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT             |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN       | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE   |                   | 39970 |  1756K|  2239   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR|                   | 39970 |  1756K|  2239   (1)| 00:00:01 |     2 |     7 |
|* 11 |       TABLE ACCESS FULL      | PS_LEDGER         | 39970 |  1756K|  2239   (1)| 00:00:01 |     1 |    14 |
------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDAT
        A[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L
        2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.11
23:57:23 SQL> REM spool off
23:57:23 SQL> 
23:57:23 SQL> REM 2019
23:57:23 SQL> explain plan for
23:57:23   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:57:23   3  FROM   PS_LEDGER A
23:57:23   4  ,      PSTREESELECT05 L1
23:57:23   5  ,      PSTREESELECT10 L
23:57:23   6  ,      PSTREESELECT10 L2
23:57:23   7  WHERE  A.LEDGER='ACTUALS'
23:57:23   8  AND    A.FISCAL_YEAR=2019
23:57:23   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
23:57:23  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:57:23  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:57:23  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:57:23  13  AND    A.CURRENCY_CD='GBP'
23:57:23  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:57:23  15  /

Explained.

Elapsed: 00:00:00.25
23:57:24 SQL> @@xp
23:57:24 SQL> REM xp.sql
23:57:24 SQL> REM spool xp
23:57:24 SQL> REM set pages 9999 lines 200 autotrace off
23:57:24 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1498194812

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1703 |   128K|   421   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1703 |   128K|   421   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1703 |   128K|   420   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7156 |   405K|   418   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   | 68804 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 68804 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.14
23:57:24 SQL> REM spool off
23:57:24 SQL> 
23:57:24 SQL> REM 2020
23:57:24 SQL> explain plan for
23:57:24   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:57:24   3  FROM   PS_LEDGER A
23:57:24   4  ,      PSTREESELECT05 L1
23:57:24   5  ,      PSTREESELECT10 L
23:57:24   6  ,      PSTREESELECT10 L2
23:57:24   7  WHERE  A.LEDGER='ACTUALS'
23:57:24   8  AND    A.FISCAL_YEAR=2020
23:57:24   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
23:57:24  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:57:24  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:57:24  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:57:24  13  AND    A.CURRENCY_CD='GBP'
23:57:24  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:57:24  15  /

Explained.

Elapsed: 00:00:00.28
23:57:24 SQL> @@xp
23:57:24 SQL> REM xp.sql
23:57:24 SQL> REM spool xp
23:57:24 SQL> REM set pages 9999 lines 200 autotrace off
23:57:24 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3016493666

------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   | 12328 |   927K|       |   653   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   | 12328 |   927K|  1080K|   653   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   | 12328 |   927K|       |   429   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   | 51748 |  2931K|       |   427   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   |   496K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   496K|    13M|       |   423   (2)| 00:00:01 |     2 |     7 |
------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  10 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGE
        R_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]
        ></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D
        5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CD
        ATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></
        s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v>
        </o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><
        t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h
        ></f></q>


83 rows selected.

Elapsed: 00:00:00.16
23:57:24 SQL> REM spool off
23:57:24 SQL> 
23:57:24 SQL> explain plan for
23:57:24   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:57:24   3  FROM   PS_LEDGER A
23:57:24   4  ,      PSTREESELECT05 L1
23:57:24   5  ,      PSTREESELECT10 L
23:57:24   6  ,      PSTREESELECT10 L2
23:57:24   7  WHERE  A.LEDGER='ACTUALS'
23:57:24   8  AND    A.FISCAL_YEAR=2019
23:57:24   9  AND    A.ACCOUNTING_PERIOD = 7
23:57:24  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:57:24  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:57:24  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:57:24  13  AND    A.CURRENCY_CD='GBP'
23:57:24  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:57:24  15  /

Explained.

Elapsed: 00:00:00.28
23:57:25 SQL> @@xp
23:57:25 SQL> REM xp.sql
23:57:25 SQL> REM spool xp
23:57:25 SQL> REM set pages 9999 lines 200 autotrace off
23:57:25 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 387550712

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1824 |   137K|    76   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1824 |   137K|    76   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1824 |   137K|    75   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7594 |   430K|    73   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE       |                   | 72510 |  2053K|    70   (2)| 00:00:01 |     8 |     8 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 72510 |  2053K|    70   (2)| 00:00:01 |     8 |     8 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"=7)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.17
23:57:25 SQL> REM spool off
23:57:25 SQL> 
23:57:25 SQL> REM 2020
23:57:25 SQL> explain plan for
23:57:25   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:57:25   3  FROM   PS_LEDGER A
23:57:25   4  ,      PSTREESELECT05 L1
23:57:25   5  ,      PSTREESELECT10 L
23:57:25   6  ,      PSTREESELECT10 L2
23:57:25   7  WHERE  A.LEDGER='ACTUALS'
23:57:25   8  AND    A.FISCAL_YEAR=2020
23:57:25   9  AND    (A.ACCOUNTING_PERIOD = 7)
23:57:25  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:57:25  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:57:25  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:57:25  13  AND    A.CURRENCY_CD='GBP'
23:57:25  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:57:25  15  /

Explained.

Elapsed: 00:00:00.18
23:57:25 SQL> @@xp
23:57:25 SQL> REM xp.sql
23:57:25 SQL> REM spool xp
23:57:25 SQL> REM set pages 9999 lines 200 autotrace off
23:57:25 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1321682226

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|    12 |             PARTITION RANGE SINGLE                    |                   |     1 |    44 |     3   (0)| 00:00:01 |     8 |     8 |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    36 |    36 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    36 |    36 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.23
23:57:25 SQL> REM spool off
23:57:25 SQL> 
23:57:25 SQL> set autotrace off
23:57:25 SQL> 
23:57:25 SQL> @@mvtrc
23:57:25 SQL> REM mvtrc.sql
23:57:25 SQL> disconnect
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.9.0.0.0
23:57:25 SQL> connect scott/tiger@oracle_pdb
Connected.
23:57:25 SQL> 
23:57:25 SQL> column name format a20
23:57:25 SQL> column value format a70
23:57:25 SQL> select * from v$diag_info where name like '%Trace%';

   INST_ID NAME                 VALUE                                                                      CON_ID
---------- -------------------- ---------------------------------------------------------------------- ----------
         1 Diag Trace           /u01/app/oracle/diag/rdbms/oracle/oracle/trace                                  0
         1 Default Trace File   /u01/app/oracle/diag/rdbms/oracle/oracle/trace/oracle_ora_17247.trc             0

Elapsed: 00:00:00.00
23:57:25 SQL> 
23:57:25 SQL> alter session set tracefile_identifier=PCT;

Session altered.

Elapsed: 00:00:00.00
23:57:25 SQL> alter session set sql_trace = true;

Session altered.

Elapsed: 00:00:00.00
23:57:25 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.77
23:57:26 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:49.48
23:58:16 SQL> alter session set sql_trace = false;

Session altered.

Elapsed: 00:00:00.00
23:58:16 SQL> 
23:58:16 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.51
23:58:16 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.17
23:58:16 SQL> 
23:58:16 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2019');

PL/SQL procedure successfully completed.

Elapsed: 00:00:27.17
23:58:43 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:15.55
23:58:59 SQL> 
23:58:59 SQL> @@mvvol
23:58:59 SQL> REM mvvol.sql
23:58:59 SQL> 
23:58:59 SQL> set autotrace off
23:58:59 SQL> break on table_name skip 1 on partition_name
23:58:59 SQL> column table_name format a15
23:58:59 SQL> column column_name format a20
23:58:59 SQL> column mview_name format a20
23:58:59 SQL> column partition_position format 999 heading 'Part|Pos'
23:58:59 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
23:58:59 SQL> column partition_name format a20
23:58:59 SQL> column subpartition_name format a25
23:58:59 SQL> column num_rows format 9999999
23:58:59 SQL> column num_distinct heading 'Num|Distinct' format 9999999
23:58:59 SQL> column num_buckets heading 'Num|Buckets'	format 9999
23:58:59 SQL> column blocks format 99999
23:58:59 SQL> column rpb format 999.9 heading 'Rows|per|Block'
23:58:59 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2019       FRESH               FAST_PCT VALID
MV_LEDGER_2020       FRESH               FAST_PCT VALID

Elapsed: 00:00:00.00
23:58:59 SQL> 
23:58:59 SQL> select count(*) from mv_ledger_2019;

  COUNT(*)
----------
    946762

Elapsed: 00:00:00.06
23:58:59 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
    581484

Elapsed: 00:00:00.03
23:58:59 SQL> 
23:58:59 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
23:58:59   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
23:58:59   3  , COALESCE(c.compression, b.compression) compression
23:58:59   4  , COALESCE(c.compress_for, b.compress_for) compress_for
23:58:59   5  from user_tab_statistics a
23:58:59   6  	LEFT OUTER JOIN user_tab_partitions b
23:58:59   7  	  ON a.table_name = b.table_name
23:58:59   8  	  AND a.partition_name = b.partition_name
23:58:59   9  	LEFT OUTER JOIN user_tab_subpartitions c
23:58:59  10  	  ON a.table_name = c.table_name
23:58:59  11  	  AND a.partition_name = c.partition_name
23:58:59  12  	  AND a.subpartition_name = c.subpartition_name
23:58:59  13  where a.table_name like '%LEDGER%'
23:58:59  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
23:58:59  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2019     1 AP_BF                                                  72886    252  289.2 ENABLED  BASIC
                   2 AP_01                                                  72925    252  289.4 ENABLED  BASIC
                   3 AP_02                                                  72736    251  289.8 ENABLED  BASIC
                   4 AP_03                                                  72745    251  289.8 ENABLED  BASIC
                   5 AP_04                                                  72649    251  289.4 ENABLED  BASIC
                   6 AP_05                                                  71947    249  288.9 ENABLED  BASIC
                   7 AP_06                                                  72903    252  289.3 ENABLED  BASIC
                   8 AP_07                                                  72510    250  290.0 ENABLED  BASIC
                   9 AP_08                                                  72520    251  288.9 ENABLED  BASIC
                  10 AP_09                                                  72965    252  289.5 ENABLED  BASIC
                  11 AP_10                                                  72209    250  288.8 ENABLED  BASIC
                  12 AP_11                                                  72647    251  289.4 ENABLED  BASIC
                  13 AP_12                                                  73121    253  289.0 ENABLED  BASIC
                  14 AP_CF                                                   1999     25   80.0 ENABLED  BASIC
                                                                           946762   3290  287.8

MV_LEDGER_2020     1 AP_BF                                                  72475    384  188.7 ENABLED  BASIC
                   2 AP_01                                                  72981    384  190.1 ENABLED  BASIC
                   3 AP_02                                                  72726    384  189.4 ENABLED  BASIC
                   4 AP_03                                                  72844    384  189.7 ENABLED  BASIC
                   5 AP_04                                                  72709    384  189.3 ENABLED  BASIC
                   6 AP_05                                                  72535    384  188.9 ENABLED  BASIC
                   7 AP_06                                                  72419    384  188.6 ENABLED  BASIC
                   8 AP_07                                                  72795   1006   72.4 ENABLED  BASIC
                   9 AP_08                                                      0      0        ENABLED  BASIC
                  10 AP_09                                                      0      0        ENABLED  BASIC
                  11 AP_10                                                      0      0        ENABLED  BASIC
                  12 AP_11                                                      0      0        ENABLED  BASIC
                  13 AP_12                                                      0      0        ENABLED  BASIC
                  14 AP_CF                                                      0      0        ENABLED  BASIC
                                                                           581484   3694  157.4

PS_LEDGER          1 LEDGER_2018                                          1100000  17865   61.6 ENABLED  BASIC
                   1                         1 LEDGER_2018_AP_BF            84553   1372   61.6 ENABLED  BASIC
                   1                         2 LEDGER_2018_AP_01            84617   1372   61.7 ENABLED  BASIC
                   1                         3 LEDGER_2018_AP_02            84607   1373   61.6 ENABLED  BASIC
                   1                         4 LEDGER_2018_AP_03            84592   1373   61.6 ENABLED  BASIC
                   1                         5 LEDGER_2018_AP_04            84544   1372   61.6 ENABLED  BASIC
                   1                         6 LEDGER_2018_AP_05            84563   1372   61.6 ENABLED  BASIC
                   1                         7 LEDGER_2018_AP_06            84813   1376   61.6 ENABLED  BASIC
                   1                         8 LEDGER_2018_AP_07            84380   1369   61.6 ENABLED  BASIC
                   1                         9 LEDGER_2018_AP_08            84402   1369   61.7 ENABLED  BASIC
                   1                        10 LEDGER_2018_AP_09            84604   1373   61.6 ENABLED  BASIC
                   1                        11 LEDGER_2018_AP_10            83937   1362   61.6 ENABLED  BASIC
                   1                        12 LEDGER_2018_AP_11            83986   1363   61.6 ENABLED  BASIC
                   1                        13 LEDGER_2018_AP_12            84202   1366   61.6 ENABLED  BASIC
                   1                        14 LEDGER_2018_AP_CF             2200     53   41.5 ENABLED  BASIC
                   2 LEDGER_2019                                          1100000  17863   61.6 ENABLED  BASIC
                   2                         1 LEDGER_2019_AP_BF            84718   1374   61.7 ENABLED  BASIC
                   2                         2 LEDGER_2019_AP_01            84777   1375   61.7 ENABLED  BASIC
                   2                         3 LEDGER_2019_AP_02            84478   1370   61.7 ENABLED  BASIC
                   2                         4 LEDGER_2019_AP_03            84577   1372   61.6 ENABLED  BASIC
                   2                         5 LEDGER_2019_AP_04            84460   1370   61.6 ENABLED  BASIC
                   2                         6 LEDGER_2019_AP_05            83745   1359   61.6 ENABLED  BASIC
                   2                         7 LEDGER_2019_AP_06            84818   1376   61.6 ENABLED  BASIC
                   2                         8 LEDGER_2019_AP_07            84217   1367   61.6 ENABLED  BASIC
                   2                         9 LEDGER_2019_AP_08            84227   1366   61.7 ENABLED  BASIC
                   2                        10 LEDGER_2019_AP_09            84602   1373   61.6 ENABLED  BASIC
                   2                        11 LEDGER_2019_AP_10            83849   1360   61.7 ENABLED  BASIC
                   2                        12 LEDGER_2019_AP_11            84460   1371   61.6 ENABLED  BASIC
                   2                        13 LEDGER_2019_AP_12            84872   1377   61.6 ENABLED  BASIC
                   2                        14 LEDGER_2019_AP_CF             2200     53   41.5 ENABLED  BASIC
                   3 LEDGER_2020                                           637239  16771   38.0 NONE
                   3                         1 LEDGER_2020_AP_BF            84205   2180   38.6 DISABLED
                   3                         2 LEDGER_2020_AP_01            84894   2226   38.1 DISABLED
                   3                         3 LEDGER_2020_AP_02            84319   2211   38.1 DISABLED
                   3                         4 LEDGER_2020_AP_03            84722   2222   38.1 DISABLED
                   3                         5 LEDGER_2020_AP_04            84345   2212   38.1 DISABLED
                   3                         6 LEDGER_2020_AP_05            84286   2211   38.1 DISABLED
                   3                         7 LEDGER_2020_AP_06            84128   2206   38.1 DISABLED
                   3                         8 LEDGER_2020_AP_07             7754    215   36.1 DISABLED
                   3                         9 LEDGER_2020_AP_08             7680    213   36.1 DISABLED
                   3                        10 LEDGER_2020_AP_09             7722    214   36.1 DISABLED
                   3                        11 LEDGER_2020_AP_10             7659    212   36.1 DISABLED
                   3                        12 LEDGER_2020_AP_11             7646    212   36.1 DISABLED
                   3                        13 LEDGER_2020_AP_12             7679    213   36.1 DISABLED
                   3                        14 LEDGER_2020_AP_CF              200     24    8.3 DISABLED
                   4 LEDGER_2021                                           100000   2792   35.8 NONE
                   4                         1 LEDGER_2021_AP_BF             7709    211   36.5 DISABLED
                   4                         2 LEDGER_2021_AP_01             7585    211   35.9 DISABLED
                   4                         3 LEDGER_2021_AP_02             7743    215   36.0 DISABLED
                   4                         4 LEDGER_2021_AP_03             7607    211   36.1 DISABLED
                   4                         5 LEDGER_2021_AP_04             7795    216   36.1 DISABLED
                   4                         6 LEDGER_2021_AP_05             7633    212   36.0 DISABLED
                   4                         7 LEDGER_2021_AP_06             7666    213   36.0 DISABLED
                   4                         8 LEDGER_2021_AP_07             7545    210   35.9 DISABLED
                   4                         9 LEDGER_2021_AP_08             7692    214   35.9 DISABLED
                   4                        10 LEDGER_2021_AP_09             7575    211   35.9 DISABLED
                   4                        11 LEDGER_2021_AP_10             7932    219   36.2 DISABLED
                   4                        12 LEDGER_2021_AP_11             7644    212   36.1 DISABLED
                   4                        13 LEDGER_2021_AP_12             7674    213   36.0 DISABLED
                   4                        14 LEDGER_2021_AP_CF              200     24    8.3 DISABLED
                                                                          2937239  55291   53.1


91 rows selected.

Elapsed: 00:00:03.26
23:59:02 SQL> 
23:59:02 SQL> column extension format a40
23:59:02 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
23:59:02   2  from user_tab_col_statistics s
23:59:02   3  	LEFT OUTER JOIN user_stat_extensions e
23:59:02   4  	ON e.table_name = s.table_name
23:59:02   5  	AND e.extension_name = s.column_name
23:59:02   6  where s.table_name like 'MV_LEDGER%'
23:59:02   7  order by 1,2
23:59:02   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2019  ACCOUNT                  1000       1 NONE            18-NOV-20
                ACCOUNTING_PERIOD          15       1 NONE            18-NOV-20
                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                CHARTFIELD1              1000       1 NONE            18-NOV-20
                FISCAL_YEAR                 1       1 NONE            18-NOV-20
                POSTED_TOTAL_AMT       935744       1 NONE            18-NOV-20
                SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$             1000       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$             1000       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                )


MV_LEDGER_2020  ACCOUNT                   999       1 NONE            18-NOV-20
                ACCOUNTING_PERIOD           8       1 NONE            18-NOV-20
                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                CHARTFIELD1               998       1 NONE            18-NOV-20
                FISCAL_YEAR                 1       1 NONE            18-NOV-20
                POSTED_TOTAL_AMT       581484       1 NONE            18-NOV-20
                SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              998       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$                8       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                )



22 rows selected.

Elapsed: 00:00:01.20
23:59:04 SQL> column extension format a40
23:59:04 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
23:59:04   2  from user_part_col_statistics s
23:59:04   3  	LEFT OUTER JOIN user_stat_extensions e
23:59:04   4  	ON e.table_name = s.table_name
23:59:04   5  	AND e.extension_name = s.column_name
23:59:04   6  where s.table_name like 'MV_LEDGER%'
23:59:04   7  order by 1,2
23:59:04   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2019  AP_01                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   996       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72616       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              996       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_02                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   995       1 NONE            18-NOV-20
                                     CHARTFIELD1               992       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72736       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_03                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   991       1 NONE            18-NOV-20
                                     CHARTFIELD1               992       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72152       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_04                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   992       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72649       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_05                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   992       1 NONE            18-NOV-20
                                     CHARTFIELD1               997       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        71136       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              997       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_06                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   991       1 NONE            18-NOV-20
                                     CHARTFIELD1               993       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72903       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_07                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   991       1 NONE            18-NOV-20
                                     CHARTFIELD1               993       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72440       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_08                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   995       1 NONE            18-NOV-20
                                     CHARTFIELD1               992       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72520       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_09                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   993       1 NONE            18-NOV-20
                                     CHARTFIELD1               990       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72872       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_10                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   993       1 NONE            18-NOV-20
                                     CHARTFIELD1               995       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        70824       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_11                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   994       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72240       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_12                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   989       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72208       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              989       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_BF                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   991       1 NONE            18-NOV-20
                                     CHARTFIELD1               996       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        71968       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              996       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_CF                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   745       1 NONE            18-NOV-20
                                     CHARTFIELD1               754       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           2       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT         1999       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              745       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              754       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )


MV_LEDGER_2020  AP_01                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   992       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72184       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_02                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   993       1 NONE            18-NOV-20
                                     CHARTFIELD1               991       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72064       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_03                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   993       1 NONE            18-NOV-20
                                     CHARTFIELD1               991       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72016       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_04                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   991       1 NONE            18-NOV-20
                                     CHARTFIELD1               989       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72709       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              989       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_05                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   993       1 NONE            18-NOV-20
                                     CHARTFIELD1               992       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72296       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_06                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   994       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        70816       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_07                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   995       1 NONE            18-NOV-20
                                     CHARTFIELD1               995       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72795       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_08                BUSINESS_UNIT               0       0 NONE            18-NOV-20
                                     ACCOUNT                     0       0 NONE            18-NOV-20
                                     CHARTFIELD1                 0       0 NONE            18-NOV-20
                                     FISCAL_YEAR                 0       0 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                                     SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_09                BUSINESS_UNIT               0       0 NONE            18-NOV-20
                                     ACCOUNT                     0       0 NONE            18-NOV-20
                                     CHARTFIELD1                 0       0 NONE            18-NOV-20
                                     FISCAL_YEAR                 0       0 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                                     SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_10                BUSINESS_UNIT               0       0 NONE            18-NOV-20
                                     ACCOUNT                     0       0 NONE            18-NOV-20
                                     CHARTFIELD1                 0       0 NONE            18-NOV-20
                                     FISCAL_YEAR                 0       0 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                                     SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_11                BUSINESS_UNIT               0       0 NONE            18-NOV-20
                                     ACCOUNT                     0       0 NONE            18-NOV-20
                                     CHARTFIELD1                 0       0 NONE            18-NOV-20
                                     FISCAL_YEAR                 0       0 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                                     SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_12                BUSINESS_UNIT               0       0 NONE            18-NOV-20
                                     ACCOUNT                     0       0 NONE            18-NOV-20
                                     CHARTFIELD1                 0       0 NONE            18-NOV-20
                                     FISCAL_YEAR                 0       0 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                                     SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_BF                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   992       1 NONE            18-NOV-20
                                     CHARTFIELD1               994       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT        72475       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                AP_CF                BUSINESS_UNIT               0       0 NONE            18-NOV-20
                                     ACCOUNT                     0       0 NONE            18-NOV-20
                                     CHARTFIELD1                 0       0 NONE            18-NOV-20
                                     FISCAL_YEAR                 0       0 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                                     SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )



308 rows selected.

Elapsed: 00:00:00.23
23:59:04 SQL> 
23:59:04 SQL> column extension format a40
23:59:04 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
23:59:04   2  from user_subpart_col_statistics s
23:59:04   3  	LEFT OUTER JOIN user_stat_extensions e
23:59:04   4  	ON e.table_name = s.table_name
23:59:04   5  	AND e.extension_name = s.column_name
23:59:04   6  where s.table_name like 'MV_LEDGER%'
23:59:04   7  order by 1,2
23:59:04   8  ;

no rows selected

Elapsed: 00:00:00.24
23:59:04 SQL> @@mvsql
23:59:04 SQL> REM mvsql.sql
23:59:04 SQL> set autotrace off
23:59:04 SQL> 
23:59:04 SQL> REM 2018
23:59:04 SQL> set lines 200 pages 999
23:59:04 SQL> explain plan for
23:59:04   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:59:04   3  FROM   PS_LEDGER A
23:59:04   4  ,      PSTREESELECT05 L1
23:59:04   5  ,      PSTREESELECT10 L
23:59:04   6  ,      PSTREESELECT10 L2
23:59:04   7  WHERE  A.LEDGER='ACTUALS'
23:59:04   8  AND    A.FISCAL_YEAR=2018
23:59:04   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
23:59:04  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:59:04  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:59:04  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:59:04  13  AND    A.CURRENCY_CD='GBP'
23:59:04  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:59:04  15  /

Explained.

Elapsed: 00:00:00.17
23:59:04 SQL> @@xp
23:59:04 SQL> REM xp.sql
23:59:04 SQL> REM spool xp
23:59:04 SQL> REM set pages 9999 lines 200 autotrace off
23:59:04 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3827045647

------------------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                   |   990 | 92070 |  2245   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY               |                   |   990 | 92070 |  2245   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                  |                   |   990 | 92070 |  2244   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN          | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                 |                   |  4161 |   300K|  2242   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN     |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN        | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT             |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN       | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE   |                   | 39970 |  1756K|  2239   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR|                   | 39970 |  1756K|  2239   (1)| 00:00:01 |     2 |     7 |
|* 11 |       TABLE ACCESS FULL      | PS_LEDGER         | 39970 |  1756K|  2239   (1)| 00:00:01 |     1 |    14 |
------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDAT
        A[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L
        2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.13
23:59:04 SQL> REM spool off
23:59:04 SQL> 
23:59:04 SQL> REM 2019
23:59:04 SQL> explain plan for
23:59:04   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:59:04   3  FROM   PS_LEDGER A
23:59:04   4  ,      PSTREESELECT05 L1
23:59:04   5  ,      PSTREESELECT10 L
23:59:04   6  ,      PSTREESELECT10 L2
23:59:04   7  WHERE  A.LEDGER='ACTUALS'
23:59:04   8  AND    A.FISCAL_YEAR=2019
23:59:04   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
23:59:04  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:59:04  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:59:04  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:59:04  13  AND    A.CURRENCY_CD='GBP'
23:59:04  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:59:04  15  /

Explained.

Elapsed: 00:00:00.28
23:59:05 SQL> @@xp
23:59:05 SQL> REM xp.sql
23:59:05 SQL> REM spool xp
23:59:05 SQL> REM set pages 9999 lines 200 autotrace off
23:59:05 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1498194812

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1703 |   128K|   421   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1703 |   128K|   421   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1703 |   128K|   420   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7156 |   405K|   418   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   | 68804 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 68804 |  1948K|   415   (2)| 00:00:01 |     2 |     7 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.12
23:59:05 SQL> REM spool off
23:59:05 SQL> 
23:59:05 SQL> REM 2020
23:59:05 SQL> explain plan for
23:59:05   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:59:05   3  FROM   PS_LEDGER A
23:59:05   4  ,      PSTREESELECT05 L1
23:59:05   5  ,      PSTREESELECT10 L
23:59:05   6  ,      PSTREESELECT10 L2
23:59:05   7  WHERE  A.LEDGER='ACTUALS'
23:59:05   8  AND    A.FISCAL_YEAR=2020
23:59:05   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
23:59:05  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:59:05  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:59:05  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:59:05  13  AND    A.CURRENCY_CD='GBP'
23:59:05  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:59:05  15  /

Explained.

Elapsed: 00:00:00.24
23:59:05 SQL> @@xp
23:59:05 SQL> REM xp.sql
23:59:05 SQL> REM spool xp
23:59:05 SQL> REM set pages 9999 lines 200 autotrace off
23:59:05 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3016493666

------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   | 13921 |  1046K|       |   891   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   | 13921 |  1046K|  1224K|   891   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   | 13921 |  1046K|       |   637   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   | 58431 |  3309K|       |   635   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE ITERATOR     |                   |   560K|    15M|       |   630   (1)| 00:00:01 |     2 |     7 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   560K|    15M|       |   630   (1)| 00:00:01 |     2 |     7 |
------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  10 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGE
        R_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]
        ></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D
        5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CD
        ATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></
        s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v>
        </o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><
        t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h
        ></f></q>


83 rows selected.

Elapsed: 00:00:00.12
23:59:05 SQL> REM spool off
23:59:05 SQL> 
23:59:05 SQL> explain plan for
23:59:05   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:59:05   3  FROM   PS_LEDGER A
23:59:05   4  ,      PSTREESELECT05 L1
23:59:05   5  ,      PSTREESELECT10 L
23:59:05   6  ,      PSTREESELECT10 L2
23:59:05   7  WHERE  A.LEDGER='ACTUALS'
23:59:05   8  AND    A.FISCAL_YEAR=2019
23:59:05   9  AND    A.ACCOUNTING_PERIOD = 7
23:59:05  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:59:05  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:59:05  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:59:05  13  AND    A.CURRENCY_CD='GBP'
23:59:05  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:59:05  15  /

Explained.

Elapsed: 00:00:00.23
23:59:05 SQL> @@xp
23:59:05 SQL> REM xp.sql
23:59:05 SQL> REM spool xp
23:59:05 SQL> REM set pages 9999 lines 200 autotrace off
23:59:05 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 387550712

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                 |                   |  1824 |   137K|    76   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                   |                   |  1824 |   137K|    76   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                      |                   |  1824 |   137K|    75   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN              | PS_PSTREESELECT10 |   238 |  4522 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                     |                   |  7594 |   430K|    73   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN         |                   |   208 |  6032 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN            | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                 |                   |   104 |  1872 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN           | PS_PSTREESELECT10 |   104 |  1872 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE       |                   | 72510 |  2053K|    70   (2)| 00:00:01 |     8 |     8 |
|* 10 |      MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2019    | 72510 |  2053K|    70   (2)| 00:00:01 |     8 |     8 |
----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$94D6FF25
   3 - SEL$94D6FF25 / L2@SEL$1
   6 - SEL$94D6FF25 / L1@SEL$1
   8 - SEL$94D6FF25 / L@SEL$1
  10 - SEL$94D6FF25 / MV_LEDGER_2019@SEL$E6021893

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$94D6FF25")
      SWAP_JOIN_INPUTS(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "L2"@"SEL$1")
      USE_HASH(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      USE_MERGE_CARTESIAN(@"SEL$94D6FF25" "L"@"SEL$1")
      LEADING(@"SEL$94D6FF25" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2019"@"SEL$E6021893" "L2"@"SEL$1")
      INDEX(@"SEL$94D6FF25" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$94D6FF25" "MV_LEDGER_2019"@"SEL$E6021893")
      INDEX(@"SEL$94D6FF25" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$94D6FF25" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2019")
      OUTLINE(@"SEL$628CC171")
      REWRITE(@"SEL$628CC171" "MV_LEDGER_2019")
      OUTLINE_LEAF(@"SEL$94D6FF25")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2019"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2019"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2019"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  10 - filter("MV_LEDGER_2019"."ACCOUNTING_PERIOD"=7)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$94D6FF25]]></n><p><![CDATA[SEL$628CC171]]></p><i><o><t>MV</t><v><![CDATA[
        MV_LEDGER_2019]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s>
        <![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]><
        /t><s><![CDATA[SEL$E6021893]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t>
        <s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![
        CDATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$628CC171]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_201
        9]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$
        1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2019]]></t><s><![CDAT
        A[SEL$E6021893]]></s></h></f></q>


83 rows selected.

Elapsed: 00:00:00.14
23:59:05 SQL> REM spool off
23:59:05 SQL> 
23:59:05 SQL> REM 2020
23:59:05 SQL> explain plan for
23:59:05   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
23:59:05   3  FROM   PS_LEDGER A
23:59:05   4  ,      PSTREESELECT05 L1
23:59:05   5  ,      PSTREESELECT10 L
23:59:05   6  ,      PSTREESELECT10 L2
23:59:05   7  WHERE  A.LEDGER='ACTUALS'
23:59:05   8  AND    A.FISCAL_YEAR=2020
23:59:05   9  AND    (A.ACCOUNTING_PERIOD = 7)
23:59:05  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
23:59:05  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
23:59:05  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
23:59:05  13  AND    A.CURRENCY_CD='GBP'
23:59:05  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
23:59:05  15  /

Explained.

Elapsed: 00:00:00.23
23:59:06 SQL> @@xp
23:59:06 SQL> REM xp.sql
23:59:06 SQL> REM spool xp
23:59:06 SQL> REM set pages 9999 lines 200 autotrace off
23:59:06 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1321682226

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|    12 |             PARTITION RANGE SINGLE                    |                   |     1 |    44 |     3   (0)| 00:00:01 |     8 |     8 |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    36 |    36 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    36 |    36 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.17
23:59:06 SQL> REM spool off
23:59:06 SQL> 
23:59:06 SQL> set autotrace off
23:59:06 SQL> @@mvcap
23:59:06 SQL> REM mvcap.sql
23:59:06 SQL> REM spool mvcap
23:59:06 SQL> set autotrace off
23:59:06 SQL> create table MV_CAPABILITIES_TABLE
23:59:06   2  (
23:59:06   3  	statement_id	  varchar(30) ,
23:59:06   4  	mvowner 	  varchar(30) ,
23:59:06   5  	mvname		  varchar(30) ,
23:59:06   6  	capability_name   varchar(30) ,
23:59:06   7  	possible	  character(1) ,
23:59:06   8  	related_text	  varchar(2000) ,
23:59:06   9  	related_num	  number ,
23:59:06  10  	msgno		  integer ,
23:59:06  11  	msgtxt		  varchar(2000) ,
23:59:06  12  	seq		  number
23:59:06  13  ) ;
create table MV_CAPABILITIES_TABLE
             *
ERROR at line 1:
ORA-00955: name is already used by an existing object


Elapsed: 00:00:00.00
23:59:06 SQL> 
23:59:06 SQL> truncate table MV_CAPABILITIES_TABLE;
truncate table MV_CAPABILITIES_TABLE
               *
ERROR at line 1:
ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired


Elapsed: 00:00:00.01
23:59:06 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2019');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.33
23:59:06 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.05
23:59:06 SQL> break on mvname skip 1
23:59:06 SQL> column rel_text format a20
23:59:06 SQL> column msgtxt format a60
23:59:06 SQL> SELECT mvname, capability_name,  possible, SUBSTR(related_text,1,20) AS rel_text, SUBSTR(msgtxt,1,60) AS msgtxt
23:59:06   2  FROM MV_CAPABILITIES_TABLE
23:59:06   3  WHERE mvname like 'MV_LEDGER_20%'
23:59:06   4  ORDER BY mvname, seq;

MVNAME                         CAPABILITY_NAME                P REL_TEXT             MSGTXT
------------------------------ ------------------------------ - -------------------- ------------------------------------------------------------
MV_LEDGER_2019                 PCT                            Y
                               REFRESH_COMPLETE               Y
                               REFRESH_FAST                   Y
                               REWRITE                        Y
                               PCT_TABLE                      Y PS_LEDGER
                               REFRESH_FAST_AFTER_INSERT      N SCOTT.PS_LEDGER      the detail table does not have a materialized view log
                               REFRESH_FAST_AFTER_ONETAB_DML  N POSTED_TOTAL_AMT     SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      see the reason why REFRESH_FAST_AFTER_INSERT is disabled
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      COUNT(*) is not present in the select list
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ANY_DML     N                      see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
                               REFRESH_FAST_PCT               Y
                               REWRITE_FULL_TEXT_MATCH        Y
                               REWRITE_PARTIAL_TEXT_MATCH     Y
                               REWRITE_GENERAL                Y
                               REWRITE_PCT                    Y
                               PCT_TABLE_REWRITE              Y PS_LEDGER

MV_LEDGER_2020                 PCT                            Y
                               REFRESH_COMPLETE               Y
                               REFRESH_FAST                   Y
                               REWRITE                        Y
                               PCT_TABLE                      Y PS_LEDGER
                               REFRESH_FAST_AFTER_INSERT      N SCOTT.PS_LEDGER      the detail table does not have a materialized view log
                               REFRESH_FAST_AFTER_ONETAB_DML  N POSTED_TOTAL_AMT     SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      see the reason why REFRESH_FAST_AFTER_INSERT is disabled
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      COUNT(*) is not present in the select list
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ANY_DML     N                      see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
                               REFRESH_FAST_PCT               Y
                               REWRITE_FULL_TEXT_MATCH        Y
                               REWRITE_PARTIAL_TEXT_MATCH     Y
                               REWRITE_GENERAL                Y
                               REWRITE_PCT                    Y
                               PCT_TABLE_REWRITE              Y PS_LEDGER


34 rows selected.

Elapsed: 00:00:00.01
23:59:06 SQL> 
23:59:06 SQL> REM spool off
23:59:06 SQL> SPOOL OFF
