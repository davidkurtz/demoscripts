18:16:59 SQL> @@preledger.sql
18:16:59 SQL> REM preledger.sql
18:16:59 SQL> clear screen
18:16:59 SQL> connect scott/tiger@oracle_pdb
Connected.
18:16:59 SQL> set time on timi on autotrace off pages 99 lines 200 trimspool on echo on
18:16:59 SQL> alter session set nls_date_Format = 'hh24:mi:ss dd/mm/yyyy';

Session altered.

Elapsed: 00:00:00.00
18:16:59 SQL> drop table ps_ledger purge;

Table dropped.

Elapsed: 00:00:03.98
18:17:03 SQL> drop materialized view mv_ledger_2019;
drop materialized view mv_ledger_2019
*
ERROR at line 1:
ORA-12003: materialized view or zonemap "SCOTT"."MV_LEDGER_2019" does not exist


Elapsed: 00:00:00.00
18:17:03 SQL> drop table mv_ledger_2019 purge;
drop table mv_ledger_2019 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:17:03 SQL> drop materialized view mv_ledger_2020;

Materialized view dropped.

Elapsed: 00:00:00.85
18:17:04 SQL> drop table mv_ledger_2020 purge;
drop table mv_ledger_2020 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:17:04 SQL> DROP TABLE PSTREESELECT05 PURGE;

Table dropped.

Elapsed: 00:00:00.10
18:17:04 SQL> DROP TABLE PSTREESELECT10 PURGE;

Table dropped.

Elapsed: 00:00:00.24
18:17:04 SQL> purge recyclebin;

Recyclebin purged.

Elapsed: 00:00:00.00
18:17:04 SQL> 
18:17:04 SQL> CREATE TABLE ps_ledger
18:17:04   2  (business_unit VARCHAR2(5) NOT NULL
18:17:04   3  ,ledger VARCHAR2(10) NOT NULL
18:17:04   4  ,account VARCHAR2(10) NOT NULL
18:17:04   5  ,altacct VARCHAR2(10) NOT NULL
18:17:04   6  ,deptid VARCHAR2(10) NOT NULL
18:17:04   7  ,operating_unit VARCHAR2(8) NOT NULL
18:17:04   8  ,product VARCHAR2(6) NOT NULL
18:17:04   9  ,fund_code VARCHAR2(5) NOT NULL
18:17:04  10  ,class_fld VARCHAR2(5) NOT NULL
18:17:04  11  ,program_code VARCHAR2(5) NOT NULL
18:17:04  12  ,budget_ref VARCHAR2(8) NOT NULL
18:17:04  13  ,affiliate VARCHAR2(5) NOT NULL
18:17:04  14  ,affiliate_intra1 VARCHAR2(10) NOT NULL
18:17:04  15  ,affiliate_intra2 VARCHAR2(10) NOT NULL
18:17:04  16  ,chartfield1 VARCHAR2(10) NOT NULL
18:17:04  17  ,chartfield2 VARCHAR2(10) NOT NULL
18:17:04  18  ,chartfield3 VARCHAR2(10) NOT NULL
18:17:04  19  ,project_id VARCHAR2(15) NOT NULL
18:17:04  20  ,book_code VARCHAR2(4) NOT NULL
18:17:04  21  ,gl_adjust_type VARCHAR2(4) NOT NULL
18:17:04  22  ,currency_cd VARCHAR2(3) NOT NULL
18:17:04  23  ,statistics_code VARCHAR2(3) NOT NULL
18:17:04  24  ,fiscal_year SMALLINT NOT NULL
18:17:04  25  ,accounting_period SMALLINT NOT NULL
18:17:04  26  ,posted_total_amt DECIMAL(26,3) NOT NULL
18:17:04  27  ,posted_base_amt DECIMAL(26,3) NOT NULL
18:17:04  28  ,posted_tran_amt DECIMAL(26,3) NOT NULL
18:17:04  29  ,base_currency VARCHAR2(3) NOT NULL
18:17:04  30  ,dttm_stamp_sec TIMESTAMP
18:17:04  31  ,process_instance DECIMAL(10) NOT NULL
18:17:04  32  ) PCTFREE 10 PCTUSED 80
18:17:04  33  PARTITION BY RANGE (FISCAL_YEAR)
18:17:04  34  SUBPARTITION BY LIST (ACCOUNTING_PERIOD)
18:17:04  35  SUBPARTITION TEMPLATE
18:17:04  36  (SUBPARTITION ap_bf VALUES (0)
18:17:04  37  ,SUBPARTITION ap_01 VALUES (1)
18:17:04  38  ,SUBPARTITION ap_02 VALUES (2)
18:17:04  39  ,SUBPARTITION ap_03 VALUES (3)
18:17:04  40  ,SUBPARTITION ap_04 VALUES (4)
18:17:04  41  ,SUBPARTITION ap_05 VALUES (5)
18:17:04  42  ,SUBPARTITION ap_06 VALUES (6)
18:17:04  43  ,SUBPARTITION ap_07 VALUES (7)
18:17:04  44  ,SUBPARTITION ap_08 VALUES (8)
18:17:04  45  ,SUBPARTITION ap_09 VALUES (9)
18:17:04  46  ,SUBPARTITION ap_10 VALUES (10)
18:17:04  47  ,SUBPARTITION ap_11 VALUES (11)
18:17:04  48  ,SUBPARTITION ap_12 VALUES (12)
18:17:04  49  ,SUBPARTITION ap_cf VALUES (DEFAULT))
18:17:04  50   (PARTITION ledger_2018 VALUES LESS THAN (2019) PCTFREE 0 COMPRESS
18:17:04  51  ,PARTITION ledger_2019 VALUES LESS THAN (2020) PCTFREE 0 COMPRESS
18:17:04  52  ,PARTITION ledger_2020 VALUES LESS THAN (2021)
18:17:04  53  ,PARTITION ledger_2021 VALUES LESS THAN (2022)
18:17:04  54  )
18:17:04  55  ENABLE ROW MOVEMENT NOLOGGING
18:17:04  56  /

Table created.

Elapsed: 00:00:00.20
18:17:04 SQL> @treeselectors
18:17:04 SQL> REM treeselectors.sql
18:17:04 SQL> 
18:17:04 SQL> DROP TABLE PSTREESELECT05 PURGE;
DROP TABLE PSTREESELECT05 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
18:17:04 SQL> CREATE TABLE PSTREESELECT05
18:17:04   2  (SELECTOR_NUM INTEGER NOT NULL,
18:17:04   3   TREE_NODE_NUM INTEGER NOT NULL,
18:17:04   4   RANGE_FROM_05 VARCHAR2(05) NOT NULL,
18:17:04   5   RANGE_TO_05   VARCHAR2(05) NOT NULL)
18:17:04   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
18:17:04   7   (PARTITION pstreeselector VALUES LESS THAN (2))
18:17:04   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.03
18:17:04 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT05 ON PSTREESELECT05 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_05);

Index created.

Elapsed: 00:00:00.02
18:17:04 SQL> 
18:17:04 SQL> DROP TABLE PSTREESELECT10 PURGE;
DROP TABLE PSTREESELECT10 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:17:04 SQL> CREATE TABLE PSTREESELECT10
18:17:04   2  (SELECTOR_NUM INTEGER NOT NULL,
18:17:04   3   TREE_NODE_NUM INTEGER NOT NULL,
18:17:04   4   RANGE_FROM_10 VARCHAR2(10) NOT NULL,
18:17:04   5   RANGE_TO_10   VARCHAR2(10) NOT NULL)
18:17:04   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
18:17:04   7   (PARTITION pstreeselector VALUES LESS THAN (2))
18:17:04   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.03
18:17:04 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT10 ON PSTREESELECT10 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_10);

Index created.

Elapsed: 00:00:00.02
18:17:04 SQL> 
18:17:04 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
18:17:04 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
18:17:04 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.06
18:17:04 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.04
18:17:04 SQL> 
18:17:04 SQL> @popledger
18:17:04 SQL> REM popledger.sql
18:17:04 SQL> set autotrace off echo on pages 99 lines 200 trimspool on
18:17:04 SQL> 
18:17:04 SQL> truncate table ps_ledger;

Table truncated.

Elapsed: 00:00:00.02
18:17:04 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, LEDGER, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
18:17:05 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
18:17:05 SQL> 
18:17:05 SQL> ALTER TABLE PS_LEDGER PARALLEL 8;

Table altered.

Elapsed: 00:00:00.01
18:17:05 SQL> 
18:17:05 SQL> insert /*+APPEND PARALLEL ENABLE_PARALLEL_DML*/ into ps_ledger
18:17:05   2  with n as (
18:17:05   3  SELECT rownum n from dual connect by level <= 1e2
18:17:05   4  ), fy as (
18:17:05   5  SELECT /*+MATERIALIZE*/ 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
18:17:05   6  ), ap as (
18:17:05   7  SELECT /*+MATERIALIZE*/ FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
18:17:05   8  UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
18:17:05   9  UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
18:17:05  10  ), l as (
18:17:05  11  SELECT /*+MATERIALIZE*/ 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
18:17:05  12  UNION ALL SELECT 'BUDGET' FROM DUAL
18:17:05  13  )
18:17:05  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
18:17:05  15  ,      l.ledger
18:17:05  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
18:17:05  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
18:17:05  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
18:17:05  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
18:17:05  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
18:17:05  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
18:17:05  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
18:17:05  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
18:17:05  24  ,      ' ' budget_ref
18:17:05  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
18:17:05  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
18:17:05  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
18:17:05  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
18:17:05  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
18:17:05  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
18:17:05  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
18:17:05  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
18:17:05  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
18:17:05  34  ,      'GBP' currency_cd
18:17:05  35  ,      ' ' statistics_code
18:17:05  36  ,      fy.fiscal_year
18:17:05  37  ,      ap.accounting_period
18:17:05  38  ,      dbms_random.value(0,1e6) posted_total_amt
18:17:05  39  ,      0 posted_base_amt
18:17:05  40  ,      0 posted_tran_amt
18:17:05  41  ,      'GBP' base_currency
18:17:05  42  ,      SYSDATE dttm_stamp_sec
18:17:05  43  ,      0 process_instance
18:17:05  44  FROM   fy,ap, l, n
18:17:05  45  WHERE  l.ledger = 'BUDGET' or (fy.fiscal_year < 2020 or (fy.fiscal_year = 2020 AND ap.accounting_period <= 6))
18:17:05  46  /

2937737 rows created.

Elapsed: 00:10:48.67
18:27:53 SQL> commit;

Commit complete.

Elapsed: 00:00:00.05
18:27:53 SQL> exec dbms_stats.gather_table_stats('SCOTT','PS_LEDGER');

PL/SQL procedure successfully completed.

Elapsed: 00:01:51.64
18:29:45 SQL> 
18:29:45 SQL> CREATE /*UNIQUE*/ INDEX ps_ledger ON ps_ledger
18:29:45   2  (business_unit,ledger,account,altacct,deptid
18:29:45   3  ,operating_unit,product,fund_code,class_fld,program_code
18:29:45   4  ,budget_ref,affiliate,affiliate_intra1,affiliate_intra2,chartfield1
18:29:45   5  ,chartfield2,chartfield3,project_id,book_code,gl_adjust_type
18:29:45   6  /*,date_code*/,currency_cd,statistics_code,fiscal_year,accounting_period
18:29:45   7  ) COMPRESS 2 NOPARALLEL
18:29:45   8  /

Index created.

Elapsed: 00:01:04.42
18:30:49 SQL> 
18:30:49 SQL> CREATE INDEX psxledger ON ps_ledger
18:30:49   2  (ledger, fiscal_year, accounting_period, business_unit, account, chartfield1
18:30:49   3  ) LOCAL COMPRESS 4 PARALLEL
18:30:49   4  /

Index created.

Elapsed: 00:00:16.14
18:31:05 SQL> 
18:31:05 SQL> CREATE INDEX psyledger ON ps_ledger
18:31:05   2  (ledger, fiscal_year, business_unit, account, chartfield1, accounting_period
18:31:05   3  ) LOCAL COMPRESS 3 PARALLEL
18:31:05   4  /

Index created.

Elapsed: 00:00:10.80
18:31:16 SQL> 
18:31:16 SQL> ALTER INDEX ps_ledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.01
18:31:16 SQL> ALTER INDEX psxledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.04
18:31:16 SQL> ALTER INDEX psyledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.03
18:31:16 SQL> 
18:31:16 SQL> break on report on ledger skip 1
18:31:16 SQL> compute sum of count(*) on report
18:31:16 SQL> set autotrace off
18:31:16 SQL> select ledger, fiscal_year, count(*), max(accounting_period)
18:31:16   2  from ps_ledger
18:31:16   3  group by ledger, fiscal_year
18:31:16   4  order by 1,2
18:31:16   5  /

LEDGER     FISCAL_YEAR   COUNT(*) MAX(ACCOUNTING_PERIOD)
---------- ----------- ---------- ----------------------
ACTUALS           2018    1000000                    999
                  2019    1000000                    999
                  2020     537737                      6

BUDGET            2018     100000                    999
                  2019     100000                    999
                  2020     100000                    999
                  2021     100000                    999

**********             ----------
sum                       2937737

7 rows selected.

Elapsed: 00:00:03.29
18:31:20 SQL> compute sum of count(*) on fiscal_year
18:31:20 SQL> break on report on fiscal_year skip 1 on ledger skip 1
18:31:20 SQL> select ledger, fiscal_year, accounting_period, count(*)
18:31:20   2  from ps_ledger
18:31:20   3  group by ledger, fiscal_year, accounting_period
18:31:20   4  order by 1,2,3
18:31:20   5  /

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
ACTUALS           2018                 0      76789
                                       1      76466
                                       2      77202
                                       3      77018
                                       4      76490
                                       5      76600
                                       6      76654
                                       7      76533
                                       8      76911
                                       9      77044
                                      10      76756
                                      11      76862
                                      12      76675
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2019                 0      76853
                                       1      76831
                                       2      76890
                                       3      76591
                                       4      76510
                                       5      76955
                                       6      76638
                                       7      76957
                                       8      76495
                                       9      76747
                                      10      76932
                                      11      76742
                                      12      76859
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2020                 0      76913
                                       1      76671
                                       2      76427
                                       3      76787
                                       4      76674
                                       5      76888
                                       6      77377

********** ***********                   ----------
           sum                               537737

BUDGET            2018                 0       7717
                                       1       7685
                                       2       7858
                                       3       7661
                                       4       7675
                                       5       7643
                                       6       7736
                                       7       7657
                                       8       7687
                                       9       7683
                                      10       7619
                                      11       7630
                                      12       7549
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2019                 0       7607
                                       1       7566
                                       2       7724
                                       3       7641
                                       4       7644
                                       5       7616
                                       6       7705
                                       7       7794
                                       8       7787
                                       9       7653
                                      10       7766
                                      11       7750
                                      12       7547
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2020                 0       7556
                                       1       7681
                                       2       7594
                                       3       7511
                                       4       7636
                                       5       7875
                                       6       7754
                                       7       7832
                                       8       7669

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
BUDGET            2020                 9       7710
                                      10       7628
                                      11       7607
                                      12       7747
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2021                 0       7607
                                       1       7603
                                       2       7676
                                       3       7760
                                       4       7745
                                       5       7578
                                       6       7645
                                       7       7561
                                       8       7748
                                       9       7559
                                      10       7658
                                      11       7775
                                      12       7885
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

                                         ----------
sum                                         2937737

97 rows selected.

Elapsed: 00:00:03.24
18:31:23 SQL> break on ledger skip 1 on fiscal_year skip 1
18:31:23 SQL> select ledger, account, count(*)
18:31:23   2  from ps_ledger
18:31:23   3  where 1=2
18:31:23   4  group by ledger, account
18:31:23   5  order by 1,3
18:31:23   6  /

no rows selected

Elapsed: 00:00:00.03
18:31:23 SQL> 
18:31:23 SQL> TRUNCATE TABLE PSTREESELECT05;

Table truncated.

Elapsed: 00:00:00.04
18:31:23 SQL> TRUNCATE TABLE PSTREESELECT10;

Table truncated.

Elapsed: 00:00:00.02
18:31:23 SQL> 
18:31:23 SQL> INSERT INTO PSTREESELECT05
18:31:23   2  WITH x as (SELECT DISTINCT business_unit FROM ps_ledger)
18:31:23   3  , y as (SELECT 30982, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, business_unit FROM x)
18:31:23   4  select y.*, business_unit FROM y
18:31:23   5  /

2 rows created.

Elapsed: 00:00:03.02
18:31:26 SQL> INSERT INTO PSTREESELECT10
18:31:26   2  WITH x as (SELECT DISTINCT account FROM ps_ledger)
18:31:26   3  , y as (SELECT 30984, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, account FROM x)
18:31:26   4  select y.*, account FROM y
18:31:26   5  where mod(tree_node_num,100)<25
18:31:26   6  /

270 rows created.

Elapsed: 00:00:03.62
18:31:30 SQL> INSERT INTO PSTREESELECT10
18:31:30   2  WITH x as (SELECT DISTINCT chartfield1 FROM ps_ledger)
18:31:30   3  , y as (SELECT 30985, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, chartfield1 FROM x)
18:31:30   4  select y.*, chartfield1 FROM y
18:31:30   5  where mod(tree_node_num,100)<10
18:31:30   6  /

91 rows created.

Elapsed: 00:00:03.71
18:31:33 SQL> commit;

Commit complete.

Elapsed: 00:00:00.01
18:31:33 SQL> 
18:31:33 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT05');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.23
18:31:34 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT10');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.57
18:31:34 SQL> 
18:31:34 SQL> ALTER TABLE PS_LEDGER NOPARALLEL;

Table altered.

Elapsed: 00:00:00.02
18:31:34 SQL> 
18:31:34 SQL> /*explain plan for
18:31:34 SQL> SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:31:34 SQL> FROM   PS_LEDGER A
18:31:34 SQL> ,      PSTREESELECT05 L1
18:31:34 SQL> ,      PSTREESELECT10 L
18:31:34 SQL> ,      PSTREESELECT10 L2
18:31:34 SQL> WHERE  A.LEDGER='ACTUALS'
18:31:34 SQL> AND    A.FISCAL_YEAR=2020
18:31:34 SQL> AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 2
18:31:34 SQL> AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:31:34 SQL> AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:31:34 SQL> AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:31:34 SQL> AND    A.CURRENCY_CD='GBP'
18:31:34 SQL> GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:31:34 SQL> /
18:31:34 SQL> @@xp*/
18:31:34 SQL> 
18:31:34 SQL> /*CREATE MATERIALIZED VIEW mv_ledger_2019
18:31:34 SQL> PARTITION BY RANGE (FISCAL_YEAR)
18:31:34 SQL> (PARTITION ledger_2019 VALUES LESS THAN (2020)
18:31:34 SQL> ,PARTITION ledger_2020 VALUES LESS THAN (2021)
18:31:34 SQL> ) PCTFREE 0 COMPRESS
18:31:34 SQL> REFRESH COMPLETE ON DEMAND
18:31:34 SQL> ENABLE QUERY REWRITE AS
18:31:34 SQL> SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
18:31:34 SQL> sum(posted_total_amt) posted_total_amt
18:31:34 SQL> FROM ps_ledger
18:31:34 SQL> WHERE fiscal_year = 2019
18:31:34 SQL> AND   ledger = 'ACTUALS'
18:31:34 SQL> AND   currency_cd = 'GBP'
18:31:34 SQL> GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
18:31:34 SQL> */
18:31:34 SQL> 
18:31:34 SQL> CREATE MATERIALIZED VIEW mv_ledger_2020
18:31:34   2  PARTITION BY RANGE (FISCAL_YEAR) --INTERVAL (1)
18:31:34   3  SUBPARTITION BY LIST (ACCOUNTING_PERIOD)
18:31:34   4  SUBPARTITION TEMPLATE
18:31:34   5  (SUBPARTITION ap_bf VALUES (0)
18:31:34   6  ,SUBPARTITION ap_01 VALUES (1)
18:31:34   7  ,SUBPARTITION ap_02 VALUES (2)
18:31:34   8  ,SUBPARTITION ap_03 VALUES (3)
18:31:34   9  ,SUBPARTITION ap_04 VALUES (4)
18:31:34  10  ,SUBPARTITION ap_05 VALUES (5)
18:31:34  11  ,SUBPARTITION ap_06 VALUES (6)
18:31:34  12  ,SUBPARTITION ap_07 VALUES (7)
18:31:34  13  ,SUBPARTITION ap_08 VALUES (8)
18:31:34  14  ,SUBPARTITION ap_09 VALUES (9)
18:31:34  15  ,SUBPARTITION ap_10 VALUES (10)
18:31:34  16  ,SUBPARTITION ap_11 VALUES (11)
18:31:34  17  ,SUBPARTITION ap_12 VALUES (12)
18:31:34  18  ,SUBPARTITION ap_cf VALUES (DEFAULT))
18:31:34  19  (PARTITION ledger_2019 VALUES LESS THAN (2020)
18:31:34  20  ,PARTITION ledger_2020 VALUES LESS THAN (2021)
18:31:34  21  ) PCTFREE 0 COMPRESS PARALLEL
18:31:34  22  REFRESH COMPLETE ON DEMAND
18:31:34  23  ENABLE QUERY REWRITE AS
18:31:34  24  SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
18:31:34  25  sum(posted_total_amt) posted_total_amt
18:31:34  26  FROM ps_ledger
18:31:34  27  WHERE fiscal_year >= 2019
18:31:34  28  AND   ledger = 'ACTUALS'
18:31:34  29  AND   currency_cd = 'GBP'
18:31:34  30  GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
18:31:34  31  /

Materialized view created.

Elapsed: 00:00:18.89
18:31:53 SQL> 
18:31:53 SQL> @@mvpop
18:31:53 SQL> REM mvpop.sql
18:31:53 SQL> set autotrace off
18:31:53 SQL> break on table_name skip 1 on partition_name
18:31:53 SQL> column table_name format a20
18:31:53 SQL> column mview_name format a20
18:31:53 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.01
18:31:53 SQL> 
18:31:53 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
18:31:53 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);
18:31:53 SQL> 
18:31:53 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'C',atomic_refresh=>FALSE);
18:31:53 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'C',atomic_refresh=>FALSE);
18:31:53 SQL> 
18:31:53 SQL> ALTER MATERIALIZED VIEW mv_ledger_2019 NOPARALLEL;
ALTER MATERIALIZED VIEW mv_ledger_2019 NOPARALLEL
*
ERROR at line 1:
ORA-12003: materialized view or zonemap "SCOTT"."MV_LEDGER_2019" does not exist


Elapsed: 00:00:00.01
18:31:53 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');
BEGIN dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254'); END;

*
ERROR at line 1:
ORA-20000: TABLE "SCOTT"."MV_LEDGER_2019" does not exist or insufficient privileges
ORA-06512: at "SYS.DBMS_STATS", line 52981
ORA-06512: at "SYS.DBMS_STATS", line 9446
ORA-06512: at "SYS.DBMS_STATS", line 52904
ORA-06512: at line 1


Elapsed: 00:00:00.01
18:31:53 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','GRANULARITY','ALL');
BEGIN dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','GRANULARITY','ALL'); END;

*
ERROR at line 1:
ORA-20000: TABLE "SCOTT"."MV_LEDGER_2019" does not exist or insufficient privileges
ORA-06512: at "SYS.DBMS_STATS", line 52981
ORA-06512: at "SYS.DBMS_STATS", line 9446
ORA-06512: at "SYS.DBMS_STATS", line 52904
ORA-06512: at line 1


Elapsed: 00:00:00.01
18:31:53 SQL> 
18:31:53 SQL> ALTER MATERIALIZED VIEW mv_ledger_2020 NOPARALLEL;

Materialized view altered.

Elapsed: 00:00:00.03
18:31:53 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
18:31:53 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
18:31:53 SQL> 
18:31:53 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2019');
BEGIN dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2019'); END;

*
ERROR at line 1:
ORA-20000: Unable to analyze TABLE "SCOTT"."MV_LEDGER_2019", insufficient privileges or does not exist
ORA-06512: at "SYS.DBMS_STATS", line 40753
ORA-06512: at "SYS.DBMS_STATS", line 40026
ORA-06512: at "SYS.DBMS_STATS", line 40185
ORA-06512: at "SYS.DBMS_STATS", line 40734
ORA-06512: at line 1


Elapsed: 00:00:01.69
18:31:55 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:57.67
18:32:53 SQL> @@mvvol
18:32:53 SQL> REM mvvol.sql
18:32:53 SQL> 
18:32:53 SQL> set autotrace off
18:32:53 SQL> break on table_name skip 1 on partition_name
18:32:53 SQL> column table_name format a15
18:32:53 SQL> column column_name format a20
18:32:53 SQL> column mview_name format a20
18:32:53 SQL> column partition_position format 999 heading 'Part|Pos'
18:32:53 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
18:32:53 SQL> column partition_name format a20
18:32:53 SQL> column subpartition_name format a25
18:32:53 SQL> column num_rows format 9999999
18:32:53 SQL> column num_distinct heading 'Num|Distinct' format 9999999
18:32:53 SQL> column num_buckets heading 'Num|Buckets'	format 9999
18:32:53 SQL> column blocks format 99999
18:32:53 SQL> column rpb format 999.9 heading 'Rows|per|Block'
18:32:53 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.01
18:32:53 SQL> 
18:32:53 SQL> select count(*) from mv_ledger_2019;
select count(*) from mv_ledger_2019
                     *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:32:53 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
   1456037

Elapsed: 00:00:00.09
18:32:53 SQL> 
18:32:53 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
18:32:53   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
18:32:53   3  , COALESCE(c.compression, b.compression) compression
18:32:53   4  , COALESCE(c.compress_for, b.compress_for) compress_for
18:32:53   5  from user_tab_statistics a
18:32:53   6  	LEFT OUTER JOIN user_tab_partitions b
18:32:53   7  	  ON a.table_name = b.table_name
18:32:53   8  	  AND a.partition_name = b.partition_name
18:32:53   9  	LEFT OUTER JOIN user_tab_subpartitions c
18:32:53  10  	  ON a.table_name = c.table_name
18:32:53  11  	  AND a.partition_name = c.partition_name
18:32:53  12  	  AND a.subpartition_name = c.subpartition_name
18:32:53  13  where a.table_name like '%LEDGER%'
18:32:53  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
18:32:53  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2020     1 LEDGER_2019                                           946911   3360  281.8 ENABLED  BASIC
                   1                         1 LEDGER_2019_AP_BF            72823    256  284.5 ENABLED  BASIC
                   1                         2 LEDGER_2019_AP_01            72670    256  283.9 ENABLED  BASIC
                   1                         3 LEDGER_2019_AP_02            72813    256  284.4 ENABLED  BASIC
                   1                         4 LEDGER_2019_AP_03            72461    256  283.1 ENABLED  BASIC
                   1                         5 LEDGER_2019_AP_04            72547    256  283.4 ENABLED  BASIC
                   1                         6 LEDGER_2019_AP_05            72882    256  284.7 ENABLED  BASIC
                   1                         7 LEDGER_2019_AP_06            72566    256  283.5 ENABLED  BASIC
                   1                         8 LEDGER_2019_AP_07            72794    256  284.4 ENABLED  BASIC
                   1                         9 LEDGER_2019_AP_08            72461    256  283.1 ENABLED  BASIC
                   1                        10 LEDGER_2019_AP_09            72653    256  283.8 ENABLED  BASIC
                   1                        11 LEDGER_2019_AP_10            72818    256  284.4 ENABLED  BASIC
                   1                        12 LEDGER_2019_AP_11            72687    256  283.9 ENABLED  BASIC
                   1                        13 LEDGER_2019_AP_12            72738    256  284.1 ENABLED  BASIC
                   1                        14 LEDGER_2019_AP_CF             1998     32   62.4 ENABLED  BASIC
                   2 LEDGER_2020                                           509126   1792  284.1 ENABLED  BASIC
                   2                         1 LEDGER_2020_AP_BF            72848    256  284.6 ENABLED  BASIC
                   2                         2 LEDGER_2020_AP_01            72584    256  283.5 ENABLED  BASIC
                   2                         3 LEDGER_2020_AP_02            72388    256  282.8 ENABLED  BASIC
                   2                         4 LEDGER_2020_AP_03            72775    256  284.3 ENABLED  BASIC
                   2                         5 LEDGER_2020_AP_04            72544    256  283.4 ENABLED  BASIC
                   2                         6 LEDGER_2020_AP_05            72702    256  284.0 ENABLED  BASIC
                   2                         7 LEDGER_2020_AP_06            73285    256  286.3 ENABLED  BASIC
                   2                         8 LEDGER_2020_AP_07                0      0        ENABLED  BASIC
                   2                         9 LEDGER_2020_AP_08                0      0        ENABLED  BASIC
                   2                        10 LEDGER_2020_AP_09                0      0        ENABLED  BASIC
                   2                        11 LEDGER_2020_AP_10                0      0        ENABLED  BASIC
                   2                        12 LEDGER_2020_AP_11                0      0        ENABLED  BASIC
                   2                        13 LEDGER_2020_AP_12                0      0        ENABLED  BASIC
                   2                        14 LEDGER_2020_AP_CF                0      0        ENABLED  BASIC
                                                                          1456037   5152  282.6

PS_LEDGER          1 LEDGER_2018                                          1100000  17863   61.6 ENABLED  BASIC
                   1                         1 LEDGER_2018_AP_BF            84506   1370   61.7 ENABLED  BASIC
                   1                         2 LEDGER_2018_AP_01            84151   1366   61.6 ENABLED  BASIC
                   1                         3 LEDGER_2018_AP_02            85060   1380   61.6 ENABLED  BASIC
                   1                         4 LEDGER_2018_AP_03            84679   1374   61.6 ENABLED  BASIC
                   1                         5 LEDGER_2018_AP_04            84165   1366   61.6 ENABLED  BASIC
                   1                         6 LEDGER_2018_AP_05            84243   1366   61.7 ENABLED  BASIC
                   1                         7 LEDGER_2018_AP_06            84390   1370   61.6 ENABLED  BASIC
                   1                         8 LEDGER_2018_AP_07            84190   1366   61.6 ENABLED  BASIC
                   1                         9 LEDGER_2018_AP_08            84598   1372   61.7 ENABLED  BASIC
                   1                        10 LEDGER_2018_AP_09            84727   1374   61.7 ENABLED  BASIC
                   1                        11 LEDGER_2018_AP_10            84375   1369   61.6 ENABLED  BASIC
                   1                        12 LEDGER_2018_AP_11            84492   1370   61.7 ENABLED  BASIC
                   1                        13 LEDGER_2018_AP_12            84224   1367   61.6 ENABLED  BASIC
                   1                        14 LEDGER_2018_AP_CF             2200     53   41.5 ENABLED  BASIC
                   2 LEDGER_2019                                          1100000  17862   61.6 ENABLED  BASIC
                   2                         1 LEDGER_2019_AP_BF            84460   1370   61.6 ENABLED  BASIC
                   2                         2 LEDGER_2019_AP_01            84397   1369   61.6 ENABLED  BASIC
                   2                         3 LEDGER_2019_AP_02            84614   1372   61.7 ENABLED  BASIC
                   2                         4 LEDGER_2019_AP_03            84232   1367   61.6 ENABLED  BASIC
                   2                         5 LEDGER_2019_AP_04            84154   1365   61.7 ENABLED  BASIC
                   2                         6 LEDGER_2019_AP_05            84571   1373   61.6 ENABLED  BASIC
                   2                         7 LEDGER_2019_AP_06            84343   1369   61.6 ENABLED  BASIC
                   2                         8 LEDGER_2019_AP_07            84751   1375   61.6 ENABLED  BASIC
                   2                         9 LEDGER_2019_AP_08            84282   1367   61.7 ENABLED  BASIC
                   2                        10 LEDGER_2019_AP_09            84400   1370   61.6 ENABLED  BASIC
                   2                        11 LEDGER_2019_AP_10            84698   1373   61.7 ENABLED  BASIC
                   2                        12 LEDGER_2019_AP_11            84492   1370   61.7 ENABLED  BASIC
                   2                        13 LEDGER_2019_AP_12            84406   1369   61.7 ENABLED  BASIC
                   2                        14 LEDGER_2019_AP_CF             2200     53   41.5 ENABLED  BASIC
                   3 LEDGER_2020                                           637737  16785   38.0 NONE
                   3                         1 LEDGER_2020_AP_BF            84469   2188   38.6 DISABLED
                   3                         2 LEDGER_2020_AP_01            84352   2212   38.1 DISABLED
                   3                         3 LEDGER_2020_AP_02            84021   2204   38.1 DISABLED
                   3                         4 LEDGER_2020_AP_03            84298   2211   38.1 DISABLED
                   3                         5 LEDGER_2020_AP_04            84310   2211   38.1 DISABLED
                   3                         6 LEDGER_2020_AP_05            84763   2222   38.1 DISABLED
                   3                         7 LEDGER_2020_AP_06            85131   2232   38.1 DISABLED
                   3                         8 LEDGER_2020_AP_07             7832    217   36.1 DISABLED
                   3                         9 LEDGER_2020_AP_08             7669    213   36.0 DISABLED
                   3                        10 LEDGER_2020_AP_09             7710    213   36.2 DISABLED
                   3                        11 LEDGER_2020_AP_10             7628    212   36.0 DISABLED
                   3                        12 LEDGER_2020_AP_11             7607    211   36.1 DISABLED
                   3                        13 LEDGER_2020_AP_12             7747    215   36.0 DISABLED
                   3                        14 LEDGER_2020_AP_CF              200     24    8.3 DISABLED
                   4 LEDGER_2021                                           100000   2791   35.8 NONE
                   4                         1 LEDGER_2021_AP_BF             7607    209   36.4 DISABLED
                   4                         2 LEDGER_2021_AP_01             7603    211   36.0 DISABLED
                   4                         3 LEDGER_2021_AP_02             7676    213   36.0 DISABLED
                   4                         4 LEDGER_2021_AP_03             7760    215   36.1 DISABLED
                   4                         5 LEDGER_2021_AP_04             7745    215   36.0 DISABLED
                   4                         6 LEDGER_2021_AP_05             7578    211   35.9 DISABLED
                   4                         7 LEDGER_2021_AP_06             7645    212   36.1 DISABLED
                   4                         8 LEDGER_2021_AP_07             7561    210   36.0 DISABLED
                   4                         9 LEDGER_2021_AP_08             7748    215   36.0 DISABLED
                   4                        10 LEDGER_2021_AP_09             7559    210   36.0 DISABLED
                   4                        11 LEDGER_2021_AP_10             7658    213   36.0 DISABLED
                   4                        12 LEDGER_2021_AP_11             7775    215   36.2 DISABLED
                   4                        13 LEDGER_2021_AP_12             7885    218   36.2 DISABLED
                   4                        14 LEDGER_2021_AP_CF              200     24    8.3 DISABLED
                                                                          2937737  55301   53.1


92 rows selected.

Elapsed: 00:00:00.07
18:32:53 SQL> 
18:32:53 SQL> column extension format a40
18:32:53 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
18:32:53   2  from user_tab_col_statistics s
18:32:53   3  	LEFT OUTER JOIN user_stat_extensions e
18:32:53   4  	ON e.table_name = s.table_name
18:32:53   5  	AND e.extension_name = s.column_name
18:32:53   6  where s.table_name like 'MV_LEDGER%'
18:32:53   7  order by 1,2
18:32:53   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  ACCOUNT                  1000       1 NONE            18:32:18 18/11/2020
                ACCOUNTING_PERIOD          15       1 NONE            18:32:18 18/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       18:32:18 18/11/2020
                CHARTFIELD1               998       1 NONE            18:32:18 18/11/2020
                FISCAL_YEAR                 2       1 NONE            18:32:18 18/11/2020
                POSTED_TOTAL_AMT      1456037       1 NONE            18:32:18 18/11/2020
                SYS_NC00007$                2       1 NONE            18:32:18 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$             1000       1 NONE            18:32:18 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              998       1 NONE            18:32:18 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                2       1 NONE            18:32:18 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            18:32:18 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )



11 rows selected.

Elapsed: 00:00:00.21
18:32:53 SQL> column extension format a40
18:32:53 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
18:32:53   2  from user_part_col_statistics s
18:32:53   3  	LEFT OUTER JOIN user_stat_extensions e
18:32:53   4  	ON e.table_name = s.table_name
18:32:53   5  	AND e.extension_name = s.column_name
18:32:53   6  where s.table_name like 'MV_LEDGER%'
18:32:53   7  order by 1,2
18:32:53   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019          BUSINESS_UNIT               2       2 FREQUENCY       18:32:07 18/11/2020
                                     ACCOUNT                  1000       1 NONE            18:32:07 18/11/2020
                                     CHARTFIELD1               998       1 NONE            18:32:07 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            18:32:07 18/11/2020
                                     ACCOUNTING_PERIOD          15       1 NONE            18:32:07 18/11/2020
                                     POSTED_TOTAL_AMT       946911       1 NONE            18:32:07 18/11/2020
                                     SYS_NC00007$                2       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$             1000       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              998       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$               15       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                LEDGER_2020          BUSINESS_UNIT               2       2 FREQUENCY       18:32:15 18/11/2020
                                     ACCOUNT                   999       1 NONE            18:32:15 18/11/2020
                                     CHARTFIELD1               997       1 NONE            18:32:15 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            18:32:15 18/11/2020
                                     ACCOUNTING_PERIOD           7       1 NONE            18:32:15 18/11/2020
                                     POSTED_TOTAL_AMT       508128       1 NONE            18:32:15 18/11/2020
                                     SYS_NC00007$                2       1 NONE            18:32:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              999       1 NONE            18:32:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              997       1 NONE            18:32:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18:32:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                7       1 NONE            18:32:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )



22 rows selected.

Elapsed: 00:00:00.06
18:32:53 SQL> 
18:32:53 SQL> column extension format a40
18:32:53 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
18:32:53   2  from user_subpart_col_statistics s
18:32:53   3  	LEFT OUTER JOIN user_stat_extensions e
18:32:53   4  	ON e.table_name = s.table_name
18:32:53   5  	AND e.extension_name = s.column_name
18:32:53   6  where s.table_name like 'MV_LEDGER%'
18:32:53   7  order by 1,2
18:32:53   8  ;

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       18:31:56 18/11/2020
                LEDGER_2019_AP_01         ACCOUNT                   994       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_01         CHARTFIELD1               993       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_01         FISCAL_YEAR                 1       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_01         ACCOUNTING_PERIOD           1       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_01         POSTED_TOTAL_AMT        72670       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_01         SYS_NC00007$                2       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_01         SYS_NC00008$              994       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_01         SYS_NC00009$              993       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_01         SYS_NC00010$                1       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_01         SYS_NC00011$                1       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       18:32:02 18/11/2020
                LEDGER_2019_AP_02         ACCOUNT                   992       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_02         CHARTFIELD1               994       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_02         FISCAL_YEAR                 1       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_02         ACCOUNTING_PERIOD           1       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_02         POSTED_TOTAL_AMT        72792       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_02         SYS_NC00007$                2       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_02         SYS_NC00008$              992       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_02         SYS_NC00009$              994       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_02         SYS_NC00010$                1       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_02         SYS_NC00011$                1       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       18:32:02 18/11/2020
                LEDGER_2019_AP_03         ACCOUNT                   993       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_03         CHARTFIELD1               992       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_03         FISCAL_YEAR                 1       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_03         ACCOUNTING_PERIOD           1       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_03         POSTED_TOTAL_AMT        72461       1 NONE            18:32:02 18/11/2020
                LEDGER_2019_AP_03         SYS_NC00007$                2       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_03         SYS_NC00008$              993       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_03         SYS_NC00009$              992       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_03         SYS_NC00010$                1       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_03         SYS_NC00011$                1       1 NONE            18:32:02 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       18:32:01 18/11/2020
                LEDGER_2019_AP_04         ACCOUNT                   993       1 NONE            18:32:01 18/11/2020
                LEDGER_2019_AP_04         CHARTFIELD1               994       1 NONE            18:32:01 18/11/2020
                LEDGER_2019_AP_04         FISCAL_YEAR                 1       1 NONE            18:32:01 18/11/2020
                LEDGER_2019_AP_04         ACCOUNTING_PERIOD           1       1 NONE            18:32:01 18/11/2020
                LEDGER_2019_AP_04         POSTED_TOTAL_AMT        72547       1 NONE            18:32:01 18/11/2020
                LEDGER_2019_AP_04         SYS_NC00007$                2       1 NONE            18:32:01 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_04         SYS_NC00008$              993       1 NONE            18:32:01 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_04         SYS_NC00009$              994       1 NONE            18:32:01 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_04         SYS_NC00010$                1       1 NONE            18:32:01 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_04         SYS_NC00011$                1       1 NONE            18:32:01 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       18:32:00 18/11/2020
                LEDGER_2019_AP_05         ACCOUNT                   995       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_05         CHARTFIELD1               992       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_05         FISCAL_YEAR                 1       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_05         ACCOUNTING_PERIOD           1       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_05         POSTED_TOTAL_AMT        72882       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_05         SYS_NC00007$                2       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_05         SYS_NC00008$              995       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_05         SYS_NC00009$              992       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_05         SYS_NC00010$                1       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_05         SYS_NC00011$                1       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       18:32:00 18/11/2020
                LEDGER_2019_AP_06         ACCOUNT                   991       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_06         CHARTFIELD1               992       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_06         FISCAL_YEAR                 1       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_06         ACCOUNTING_PERIOD           1       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_06         POSTED_TOTAL_AMT        72144       1 NONE            18:32:00 18/11/2020
                LEDGER_2019_AP_06         SYS_NC00007$                2       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_06         SYS_NC00008$              991       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_06         SYS_NC00009$              992       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_06         SYS_NC00010$                1       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_06         SYS_NC00011$                1       1 NONE            18:32:00 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_07         BUSINESS_UNIT               2       2 FREQUENCY       18:31:59 18/11/2020
                LEDGER_2019_AP_07         ACCOUNT                   990       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_07         CHARTFIELD1               992       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_07         FISCAL_YEAR                 1       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_07         ACCOUNTING_PERIOD           1       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_07         POSTED_TOTAL_AMT        72794       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_07         SYS_NC00007$                2       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_07         SYS_NC00008$              990       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_07         SYS_NC00009$              992       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_07         SYS_NC00010$                1       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_07         SYS_NC00011$                1       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_08         BUSINESS_UNIT               2       2 FREQUENCY       18:31:59 18/11/2020
                LEDGER_2019_AP_08         ACCOUNT                   992       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_08         CHARTFIELD1               993       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_08         FISCAL_YEAR                 1       1 NONE            18:31:59 18/11/2020

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019_AP_08         ACCOUNTING_PERIOD           1       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_08         POSTED_TOTAL_AMT        72461       1 NONE            18:31:59 18/11/2020
                LEDGER_2019_AP_08         SYS_NC00007$                2       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_08         SYS_NC00008$              992       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_08         SYS_NC00009$              993       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_08         SYS_NC00010$                1       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_08         SYS_NC00011$                1       1 NONE            18:31:59 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_09         BUSINESS_UNIT               2       2 FREQUENCY       18:31:58 18/11/2020
                LEDGER_2019_AP_09         ACCOUNT                   992       1 NONE            18:31:58 18/11/2020
                LEDGER_2019_AP_09         CHARTFIELD1               995       1 NONE            18:31:58 18/11/2020
                LEDGER_2019_AP_09         FISCAL_YEAR                 1       1 NONE            18:31:58 18/11/2020
                LEDGER_2019_AP_09         ACCOUNTING_PERIOD           1       1 NONE            18:31:58 18/11/2020
                LEDGER_2019_AP_09         POSTED_TOTAL_AMT        72224       1 NONE            18:31:58 18/11/2020
                LEDGER_2019_AP_09         SYS_NC00007$                2       1 NONE            18:31:58 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_09         SYS_NC00008$              992       1 NONE            18:31:58 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_09         SYS_NC00009$              995       1 NONE            18:31:58 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_09         SYS_NC00010$                1       1 NONE            18:31:58 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_09         SYS_NC00011$                1       1 NONE            18:31:58 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_10         BUSINESS_UNIT               2       2 FREQUENCY       18:31:57 18/11/2020
                LEDGER_2019_AP_10         ACCOUNT                   991       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_10         CHARTFIELD1               993       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_10         FISCAL_YEAR                 1       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_10         ACCOUNTING_PERIOD           1       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_10         POSTED_TOTAL_AMT        72488       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_10         SYS_NC00007$                2       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_10         SYS_NC00008$              991       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_10         SYS_NC00009$              993       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_10         SYS_NC00010$                1       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_10         SYS_NC00011$                1       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_11         BUSINESS_UNIT               2       2 FREQUENCY       18:31:57 18/11/2020
                LEDGER_2019_AP_11         ACCOUNT                   994       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_11         CHARTFIELD1               992       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_11         FISCAL_YEAR                 1       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_11         ACCOUNTING_PERIOD           1       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_11         POSTED_TOTAL_AMT        71936       1 NONE            18:31:57 18/11/2020
                LEDGER_2019_AP_11         SYS_NC00007$                2       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_11         SYS_NC00008$              994       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_11         SYS_NC00009$              992       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_11         SYS_NC00010$                1       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_11         SYS_NC00011$                1       1 NONE            18:31:57 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_12         BUSINESS_UNIT               2       2 FREQUENCY       18:31:56 18/11/2020
                LEDGER_2019_AP_12         ACCOUNT                   991       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_12         CHARTFIELD1               993       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_12         FISCAL_YEAR                 1       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_12         ACCOUNTING_PERIOD           1       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_12         POSTED_TOTAL_AMT        72664       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_12         SYS_NC00007$                2       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_12         SYS_NC00008$              991       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_12         SYS_NC00009$              993       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_12         SYS_NC00010$                1       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_12         SYS_NC00011$                1       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       18:31:55 18/11/2020
                LEDGER_2019_AP_BF         ACCOUNT                   995       1 NONE            18:31:55 18/11/2020
                LEDGER_2019_AP_BF         CHARTFIELD1               995       1 NONE            18:31:55 18/11/2020
                LEDGER_2019_AP_BF         FISCAL_YEAR                 1       1 NONE            18:31:55 18/11/2020
                LEDGER_2019_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            18:31:55 18/11/2020
                LEDGER_2019_AP_BF         POSTED_TOTAL_AMT        72823       1 NONE            18:31:55 18/11/2020
                LEDGER_2019_AP_BF         SYS_NC00007$                2       1 NONE            18:31:55 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_BF         SYS_NC00008$              995       1 NONE            18:31:55 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_BF         SYS_NC00009$              995       1 NONE            18:31:55 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_BF         SYS_NC00010$                1       1 NONE            18:31:55 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_BF         SYS_NC00011$                1       1 NONE            18:31:55 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_CF         BUSINESS_UNIT               2       2 FREQUENCY       18:31:56 18/11/2020
                LEDGER_2019_AP_CF         ACCOUNT                   755       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_CF         CHARTFIELD1               741       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_CF         FISCAL_YEAR                 1       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_CF         ACCOUNTING_PERIOD           2       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_CF         POSTED_TOTAL_AMT         1998       1 NONE            18:31:56 18/11/2020
                LEDGER_2019_AP_CF         SYS_NC00007$                2       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_CF         SYS_NC00008$              755       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_CF         SYS_NC00009$              741       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_CF         SYS_NC00010$                1       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_CF         SYS_NC00011$                2       1 NONE            18:31:56 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       18:32:07 18/11/2020
                LEDGER_2020_AP_01         ACCOUNT                   994       1 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_01         CHARTFIELD1               994       1 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_01         FISCAL_YEAR                 1       1 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_01         ACCOUNTING_PERIOD           1       1 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_01         POSTED_TOTAL_AMT        72584       1 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_01         SYS_NC00007$                2       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_01         SYS_NC00008$              994       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2020_AP_01         SYS_NC00009$              994       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_01         SYS_NC00010$                1       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_01         SYS_NC00011$                1       1 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       18:32:06 18/11/2020
                LEDGER_2020_AP_02         ACCOUNT                   991       1 NONE            18:32:06 18/11/2020
                LEDGER_2020_AP_02         CHARTFIELD1               991       1 NONE            18:32:06 18/11/2020
                LEDGER_2020_AP_02         FISCAL_YEAR                 1       1 NONE            18:32:06 18/11/2020
                LEDGER_2020_AP_02         ACCOUNTING_PERIOD           1       1 NONE            18:32:06 18/11/2020
                LEDGER_2020_AP_02         POSTED_TOTAL_AMT        71864       1 NONE            18:32:06 18/11/2020
                LEDGER_2020_AP_02         SYS_NC00007$                2       1 NONE            18:32:06 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_02         SYS_NC00008$              991       1 NONE            18:32:06 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_02         SYS_NC00009$              991       1 NONE            18:32:06 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_02         SYS_NC00010$                1       1 NONE            18:32:06 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_02         SYS_NC00011$                1       1 NONE            18:32:06 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       18:32:05 18/11/2020
                LEDGER_2020_AP_03         ACCOUNT                   994       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_03         CHARTFIELD1               993       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_03         FISCAL_YEAR                 1       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_03         ACCOUNTING_PERIOD           1       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_03         POSTED_TOTAL_AMT        72296       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_03         SYS_NC00007$                2       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_03         SYS_NC00008$              994       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_03         SYS_NC00009$              993       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_03         SYS_NC00010$                1       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_03         SYS_NC00011$                1       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       18:32:05 18/11/2020
                LEDGER_2020_AP_04         ACCOUNT                   993       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_04         CHARTFIELD1               995       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_04         FISCAL_YEAR                 1       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_04         ACCOUNTING_PERIOD           1       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_04         POSTED_TOTAL_AMT        72544       1 NONE            18:32:05 18/11/2020
                LEDGER_2020_AP_04         SYS_NC00007$                2       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_04         SYS_NC00008$              993       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_04         SYS_NC00009$              995       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_04         SYS_NC00010$                1       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_04         SYS_NC00011$                1       1 NONE            18:32:05 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       18:32:04 18/11/2020
                LEDGER_2020_AP_05         ACCOUNT                   993       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_05         CHARTFIELD1               990       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_05         FISCAL_YEAR                 1       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_05         ACCOUNTING_PERIOD           1       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_05         POSTED_TOTAL_AMT        72702       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_05         SYS_NC00007$                2       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_05         SYS_NC00008$              993       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_05         SYS_NC00009$              990       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_05         SYS_NC00010$                1       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_05         SYS_NC00011$                1       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       18:32:04 18/11/2020
                LEDGER_2020_AP_06         ACCOUNT                   994       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_06         CHARTFIELD1               994       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_06         FISCAL_YEAR                 1       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_06         ACCOUNTING_PERIOD           1       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_06         POSTED_TOTAL_AMT        72456       1 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_06         SYS_NC00007$                2       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_06         SYS_NC00008$              994       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_06         SYS_NC00009$              994       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_06         SYS_NC00010$                1       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_06         SYS_NC00011$                1       1 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_07         BUSINESS_UNIT               0       0 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_07         ACCOUNT                     0       0 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_07         CHARTFIELD1                 0       0 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_07         FISCAL_YEAR                 0       0 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_07         ACCOUNTING_PERIOD           0       0 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_07         POSTED_TOTAL_AMT            0       0 NONE            18:32:07 18/11/2020
                LEDGER_2020_AP_07         SYS_NC00007$                0       0 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_07         SYS_NC00008$                0       0 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_07         SYS_NC00009$                0       0 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_07         SYS_NC00010$                0       0 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_07         SYS_NC00011$                0       0 NONE            18:32:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_08         BUSINESS_UNIT               0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_08         ACCOUNT                     0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_08         CHARTFIELD1                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_08         FISCAL_YEAR                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_08         ACCOUNTING_PERIOD           0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_08         POSTED_TOTAL_AMT            0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_08         SYS_NC00007$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_08         SYS_NC00008$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_08         SYS_NC00009$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_08         SYS_NC00010$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_08         SYS_NC00011$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------

MV_LEDGER_2020  LEDGER_2020_AP_09         BUSINESS_UNIT               0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_09         ACCOUNT                     0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_09         CHARTFIELD1                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_09         FISCAL_YEAR                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_09         ACCOUNTING_PERIOD           0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_09         POSTED_TOTAL_AMT            0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_09         SYS_NC00007$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_09         SYS_NC00008$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_09         SYS_NC00009$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_09         SYS_NC00010$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_09         SYS_NC00011$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_10         BUSINESS_UNIT               0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_10         ACCOUNT                     0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_10         CHARTFIELD1                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_10         FISCAL_YEAR                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_10         ACCOUNTING_PERIOD           0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_10         POSTED_TOTAL_AMT            0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_10         SYS_NC00007$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_10         SYS_NC00008$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_10         SYS_NC00009$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_10         SYS_NC00010$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_10         SYS_NC00011$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_11         BUSINESS_UNIT               0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_11         ACCOUNT                     0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_11         CHARTFIELD1                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_11         FISCAL_YEAR                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_11         ACCOUNTING_PERIOD           0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_11         POSTED_TOTAL_AMT            0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_11         SYS_NC00007$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_11         SYS_NC00008$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_11         SYS_NC00009$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_11         SYS_NC00010$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_11         SYS_NC00011$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_12         BUSINESS_UNIT               0       0 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_12         ACCOUNT                     0       0 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_12         CHARTFIELD1                 0       0 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_12         FISCAL_YEAR                 0       0 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_12         ACCOUNTING_PERIOD           0       0 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_12         POSTED_TOTAL_AMT            0       0 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_12         SYS_NC00007$                0       0 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_12         SYS_NC00008$                0       0 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_12         SYS_NC00009$                0       0 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_12         SYS_NC00010$                0       0 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_12         SYS_NC00011$                0       0 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       18:32:03 18/11/2020
                LEDGER_2020_AP_BF         ACCOUNT                   996       1 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_BF         CHARTFIELD1               994       1 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_BF         FISCAL_YEAR                 1       1 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_BF         POSTED_TOTAL_AMT        72744       1 NONE            18:32:03 18/11/2020
                LEDGER_2020_AP_BF         SYS_NC00007$                2       1 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_BF         SYS_NC00008$              996       1 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_BF         SYS_NC00009$              994       1 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_BF         SYS_NC00010$                1       1 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_BF         SYS_NC00011$                1       1 NONE            18:32:03 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_CF         BUSINESS_UNIT               0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_CF         ACCOUNT                     0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_CF         CHARTFIELD1                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_CF         FISCAL_YEAR                 0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_CF         ACCOUNTING_PERIOD           0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_CF         POSTED_TOTAL_AMT            0       0 NONE            18:32:04 18/11/2020
                LEDGER_2020_AP_CF         SYS_NC00007$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_CF         SYS_NC00008$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_CF         SYS_NC00009$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_CF         SYS_NC00010$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_CF         SYS_NC00011$                0       0 NONE            18:32:04 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )



308 rows selected.

Elapsed: 00:00:00.46
18:32:53 SQL> @@mvsql
18:32:53 SQL> REM mvsql.sql
18:32:53 SQL> set autotrace off
18:32:53 SQL> 
18:32:53 SQL> REM 2018
18:32:53 SQL> set lines 200 pages 999
18:32:53 SQL> explain plan for
18:32:53   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:32:53   3  FROM   PS_LEDGER A
18:32:53   4  ,      PSTREESELECT05 L1
18:32:53   5  ,      PSTREESELECT10 L
18:32:53   6  ,      PSTREESELECT10 L2
18:32:53   7  WHERE  A.LEDGER='ACTUALS'
18:32:53   8  AND    A.FISCAL_YEAR=2018
18:32:53   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
18:32:53  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:32:53  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:32:53  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:32:53  13  AND    A.CURRENCY_CD='GBP'
18:32:53  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:32:53  15  /

Explained.

Elapsed: 00:00:00.23
18:32:54 SQL> @@xp
18:32:54 SQL> REM xp.sql
18:32:54 SQL> REM spool xp
18:32:54 SQL> REM set pages 9999 lines 200 autotrace off
18:32:54 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3173647375

-----------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                   |   984 | 91512 |  2255   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY              |                   |   984 | 91512 |  2255   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                 |                   |   984 | 91512 |  2254   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN         | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                |                   |  3641 |   263K|  2252   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN    |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN       | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT            |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN      | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE  |                   | 39970 |  1756K|  2249   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST ITERATOR|                   | 39970 |  1756K|  2249   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       TABLE ACCESS FULL     | PS_LEDGER         | 39970 |  1756K|  2249   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."ACCOUNTING_PERIOD">=1 AND "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDA
        TA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA
        [L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.13
18:32:54 SQL> REM spool off
18:32:54 SQL> 
18:32:54 SQL> REM 2019
18:32:54 SQL> explain plan for
18:32:54   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:32:54   3  FROM   PS_LEDGER A
18:32:54   4  ,      PSTREESELECT05 L1
18:32:54   5  ,      PSTREESELECT10 L
18:32:54   6  ,      PSTREESELECT10 L2
18:32:54   7  WHERE  A.LEDGER='ACTUALS'
18:32:54   8  AND    A.FISCAL_YEAR=2019
18:32:54   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
18:32:54  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:32:54  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:32:54  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:32:54  13  AND    A.CURRENCY_CD='GBP'
18:32:54  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:32:54  15  /

Explained.

Elapsed: 00:00:00.26
18:32:54 SQL> @@xp
18:32:54 SQL> REM xp.sql
18:32:54 SQL> REM spool xp
18:32:54 SQL> REM set pages 9999 lines 200 autotrace off
18:32:54 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1400212726

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1694 |   133K|   436   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1694 |   133K|   436   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1694 |   133K|   435   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  6275 |   379K|   432   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 68815 |  2217K|   429   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST ITERATOR      |                   | 68815 |  2217K|   429   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 68815 |  2217K|   429   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."ACCOUNTING_PERIOD">=1 AND
              "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


85 rows selected.

Elapsed: 00:00:00.13
18:32:54 SQL> REM spool off
18:32:54 SQL> 
18:32:54 SQL> REM 2020
18:32:54 SQL> explain plan for
18:32:54   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:32:54   3  FROM   PS_LEDGER A
18:32:54   4  ,      PSTREESELECT05 L1
18:32:54   5  ,      PSTREESELECT10 L
18:32:54   6  ,      PSTREESELECT10 L2
18:32:54   7  WHERE  A.LEDGER='ACTUALS'
18:32:54   8  AND    A.FISCAL_YEAR=2020
18:32:54   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
18:32:54  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:32:54  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:32:54  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:32:54  13  AND    A.CURRENCY_CD='GBP'
18:32:54  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:32:54  15  /

Explained.

Elapsed: 00:00:00.38
18:32:55 SQL> @@xp
18:32:55 SQL> REM xp.sql
18:32:55 SQL> REM spool xp
18:32:55 SQL> REM set pages 9999 lines 200 autotrace off
18:32:55 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1400212726

-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   | 12260 |   969K|       |   664   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   | 12260 |   969K|  1128K|   664   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   | 12260 |   969K|       |   428   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   | 45363 |  2746K|       |   425   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   |   497K|    15M|       |   421   (1)| 00:00:01 |     2 |     2 |
|  10 |      PARTITION LIST ITERATOR      |                   |   497K|    15M|       |   421   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   497K|    15M|       |   421   (1)| 00:00:01 |    15 |    28 |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD">=1 AND "MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND
              "MV_LEDGER_2020"."FISCAL_YEAR"=2020)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


85 rows selected.

Elapsed: 00:00:00.25
18:32:55 SQL> REM spool off
18:32:55 SQL> 
18:32:55 SQL> explain plan for
18:32:55   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:32:55   3  FROM   PS_LEDGER A
18:32:55   4  ,      PSTREESELECT05 L1
18:32:55   5  ,      PSTREESELECT10 L
18:32:55   6  ,      PSTREESELECT10 L2
18:32:55   7  WHERE  A.LEDGER='ACTUALS'
18:32:55   8  AND    A.FISCAL_YEAR=2019
18:32:55   9  AND    A.ACCOUNTING_PERIOD = 7
18:32:55  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:32:55  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:32:55  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:32:55  13  AND    A.CURRENCY_CD='GBP'
18:32:55  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:32:55  15  /

Explained.

Elapsed: 00:00:00.57
18:32:55 SQL> @@xp
18:32:55 SQL> REM xp.sql
18:32:55 SQL> REM spool xp
18:32:55 SQL> REM set pages 9999 lines 200 autotrace off
18:32:55 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2992443773

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1821 |   144K|    77   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1821 |   144K|    77   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1821 |   144K|    76   (0)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  6678 |   404K|    74   (0)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 72794 |  2345K|    71   (0)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST SINGLE        |                   | 72794 |  2345K|    71   (0)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 72794 |  2345K|    71   (0)| 00:00:01 |     8 |     8 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.19
18:32:56 SQL> REM spool off
18:32:56 SQL> 
18:32:56 SQL> REM 2020
18:32:56 SQL> explain plan for
18:32:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:32:56   3  FROM   PS_LEDGER A
18:32:56   4  ,      PSTREESELECT05 L1
18:32:56   5  ,      PSTREESELECT10 L
18:32:56   6  ,      PSTREESELECT10 L2
18:32:56   7  WHERE  A.LEDGER='ACTUALS'
18:32:56   8  AND    A.FISCAL_YEAR=2020
18:32:56   9  AND    (A.ACCOUNTING_PERIOD = 7)
18:32:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:32:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:32:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:32:56  13  AND    A.CURRENCY_CD='GBP'
18:32:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:32:56  15  /

Explained.

Elapsed: 00:00:00.43
18:32:56 SQL> @@xp
18:32:56 SQL> REM xp.sql
18:32:56 SQL> REM spool xp
18:32:56 SQL> REM set pages 9999 lines 200 autotrace off
18:32:56 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1460904422

--------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
--------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                         |                   |     1 |   105 |     6  (17)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                           |                   |     1 |   105 |     6  (17)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                              |                   |     1 |   105 |     5   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                          |                   |     1 |   105 |     5   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                 |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                           |                   |     1 |    86 |     4   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                       |                   |     1 |    86 |     4   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR              |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                        |                   |     1 |    68 |     3   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                    |                   |     1 |    68 |     3   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR           |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE        |                   |     1 |    57 |     2   (0)| 00:00:01 |     2 |     2 |
|    12 |             PARTITION LIST SINGLE        |                   |     1 |    57 |     2   (0)| 00:00:01 |   KEY |   KEY |
|  * 13 |              MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |     1 |    57 |     2   (0)| 00:00:01 |    22 |    22 |
|  * 14 |           INDEX RANGE SCAN               | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 15 |          INDEX RANGE SCAN                | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 16 |        INDEX RANGE SCAN                  | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 17 |       INDEX RANGE SCAN                   | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 18 |     INDEX RANGE SCAN                     | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 19 |    INDEX RANGE SCAN                      | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
--------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
  13 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4
  14 - SEL$1E60250C / L1@SEL$1
  15 - SEL$1E60250C / L1@SEL$1
  16 - SEL$1E60250C / L@SEL$1
  17 - SEL$1E60250C / L@SEL$1
  18 - SEL$1E60250C / L2@SEL$1
  19 - SEL$1E60250C / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      USE_NL(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L1"@"SEL$1")
      LEADING(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("MV_LEDGER_2020"."FISCAL_YEAR"=2020)
  14 - access("L1"."SELECTOR_NUM"=30982 AND "MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  15 - access("L1"."SELECTOR_NUM"=30982)
  16 - access("L"."SELECTOR_NUM"=30985 AND "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
  17 - access("L"."SELECTOR_NUM"=30985)
  18 - access("L2"."SELECTOR_NUM"=30984 AND "MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
  19 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_
        2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s
        ></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]>
        </s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDAT
        A[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></
        h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v></
        o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><!
        [CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></f><
        /q>


104 rows selected.

Elapsed: 00:00:00.23
18:32:56 SQL> REM spool off
18:32:56 SQL> 
18:32:56 SQL> set autotrace off
18:32:56 SQL> 
18:32:56 SQL> @@pop2020m7
18:32:56 SQL> REM pop2020m7.sql
18:32:56 SQL> set autotrace off
18:32:56 SQL> insert into ps_ledger
18:32:56   2  with n as (
18:32:56   3  SELECT rownum n from dual connect by level <= 1e6/13
18:32:56   4  --), fy as (
18:32:56   5  --SELECT 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
18:32:56   6  --), ap as (
18:32:56   7  --SELECT FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
18:32:56   8  --UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
18:32:56   9  --UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
18:32:56  10  --), l as (
18:32:56  11  --SELECT 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
18:32:56  12  --UNION ALL SELECT 'BUDGET' FROM DUAL
18:32:56  13  )
18:32:56  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
18:32:56  15  ,      'ACTUALS' ledger
18:32:56  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
18:32:56  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
18:32:56  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
18:32:56  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
18:32:56  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
18:32:56  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
18:32:56  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
18:32:56  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
18:32:56  24  ,      ' ' budget_ref
18:32:56  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
18:32:56  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
18:32:56  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
18:32:56  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
18:32:56  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
18:32:56  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
18:32:56  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
18:32:56  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
18:32:56  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
18:32:56  34  ,      'GBP' currency_cd
18:32:56  35  ,      ' ' statistics_code
18:32:56  36  ,      2020 fiscal_year
18:32:56  37  ,      7 accounting_period
18:32:56  38  ,      dbms_random.value(0,1e6) posted_total_amt
18:32:56  39  ,      0 posted_base_amt
18:32:56  40  ,      0 posted_tran_amt
18:32:56  41  ,      'GBP' base_currency
18:32:56  42  ,      SYSDATE dttm_stamp_sec
18:32:56  43  ,      0 process_instance
18:32:56  44  FROM   n
18:32:56  45  --WHERE  l.ledger = 'ACTUALS'
18:32:56  46  --AND    fy.fiscal_year = 2020
18:32:56  47  --AND    ap.accounting_period = 7
18:32:56  48  /

76923 rows created.

Elapsed: 00:00:52.81
18:33:49 SQL> set lines 200 pages 999 autotrace off
18:33:49 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
18:33:49 SQL> commit;

Commit complete.

Elapsed: 00:00:00.04
18:33:49 SQL> column owner format a10
18:33:49 SQL> column table_name format a15
18:33:49 SQL> column mview_name format a15
18:33:49 SQL> column detailobj_owner format a10 heading 'Detailobj|Owner'
18:33:49 SQL> column detailobj_name  format a15
18:33:49 SQL> column detailobj_alias format a20
18:33:49 SQL> column detail_partition_name format a20
18:33:49 SQL> column detail_subpartition_name format a20
18:33:49 SQL> column parent_table_partition format a20
18:33:49 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME      STALENESS           LAST_REF COMPILE_STATE
--------------- ------------------- -------- -------------------
MV_LEDGER_2020  NEEDS_COMPILE       COMPLETE NEEDS_COMPILE

Elapsed: 00:00:00.00
18:33:49 SQL> select * from user_mview_detail_relations;

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAILOBJ DETAILOBJ_ALIAS      D NUM_FRESH_PCT_PARTITIONS NUM_STALE_PCT_PARTITIONS
---------- --------------- ---------- --------------- --------- -------------------- - ------------------------ ------------------------
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       TABLE     PS_LEDGER            Y                       55                        1

Elapsed: 00:00:06.67
18:33:56 SQL> select * from user_mview_detail_partition;

no rows selected

Elapsed: 00:00:00.27
18:33:56 SQL> select * from user_mview_detail_subpartition where freshness != 'FRESH';

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAIL_PARTITION_NAM DETAIL_SUBPARTITION_ DETAIL_SUBPARTITION_POSITION FRESH
---------- --------------- ---------- --------------- -------------------- -------------------- ---------------------------- -----
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       LEDGER_2020          LEDGER_2020_AP_07                               8 STALE

Elapsed: 00:00:00.00
18:33:56 SQL> 
18:33:56 SQL> @@mvsql
18:33:56 SQL> REM mvsql.sql
18:33:56 SQL> set autotrace off
18:33:56 SQL> 
18:33:56 SQL> REM 2018
18:33:56 SQL> set lines 200 pages 999
18:33:56 SQL> explain plan for
18:33:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:33:56   3  FROM   PS_LEDGER A
18:33:56   4  ,      PSTREESELECT05 L1
18:33:56   5  ,      PSTREESELECT10 L
18:33:56   6  ,      PSTREESELECT10 L2
18:33:56   7  WHERE  A.LEDGER='ACTUALS'
18:33:56   8  AND    A.FISCAL_YEAR=2018
18:33:56   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
18:33:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:33:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:33:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:33:56  13  AND    A.CURRENCY_CD='GBP'
18:33:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:33:56  15  /

Explained.

Elapsed: 00:00:00.21
18:33:56 SQL> @@xp
18:33:56 SQL> REM xp.sql
18:33:56 SQL> REM spool xp
18:33:56 SQL> REM set pages 9999 lines 200 autotrace off
18:33:56 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3173647375

-----------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                   |   984 | 91512 |  2255   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY              |                   |   984 | 91512 |  2255   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                 |                   |   984 | 91512 |  2254   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN         | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                |                   |  3641 |   263K|  2252   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN    |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN       | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT            |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN      | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE  |                   | 39970 |  1756K|  2249   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST ITERATOR|                   | 39970 |  1756K|  2249   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       TABLE ACCESS FULL     | PS_LEDGER         | 39970 |  1756K|  2249   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."ACCOUNTING_PERIOD">=1 AND "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDA
        TA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA
        [L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.15
18:33:56 SQL> REM spool off
18:33:56 SQL> 
18:33:56 SQL> REM 2019
18:33:56 SQL> explain plan for
18:33:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:33:56   3  FROM   PS_LEDGER A
18:33:56   4  ,      PSTREESELECT05 L1
18:33:56   5  ,      PSTREESELECT10 L
18:33:56   6  ,      PSTREESELECT10 L2
18:33:56   7  WHERE  A.LEDGER='ACTUALS'
18:33:56   8  AND    A.FISCAL_YEAR=2019
18:33:56   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
18:33:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:33:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:33:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:33:56  13  AND    A.CURRENCY_CD='GBP'
18:33:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:33:56  15  /

Explained.

Elapsed: 00:00:00.33
18:33:57 SQL> @@xp
18:33:57 SQL> REM xp.sql
18:33:57 SQL> REM spool xp
18:33:57 SQL> REM set pages 9999 lines 200 autotrace off
18:33:57 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1400212726

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1694 |   133K|   436   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1694 |   133K|   436   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1694 |   133K|   435   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  6275 |   379K|   432   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 68815 |  2217K|   429   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST ITERATOR      |                   | 68815 |  2217K|   429   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 68815 |  2217K|   429   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."ACCOUNTING_PERIOD">=1 AND
              "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


85 rows selected.

Elapsed: 00:00:00.16
18:33:57 SQL> REM spool off
18:33:57 SQL> 
18:33:57 SQL> REM 2020
18:33:57 SQL> explain plan for
18:33:57   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:33:57   3  FROM   PS_LEDGER A
18:33:57   4  ,      PSTREESELECT05 L1
18:33:57   5  ,      PSTREESELECT10 L
18:33:57   6  ,      PSTREESELECT10 L2
18:33:57   7  WHERE  A.LEDGER='ACTUALS'
18:33:57   8  AND    A.FISCAL_YEAR=2020
18:33:57   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
18:33:57  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:33:57  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:33:57  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:33:57  13  AND    A.CURRENCY_CD='GBP'
18:33:57  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:33:57  15  /

Explained.

Elapsed: 00:00:00.30
18:33:57 SQL> @@xp
18:33:57 SQL> REM xp.sql
18:33:57 SQL> REM spool xp
18:33:57 SQL> REM set pages 9999 lines 200 autotrace off
18:33:57 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1400212726

-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   | 12260 |   969K|       |   664   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   | 12260 |   969K|  1128K|   664   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   | 12260 |   969K|       |   428   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   | 45363 |  2746K|       |   425   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   |   497K|    15M|       |   421   (1)| 00:00:01 |     2 |     2 |
|  10 |      PARTITION LIST ITERATOR      |                   |   497K|    15M|       |   421   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   497K|    15M|       |   421   (1)| 00:00:01 |    15 |    28 |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD">=1 AND "MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND
              "MV_LEDGER_2020"."FISCAL_YEAR"=2020)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


85 rows selected.

Elapsed: 00:00:00.15
18:33:57 SQL> REM spool off
18:33:57 SQL> 
18:33:57 SQL> explain plan for
18:33:57   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:33:57   3  FROM   PS_LEDGER A
18:33:57   4  ,      PSTREESELECT05 L1
18:33:57   5  ,      PSTREESELECT10 L
18:33:57   6  ,      PSTREESELECT10 L2
18:33:57   7  WHERE  A.LEDGER='ACTUALS'
18:33:57   8  AND    A.FISCAL_YEAR=2019
18:33:57   9  AND    A.ACCOUNTING_PERIOD = 7
18:33:57  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:33:57  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:33:57  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:33:57  13  AND    A.CURRENCY_CD='GBP'
18:33:57  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:33:57  15  /

Explained.

Elapsed: 00:00:00.28
18:33:58 SQL> @@xp
18:33:58 SQL> REM xp.sql
18:33:58 SQL> REM spool xp
18:33:58 SQL> REM set pages 9999 lines 200 autotrace off
18:33:58 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2992443773

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1821 |   144K|    77   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1821 |   144K|    77   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1821 |   144K|    76   (0)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  6678 |   404K|    74   (0)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 72794 |  2345K|    71   (0)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST SINGLE        |                   | 72794 |  2345K|    71   (0)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 72794 |  2345K|    71   (0)| 00:00:01 |     8 |     8 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.15
18:33:58 SQL> REM spool off
18:33:58 SQL> 
18:33:58 SQL> REM 2020
18:33:58 SQL> explain plan for
18:33:58   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:33:58   3  FROM   PS_LEDGER A
18:33:58   4  ,      PSTREESELECT05 L1
18:33:58   5  ,      PSTREESELECT10 L
18:33:58   6  ,      PSTREESELECT10 L2
18:33:58   7  WHERE  A.LEDGER='ACTUALS'
18:33:58   8  AND    A.FISCAL_YEAR=2020
18:33:58   9  AND    (A.ACCOUNTING_PERIOD = 7)
18:33:58  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:33:58  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:33:58  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:33:58  13  AND    A.CURRENCY_CD='GBP'
18:33:58  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:33:58  15  /

Explained.

Elapsed: 00:00:00.16
18:33:58 SQL> @@xp
18:33:58 SQL> REM xp.sql
18:33:58 SQL> REM spool xp
18:33:58 SQL> REM set pages 9999 lines 200 autotrace off
18:33:58 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3964652976

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|    12 |             PARTITION LIST SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |   KEY |   KEY |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    36 |    36 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    36 |    36 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.21
18:33:58 SQL> REM spool off
18:33:58 SQL> 
18:33:58 SQL> set autotrace off
18:33:58 SQL> 
18:33:58 SQL> @@mvtrc
18:33:58 SQL> REM mvtrc.sql
18:33:58 SQL> disconnect
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.9.0.0.0
18:33:58 SQL> connect scott/tiger@oracle_pdb
Connected.
18:33:58 SQL> 
18:33:58 SQL> column name format a20
18:33:58 SQL> column value format a70
18:33:58 SQL> select * from v$diag_info where name like '%Trace%';

   INST_ID NAME                 VALUE                                                                      CON_ID
---------- -------------------- ---------------------------------------------------------------------- ----------
         1 Diag Trace           /u01/app/oracle/diag/rdbms/oracle/oracle/trace                                  0
         1 Default Trace File   /u01/app/oracle/diag/rdbms/oracle/oracle/trace/oracle_ora_15235.trc             0

Elapsed: 00:00:00.00
18:33:58 SQL> 
18:33:58 SQL> alter session set tracefile_identifier=PCT;

Session altered.

Elapsed: 00:00:00.00
18:33:58 SQL> alter session set sql_trace = true;

Session altered.

Elapsed: 00:00:00.00
18:33:58 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
BEGIN dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE); END;

*
ERROR at line 1:
ORA-20000: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3020
ORA-06512: at "SYS.DBMS_IREFRESH", line 186
ORA-06512: at "SYS.DBMS_ISNAPSHOT", line 189
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 2852
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3263
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3295
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 16
ORA-06512: at line 1


Elapsed: 00:00:00.02
18:33:58 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:28.40
18:34:27 SQL> alter session set sql_trace = false;

Session altered.

Elapsed: 00:00:00.00
18:34:27 SQL> 
18:34:27 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
BEGIN dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE); END;

*
ERROR at line 1:
ORA-20000: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3020
ORA-06512: at "SYS.DBMS_IREFRESH", line 186
ORA-06512: at "SYS.DBMS_ISNAPSHOT", line 189
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 2852
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3263
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3295
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 16
ORA-06512: at line 1


Elapsed: 00:00:00.00
18:34:27 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.24
18:34:27 SQL> 
18:34:27 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2019');
BEGIN dbms_stats.gather_Table_stats(user,'MV_LEDGER_2019'); END;

*
ERROR at line 1:
ORA-20000: Unable to analyze TABLE "SCOTT"."MV_LEDGER_2019", insufficient privileges or does not exist
ORA-06512: at "SYS.DBMS_STATS", line 40753
ORA-06512: at "SYS.DBMS_STATS", line 40026
ORA-06512: at "SYS.DBMS_STATS", line 40185
ORA-06512: at "SYS.DBMS_STATS", line 40734
ORA-06512: at line 1


Elapsed: 00:00:00.02
18:34:27 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:55.40
18:35:22 SQL> 
18:35:22 SQL> @@mvvol
18:35:22 SQL> REM mvvol.sql
18:35:22 SQL> 
18:35:22 SQL> set autotrace off
18:35:22 SQL> break on table_name skip 1 on partition_name
18:35:22 SQL> column table_name format a15
18:35:22 SQL> column column_name format a20
18:35:22 SQL> column mview_name format a20
18:35:22 SQL> column partition_position format 999 heading 'Part|Pos'
18:35:22 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
18:35:22 SQL> column partition_name format a20
18:35:22 SQL> column subpartition_name format a25
18:35:22 SQL> column num_rows format 9999999
18:35:22 SQL> column num_distinct heading 'Num|Distinct' format 9999999
18:35:22 SQL> column num_buckets heading 'Num|Buckets'	format 9999
18:35:22 SQL> column blocks format 99999
18:35:22 SQL> column rpb format 999.9 heading 'Rows|per|Block'
18:35:22 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               FAST_PCT VALID

Elapsed: 00:00:00.00
18:35:22 SQL> 
18:35:22 SQL> select count(*) from mv_ledger_2019;
select count(*) from mv_ledger_2019
                     *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:35:22 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
   1528838

Elapsed: 00:00:00.09
18:35:23 SQL> 
18:35:23 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
18:35:23   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
18:35:23   3  , COALESCE(c.compression, b.compression) compression
18:35:23   4  , COALESCE(c.compress_for, b.compress_for) compress_for
18:35:23   5  from user_tab_statistics a
18:35:23   6  	LEFT OUTER JOIN user_tab_partitions b
18:35:23   7  	  ON a.table_name = b.table_name
18:35:23   8  	  AND a.partition_name = b.partition_name
18:35:23   9  	LEFT OUTER JOIN user_tab_subpartitions c
18:35:23  10  	  ON a.table_name = c.table_name
18:35:23  11  	  AND a.partition_name = c.partition_name
18:35:23  12  	  AND a.subpartition_name = c.subpartition_name
18:35:23  13  where a.table_name like '%LEDGER%'
18:35:23  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
18:35:23  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2020     1 LEDGER_2019                                           946911   3360  281.8 ENABLED  BASIC
                   1                         1 LEDGER_2019_AP_BF            72823    256  284.5 ENABLED  BASIC
                   1                         2 LEDGER_2019_AP_01            72670    256  283.9 ENABLED  BASIC
                   1                         3 LEDGER_2019_AP_02            72813    256  284.4 ENABLED  BASIC
                   1                         4 LEDGER_2019_AP_03            72461    256  283.1 ENABLED  BASIC
                   1                         5 LEDGER_2019_AP_04            72547    256  283.4 ENABLED  BASIC
                   1                         6 LEDGER_2019_AP_05            72882    256  284.7 ENABLED  BASIC
                   1                         7 LEDGER_2019_AP_06            72566    256  283.5 ENABLED  BASIC
                   1                         8 LEDGER_2019_AP_07            72794    256  284.4 ENABLED  BASIC
                   1                         9 LEDGER_2019_AP_08            72461    256  283.1 ENABLED  BASIC
                   1                        10 LEDGER_2019_AP_09            72653    256  283.8 ENABLED  BASIC
                   1                        11 LEDGER_2019_AP_10            72818    256  284.4 ENABLED  BASIC
                   1                        12 LEDGER_2019_AP_11            72687    256  283.9 ENABLED  BASIC
                   1                        13 LEDGER_2019_AP_12            72738    256  284.1 ENABLED  BASIC
                   1                        14 LEDGER_2019_AP_CF             1998     32   62.4 ENABLED  BASIC
                   2 LEDGER_2020                                           581927   2018  288.4 ENABLED  BASIC
                   2                         1 LEDGER_2020_AP_BF            72848    253  287.9 ENABLED  BASIC
                   2                         2 LEDGER_2020_AP_01            72584    252  288.0 ENABLED  BASIC
                   2                         3 LEDGER_2020_AP_02            72388    251  288.4 ENABLED  BASIC
                   2                         4 LEDGER_2020_AP_03            72775    252  288.8 ENABLED  BASIC
                   2                         5 LEDGER_2020_AP_04            72544    252  287.9 ENABLED  BASIC
                   2                         6 LEDGER_2020_AP_05            72702    252  288.5 ENABLED  BASIC
                   2                         7 LEDGER_2020_AP_06            73285    254  288.5 ENABLED  BASIC
                   2                         8 LEDGER_2020_AP_07            72801    252  288.9 ENABLED  BASIC
                   2                         9 LEDGER_2020_AP_08                0      0        ENABLED  BASIC
                   2                        10 LEDGER_2020_AP_09                0      0        ENABLED  BASIC
                   2                        11 LEDGER_2020_AP_10                0      0        ENABLED  BASIC
                   2                        12 LEDGER_2020_AP_11                0      0        ENABLED  BASIC
                   2                        13 LEDGER_2020_AP_12                0      0        ENABLED  BASIC
                   2                        14 LEDGER_2020_AP_CF                0      0        ENABLED  BASIC
                                                                          1528838   5378  284.3

PS_LEDGER          1 LEDGER_2018                                          1100000  17863   61.6 ENABLED  BASIC
                   1                         1 LEDGER_2018_AP_BF            84506   1370   61.7 ENABLED  BASIC
                   1                         2 LEDGER_2018_AP_01            84151   1366   61.6 ENABLED  BASIC
                   1                         3 LEDGER_2018_AP_02            85060   1380   61.6 ENABLED  BASIC
                   1                         4 LEDGER_2018_AP_03            84679   1374   61.6 ENABLED  BASIC
                   1                         5 LEDGER_2018_AP_04            84165   1366   61.6 ENABLED  BASIC
                   1                         6 LEDGER_2018_AP_05            84243   1366   61.7 ENABLED  BASIC
                   1                         7 LEDGER_2018_AP_06            84390   1370   61.6 ENABLED  BASIC
                   1                         8 LEDGER_2018_AP_07            84190   1366   61.6 ENABLED  BASIC
                   1                         9 LEDGER_2018_AP_08            84598   1372   61.7 ENABLED  BASIC
                   1                        10 LEDGER_2018_AP_09            84727   1374   61.7 ENABLED  BASIC
                   1                        11 LEDGER_2018_AP_10            84375   1369   61.6 ENABLED  BASIC
                   1                        12 LEDGER_2018_AP_11            84492   1370   61.7 ENABLED  BASIC
                   1                        13 LEDGER_2018_AP_12            84224   1367   61.6 ENABLED  BASIC
                   1                        14 LEDGER_2018_AP_CF             2200     53   41.5 ENABLED  BASIC
                   2 LEDGER_2019                                          1100000  17862   61.6 ENABLED  BASIC
                   2                         1 LEDGER_2019_AP_BF            84460   1370   61.6 ENABLED  BASIC
                   2                         2 LEDGER_2019_AP_01            84397   1369   61.6 ENABLED  BASIC
                   2                         3 LEDGER_2019_AP_02            84614   1372   61.7 ENABLED  BASIC
                   2                         4 LEDGER_2019_AP_03            84232   1367   61.6 ENABLED  BASIC
                   2                         5 LEDGER_2019_AP_04            84154   1365   61.7 ENABLED  BASIC
                   2                         6 LEDGER_2019_AP_05            84571   1373   61.6 ENABLED  BASIC
                   2                         7 LEDGER_2019_AP_06            84343   1369   61.6 ENABLED  BASIC
                   2                         8 LEDGER_2019_AP_07            84751   1375   61.6 ENABLED  BASIC
                   2                         9 LEDGER_2019_AP_08            84282   1367   61.7 ENABLED  BASIC
                   2                        10 LEDGER_2019_AP_09            84400   1370   61.6 ENABLED  BASIC
                   2                        11 LEDGER_2019_AP_10            84698   1373   61.7 ENABLED  BASIC
                   2                        12 LEDGER_2019_AP_11            84492   1370   61.7 ENABLED  BASIC
                   2                        13 LEDGER_2019_AP_12            84406   1369   61.7 ENABLED  BASIC
                   2                        14 LEDGER_2019_AP_CF             2200     53   41.5 ENABLED  BASIC
                   3 LEDGER_2020                                           637737  16785   38.0 NONE
                   3                         1 LEDGER_2020_AP_BF            84469   2188   38.6 DISABLED
                   3                         2 LEDGER_2020_AP_01            84352   2212   38.1 DISABLED
                   3                         3 LEDGER_2020_AP_02            84021   2204   38.1 DISABLED
                   3                         4 LEDGER_2020_AP_03            84298   2211   38.1 DISABLED
                   3                         5 LEDGER_2020_AP_04            84310   2211   38.1 DISABLED
                   3                         6 LEDGER_2020_AP_05            84763   2222   38.1 DISABLED
                   3                         7 LEDGER_2020_AP_06            85131   2232   38.1 DISABLED
                   3                         8 LEDGER_2020_AP_07             7832    217   36.1 DISABLED
                   3                         9 LEDGER_2020_AP_08             7669    213   36.0 DISABLED
                   3                        10 LEDGER_2020_AP_09             7710    213   36.2 DISABLED
                   3                        11 LEDGER_2020_AP_10             7628    212   36.0 DISABLED
                   3                        12 LEDGER_2020_AP_11             7607    211   36.1 DISABLED
                   3                        13 LEDGER_2020_AP_12             7747    215   36.0 DISABLED
                   3                        14 LEDGER_2020_AP_CF              200     24    8.3 DISABLED
                   4 LEDGER_2021                                           100000   2791   35.8 NONE
                   4                         1 LEDGER_2021_AP_BF             7607    209   36.4 DISABLED
                   4                         2 LEDGER_2021_AP_01             7603    211   36.0 DISABLED
                   4                         3 LEDGER_2021_AP_02             7676    213   36.0 DISABLED
                   4                         4 LEDGER_2021_AP_03             7760    215   36.1 DISABLED
                   4                         5 LEDGER_2021_AP_04             7745    215   36.0 DISABLED
                   4                         6 LEDGER_2021_AP_05             7578    211   35.9 DISABLED
                   4                         7 LEDGER_2021_AP_06             7645    212   36.1 DISABLED
                   4                         8 LEDGER_2021_AP_07             7561    210   36.0 DISABLED
                   4                         9 LEDGER_2021_AP_08             7748    215   36.0 DISABLED
                   4                        10 LEDGER_2021_AP_09             7559    210   36.0 DISABLED
                   4                        11 LEDGER_2021_AP_10             7658    213   36.0 DISABLED
                   4                        12 LEDGER_2021_AP_11             7775    215   36.2 DISABLED
                   4                        13 LEDGER_2021_AP_12             7885    218   36.2 DISABLED
                   4                        14 LEDGER_2021_AP_CF              200     24    8.3 DISABLED
                                                                          2937737  55301   53.1


92 rows selected.

Elapsed: 00:00:00.05
18:35:23 SQL> 
18:35:23 SQL> column extension format a40
18:35:23 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
18:35:23   2  from user_tab_col_statistics s
18:35:23   3  	LEFT OUTER JOIN user_stat_extensions e
18:35:23   4  	ON e.table_name = s.table_name
18:35:23   5  	AND e.extension_name = s.column_name
18:35:23   6  where s.table_name like 'MV_LEDGER%'
18:35:23   7  order by 1,2
18:35:23   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2020  ACCOUNT                  1000       1 NONE            18-NOV-20
                ACCOUNTING_PERIOD          15       1 NONE            18-NOV-20
                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                CHARTFIELD1               998       1 NONE            18-NOV-20
                FISCAL_YEAR                 2       1 NONE            18-NOV-20
                POSTED_TOTAL_AMT      1528838       1 NONE            18-NOV-20
                SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$             1000       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              998       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                )



11 rows selected.

Elapsed: 00:00:00.02
18:35:23 SQL> column extension format a40
18:35:23 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
18:35:23   2  from user_part_col_statistics s
18:35:23   3  	LEFT OUTER JOIN user_stat_extensions e
18:35:23   4  	ON e.table_name = s.table_name
18:35:23   5  	AND e.extension_name = s.column_name
18:35:23   6  where s.table_name like 'MV_LEDGER%'
18:35:23   7  order by 1,2
18:35:23   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019          BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                  1000       1 NONE            18-NOV-20
                                     CHARTFIELD1               998       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD          15       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT       946911       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$             1000       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              998       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$               15       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                LEDGER_2020          BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   999       1 NONE            18-NOV-20
                                     CHARTFIELD1               997       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           8       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT       580544       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              997       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                8       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )



22 rows selected.

Elapsed: 00:00:00.03
18:35:23 SQL> 
18:35:23 SQL> column extension format a40
18:35:23 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
18:35:23   2  from user_subpart_col_statistics s
18:35:23   3  	LEFT OUTER JOIN user_stat_extensions e
18:35:23   4  	ON e.table_name = s.table_name
18:35:23   5  	AND e.extension_name = s.column_name
18:35:23   6  where s.table_name like 'MV_LEDGER%'
18:35:23   7  order by 1,2
18:35:23   8  ;

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_01         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         POSTED_TOTAL_AMT        72670       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_01         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_01         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_01         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_01         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_02         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         POSTED_TOTAL_AMT        72792       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_02         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_02         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_02         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_02         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_03         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         POSTED_TOTAL_AMT        72461       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_03         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_03         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_03         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_03         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_04         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         POSTED_TOTAL_AMT        72547       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_04         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_04         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_04         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_04         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_05         ACCOUNT                   995       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         POSTED_TOTAL_AMT        72882       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_05         SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_05         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_05         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_05         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_06         ACCOUNT                   991       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         POSTED_TOTAL_AMT        72144       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_06         SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_06         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_06         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_06         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_07         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_07         ACCOUNT                   990       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         POSTED_TOTAL_AMT        72794       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_07         SYS_NC00008$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_07         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_07         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_07         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_08         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_08         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         POSTED_TOTAL_AMT        72461       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_08         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_08         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_08         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_08         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_09         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_09         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         CHARTFIELD1               995       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         POSTED_TOTAL_AMT        72224       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_09         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_09         SYS_NC00009$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_09         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_09         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_10         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_10         ACCOUNT                   991       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         POSTED_TOTAL_AMT        72488       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_10         SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_10         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_10         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_10         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_11         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_11         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         POSTED_TOTAL_AMT        71936       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_11         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_11         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_11         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_11         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_12         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_12         ACCOUNT                   991       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         POSTED_TOTAL_AMT        72664       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_12         SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_12         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_12         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_12         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_BF         ACCOUNT                   995       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         CHARTFIELD1               995       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         POSTED_TOTAL_AMT        72823       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_BF         SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_BF         SYS_NC00009$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_BF         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_BF         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_CF         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_CF         ACCOUNT                   755       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         CHARTFIELD1               741       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         ACCOUNTING_PERIOD           2       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         POSTED_TOTAL_AMT         1998       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_CF         SYS_NC00008$              755       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_CF         SYS_NC00009$              741       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_CF         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_CF         SYS_NC00011$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_01         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         POSTED_TOTAL_AMT        72584       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_01         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_01         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_01         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_01         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_02         ACCOUNT                   991       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         CHARTFIELD1               991       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         POSTED_TOTAL_AMT        71864       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_02         SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_02         SYS_NC00009$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_02         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_02         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_03         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         POSTED_TOTAL_AMT        72296       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_03         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_03         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_03         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_03         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_04         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         CHARTFIELD1               995       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         POSTED_TOTAL_AMT        72544       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_04         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_04         SYS_NC00009$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_04         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_04         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_05         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         CHARTFIELD1               990       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         POSTED_TOTAL_AMT        72702       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_05         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_05         SYS_NC00009$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_05         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_05         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_06         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         POSTED_TOTAL_AMT        72456       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_06         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_06         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_06         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_06         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_07         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_07         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         POSTED_TOTAL_AMT        72801       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_07         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_07         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_07         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_07         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_08         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_08         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_08         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_08         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_08         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_09         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_09         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_09         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_09         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_09         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_10         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_10         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_10         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_10         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_10         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_11         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_11         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_11         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_11         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_11         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_12         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_12         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_12         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_12         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_12         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_BF         ACCOUNT                   996       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         POSTED_TOTAL_AMT        72744       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_BF         SYS_NC00008$              996       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_BF         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_BF         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_BF         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_CF         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_CF         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_CF         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_CF         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_CF         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )



308 rows selected.

Elapsed: 00:00:00.33
18:35:23 SQL> @@mvsql
18:35:23 SQL> REM mvsql.sql
18:35:23 SQL> set autotrace off
18:35:23 SQL> 
18:35:23 SQL> REM 2018
18:35:23 SQL> set lines 200 pages 999
18:35:23 SQL> explain plan for
18:35:23   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:35:23   3  FROM   PS_LEDGER A
18:35:23   4  ,      PSTREESELECT05 L1
18:35:23   5  ,      PSTREESELECT10 L
18:35:23   6  ,      PSTREESELECT10 L2
18:35:23   7  WHERE  A.LEDGER='ACTUALS'
18:35:23   8  AND    A.FISCAL_YEAR=2018
18:35:23   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
18:35:23  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:35:23  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:35:23  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:35:23  13  AND    A.CURRENCY_CD='GBP'
18:35:23  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:35:23  15  /

Explained.

Elapsed: 00:00:00.17
18:35:23 SQL> @@xp
18:35:23 SQL> REM xp.sql
18:35:23 SQL> REM spool xp
18:35:23 SQL> REM set pages 9999 lines 200 autotrace off
18:35:23 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3173647375

-----------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                   |   984 | 91512 |  2255   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY              |                   |   984 | 91512 |  2255   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                 |                   |   984 | 91512 |  2254   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN         | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                |                   |  3641 |   263K|  2252   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN    |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN       | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT            |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN      | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE  |                   | 39970 |  1756K|  2249   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST ITERATOR|                   | 39970 |  1756K|  2249   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       TABLE ACCESS FULL     | PS_LEDGER         | 39970 |  1756K|  2249   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."ACCOUNTING_PERIOD">=1 AND "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDA
        TA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA
        [L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.18
18:35:23 SQL> REM spool off
18:35:23 SQL> 
18:35:23 SQL> REM 2019
18:35:23 SQL> explain plan for
18:35:23   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:35:23   3  FROM   PS_LEDGER A
18:35:23   4  ,      PSTREESELECT05 L1
18:35:23   5  ,      PSTREESELECT10 L
18:35:23   6  ,      PSTREESELECT10 L2
18:35:23   7  WHERE  A.LEDGER='ACTUALS'
18:35:23   8  AND    A.FISCAL_YEAR=2019
18:35:23   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
18:35:23  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:35:23  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:35:23  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:35:23  13  AND    A.CURRENCY_CD='GBP'
18:35:23  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:35:23  15  /

Explained.

Elapsed: 00:00:00.35
18:35:24 SQL> @@xp
18:35:24 SQL> REM xp.sql
18:35:24 SQL> REM spool xp
18:35:24 SQL> REM set pages 9999 lines 200 autotrace off
18:35:24 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1400212726

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1694 |   133K|   435   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1694 |   133K|   435   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1694 |   133K|   434   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  6275 |   379K|   432   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 68815 |  2217K|   429   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST ITERATOR      |                   | 68815 |  2217K|   429   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 68815 |  2217K|   429   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."ACCOUNTING_PERIOD">=1 AND
              "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


85 rows selected.

Elapsed: 00:00:00.17
18:35:24 SQL> REM spool off
18:35:24 SQL> 
18:35:24 SQL> REM 2020
18:35:24 SQL> explain plan for
18:35:24   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:35:24   3  FROM   PS_LEDGER A
18:35:24   4  ,      PSTREESELECT05 L1
18:35:24   5  ,      PSTREESELECT10 L
18:35:24   6  ,      PSTREESELECT10 L2
18:35:24   7  WHERE  A.LEDGER='ACTUALS'
18:35:24   8  AND    A.FISCAL_YEAR=2020
18:35:24   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
18:35:24  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:35:24  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:35:24  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:35:24  13  AND    A.CURRENCY_CD='GBP'
18:35:24  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:35:24  15  /

Explained.

Elapsed: 00:00:00.32
18:35:24 SQL> @@xp
18:35:24 SQL> REM xp.sql
18:35:24 SQL> REM spool xp
18:35:24 SQL> REM set pages 9999 lines 200 autotrace off
18:35:24 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1400212726

-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   | 13843 |  1095K|       |   687   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   | 13843 |  1095K|  1272K|   687   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   | 13843 |  1095K|       |   422   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   | 51218 |  3101K|       |   420   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   |   561K|    17M|       |   415   (1)| 00:00:01 |     2 |     2 |
|  10 |      PARTITION LIST ITERATOR      |                   |   561K|    17M|       |   415   (1)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   561K|    17M|       |   415   (1)| 00:00:01 |    15 |    28 |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."ACCOUNTING_PERIOD">=1 AND
              "MV_LEDGER_2020"."FISCAL_YEAR"=2020)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


85 rows selected.

Elapsed: 00:00:00.15
18:35:24 SQL> REM spool off
18:35:24 SQL> 
18:35:24 SQL> explain plan for
18:35:24   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:35:24   3  FROM   PS_LEDGER A
18:35:24   4  ,      PSTREESELECT05 L1
18:35:24   5  ,      PSTREESELECT10 L
18:35:24   6  ,      PSTREESELECT10 L2
18:35:24   7  WHERE  A.LEDGER='ACTUALS'
18:35:24   8  AND    A.FISCAL_YEAR=2019
18:35:24   9  AND    A.ACCOUNTING_PERIOD = 7
18:35:24  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:35:24  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:35:24  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:35:24  13  AND    A.CURRENCY_CD='GBP'
18:35:24  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:35:24  15  /

Explained.

Elapsed: 00:00:00.30
18:35:25 SQL> @@xp
18:35:25 SQL> REM xp.sql
18:35:25 SQL> REM spool xp
18:35:25 SQL> REM set pages 9999 lines 200 autotrace off
18:35:25 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 2992443773

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1821 |   144K|    77   (2)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1821 |   144K|    77   (2)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1821 |   144K|    76   (0)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   270 |  5130 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  6678 |   404K|    74   (0)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   182 |  5278 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |    91 |  1638 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |    91 |  1638 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 72794 |  2345K|    71   (0)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION LIST SINGLE        |                   | 72794 |  2345K|    71   (0)| 00:00:01 |   KEY |   KEY |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 72794 |  2345K|    71   (0)| 00:00:01 |     8 |     8 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.17
18:35:25 SQL> REM spool off
18:35:25 SQL> 
18:35:25 SQL> REM 2020
18:35:25 SQL> explain plan for
18:35:25   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
18:35:25   3  FROM   PS_LEDGER A
18:35:25   4  ,      PSTREESELECT05 L1
18:35:25   5  ,      PSTREESELECT10 L
18:35:25   6  ,      PSTREESELECT10 L2
18:35:25   7  WHERE  A.LEDGER='ACTUALS'
18:35:25   8  AND    A.FISCAL_YEAR=2020
18:35:25   9  AND    (A.ACCOUNTING_PERIOD = 7)
18:35:25  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
18:35:25  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
18:35:25  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
18:35:25  13  AND    A.CURRENCY_CD='GBP'
18:35:25  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
18:35:25  15  /

Explained.

Elapsed: 00:00:00.27
18:35:25 SQL> @@xp
18:35:25 SQL> REM xp.sql
18:35:25 SQL> REM spool xp
18:35:25 SQL> REM set pages 9999 lines 200 autotrace off
18:35:25 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3964652976

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|    12 |             PARTITION LIST SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |   KEY |   KEY |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    36 |    36 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    36 |    36 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.19
18:35:25 SQL> REM spool off
18:35:25 SQL> 
18:35:25 SQL> set autotrace off
18:35:25 SQL> @@mvcap
18:35:25 SQL> REM mvcap.sql
18:35:25 SQL> REM spool mvcap
18:35:25 SQL> set autotrace off
18:35:25 SQL> create table MV_CAPABILITIES_TABLE
18:35:25   2  (
18:35:25   3  	statement_id	  varchar(30) ,
18:35:25   4  	mvowner 	  varchar(30) ,
18:35:25   5  	mvname		  varchar(30) ,
18:35:25   6  	capability_name   varchar(30) ,
18:35:25   7  	possible	  character(1) ,
18:35:25   8  	related_text	  varchar(2000) ,
18:35:25   9  	related_num	  number ,
18:35:25  10  	msgno		  integer ,
18:35:25  11  	msgtxt		  varchar(2000) ,
18:35:25  12  	seq		  number
18:35:25  13  ) ;
create table MV_CAPABILITIES_TABLE
             *
ERROR at line 1:
ORA-00955: name is already used by an existing object


Elapsed: 00:00:00.01
18:35:25 SQL> 
18:35:25 SQL> truncate table MV_CAPABILITIES_TABLE;

Table truncated.

Elapsed: 00:00:00.04
18:35:25 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2019');
BEGIN DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2019'); END;

*
ERROR at line 1:
ORA-20000: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_IREFRESH", line 186
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3952
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 234
ORA-06512: at line 1


Elapsed: 00:00:00.00
18:35:25 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.06
18:35:25 SQL> break on mvname skip 1
18:35:25 SQL> column rel_text format a20
18:35:25 SQL> column msgtxt format a60
18:35:25 SQL> SELECT mvname, capability_name,  possible, SUBSTR(related_text,1,20) AS rel_text, SUBSTR(msgtxt,1,60) AS msgtxt
18:35:25   2  FROM MV_CAPABILITIES_TABLE
18:35:25   3  WHERE mvname like 'MV_LEDGER_20%'
18:35:25   4  ORDER BY mvname, seq;

MVNAME                         CAPABILITY_NAME                P REL_TEXT             MSGTXT
------------------------------ ------------------------------ - -------------------- ------------------------------------------------------------
MV_LEDGER_2020                 PCT                            Y
                               REFRESH_COMPLETE               Y
                               REFRESH_FAST                   Y
                               REWRITE                        Y
                               PCT_TABLE                      Y PS_LEDGER
                               REFRESH_FAST_AFTER_INSERT      N SCOTT.PS_LEDGER      the detail table does not have a materialized view log
                               REFRESH_FAST_AFTER_ONETAB_DML  N POSTED_TOTAL_AMT     SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      see the reason why REFRESH_FAST_AFTER_INSERT is disabled
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      COUNT(*) is not present in the select list
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ANY_DML     N                      see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
                               REFRESH_FAST_PCT               Y
                               REWRITE_FULL_TEXT_MATCH        Y
                               REWRITE_PARTIAL_TEXT_MATCH     Y
                               REWRITE_GENERAL                Y
                               REWRITE_PCT                    Y
                               PCT_TABLE_REWRITE              Y PS_LEDGER


17 rows selected.

Elapsed: 00:00:00.01
18:35:25 SQL> 
18:35:25 SQL> REM spool off
18:35:25 SQL> SPOOL OFF
