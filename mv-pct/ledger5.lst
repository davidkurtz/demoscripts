18:56:35 SQL> @@preledger.sql
18:56:35 SQL> REM preledger.sql
18:56:35 SQL> clear screen
18:56:35 SQL> connect scott/tiger@oracle_pdb
Connected.
18:56:36 SQL> set time on timi on autotrace off pages 99 lines 200 trimspool on echo on
18:56:36 SQL> alter session set nls_date_Format = 'hh24:mi:ss dd/mm/yyyy';

Session altered.

Elapsed: 00:00:00.00
18:56:36 SQL> drop table ps_ledger purge;

Table dropped.

Elapsed: 00:00:03.18
18:56:39 SQL> drop materialized view mv_ledger_2019;
drop materialized view mv_ledger_2019
*
ERROR at line 1:
ORA-12003: materialized view or zonemap "SCOTT"."MV_LEDGER_2019" does not exist


Elapsed: 00:00:00.00
18:56:39 SQL> drop table mv_ledger_2019 purge;
drop table mv_ledger_2019 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:56:39 SQL> drop materialized view mv_ledger_2020;

Materialized view dropped.

Elapsed: 00:00:00.96
18:56:40 SQL> drop table mv_ledger_2020 purge;
drop table mv_ledger_2020 purge
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
18:56:40 SQL> DROP TABLE PSTREESELECT05 PURGE;

Table dropped.

Elapsed: 00:00:00.06
18:56:40 SQL> DROP TABLE PSTREESELECT10 PURGE;

Table dropped.

Elapsed: 00:00:00.24
18:56:40 SQL> purge recyclebin;

Recyclebin purged.

Elapsed: 00:00:00.00
18:56:40 SQL> 
18:56:40 SQL> CREATE TABLE ps_ledger
18:56:40   2  (business_unit VARCHAR2(5) NOT NULL
18:56:40   3  ,ledger VARCHAR2(10) NOT NULL
18:56:40   4  ,account VARCHAR2(10) NOT NULL
18:56:40   5  ,altacct VARCHAR2(10) NOT NULL
18:56:40   6  ,deptid VARCHAR2(10) NOT NULL
18:56:40   7  ,operating_unit VARCHAR2(8) NOT NULL
18:56:40   8  ,product VARCHAR2(6) NOT NULL
18:56:40   9  ,fund_code VARCHAR2(5) NOT NULL
18:56:40  10  ,class_fld VARCHAR2(5) NOT NULL
18:56:40  11  ,program_code VARCHAR2(5) NOT NULL
18:56:40  12  ,budget_ref VARCHAR2(8) NOT NULL
18:56:40  13  ,affiliate VARCHAR2(5) NOT NULL
18:56:40  14  ,affiliate_intra1 VARCHAR2(10) NOT NULL
18:56:40  15  ,affiliate_intra2 VARCHAR2(10) NOT NULL
18:56:40  16  ,chartfield1 VARCHAR2(10) NOT NULL
18:56:40  17  ,chartfield2 VARCHAR2(10) NOT NULL
18:56:40  18  ,chartfield3 VARCHAR2(10) NOT NULL
18:56:40  19  ,project_id VARCHAR2(15) NOT NULL
18:56:40  20  ,book_code VARCHAR2(4) NOT NULL
18:56:40  21  ,gl_adjust_type VARCHAR2(4) NOT NULL
18:56:40  22  ,currency_cd VARCHAR2(3) NOT NULL
18:56:40  23  ,statistics_code VARCHAR2(3) NOT NULL
18:56:40  24  ,fiscal_year SMALLINT NOT NULL
18:56:40  25  ,accounting_period SMALLINT NOT NULL
18:56:40  26  ,posted_total_amt DECIMAL(26,3) NOT NULL
18:56:40  27  ,posted_base_amt DECIMAL(26,3) NOT NULL
18:56:40  28  ,posted_tran_amt DECIMAL(26,3) NOT NULL
18:56:40  29  ,base_currency VARCHAR2(3) NOT NULL
18:56:40  30  ,dttm_stamp_sec TIMESTAMP
18:56:40  31  ,process_instance DECIMAL(10) NOT NULL
18:56:40  32  ) PCTFREE 10 PCTUSED 80
18:56:40  33  PARTITION BY RANGE (FISCAL_YEAR)
18:56:40  34  SUBPARTITION BY RANGE (ACCOUNTING_PERIOD)
18:56:40  35  SUBPARTITION TEMPLATE
18:56:40  36  (SUBPARTITION ap_bf VALUES LESS THAN (1)
18:56:40  37  ,SUBPARTITION ap_01 VALUES LESS THAN (2)
18:56:40  38  ,SUBPARTITION ap_02 VALUES LESS THAN (3)
18:56:40  39  ,SUBPARTITION ap_03 VALUES LESS THAN (4)
18:56:40  40  ,SUBPARTITION ap_04 VALUES LESS THAN (5)
18:56:40  41  ,SUBPARTITION ap_05 VALUES LESS THAN (6)
18:56:40  42  ,SUBPARTITION ap_06 VALUES LESS THAN (7)
18:56:40  43  ,SUBPARTITION ap_07 VALUES LESS THAN (8)
18:56:40  44  ,SUBPARTITION ap_08 VALUES LESS THAN (9)
18:56:40  45  ,SUBPARTITION ap_09 VALUES LESS THAN (10)
18:56:40  46  ,SUBPARTITION ap_10 VALUES LESS THAN (11)
18:56:40  47  ,SUBPARTITION ap_11 VALUES LESS THAN (12)
18:56:40  48  ,SUBPARTITION ap_12 VALUES LESS THAN (13)
18:56:40  49  ,SUBPARTITION ap_cf VALUES LESS THAN (MAXVALUE))
18:56:40  50   (PARTITION ledger_2018 VALUES LESS THAN (2019) PCTFREE 0 COMPRESS
18:56:40  51  ,PARTITION ledger_2019 VALUES LESS THAN (2020) PCTFREE 0 COMPRESS
18:56:40  52  ,PARTITION ledger_2020 VALUES LESS THAN (2021)
18:56:40  53  ,PARTITION ledger_2021 VALUES LESS THAN (2022)
18:56:40  54  )
18:56:40  55  ENABLE ROW MOVEMENT NOLOGGING
18:56:40  56  /

Table created.

Elapsed: 00:00:00.20
18:56:40 SQL> @treeselectors
18:56:40 SQL> REM treeselectors.sql
18:56:40 SQL> 
18:56:40 SQL> DROP TABLE PSTREESELECT05 PURGE;
DROP TABLE PSTREESELECT05 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
18:56:40 SQL> CREATE TABLE PSTREESELECT05
18:56:40   2  (SELECTOR_NUM INTEGER NOT NULL,
18:56:40   3   TREE_NODE_NUM INTEGER NOT NULL,
18:56:40   4   RANGE_FROM_05 VARCHAR2(05) NOT NULL,
18:56:40   5   RANGE_TO_05   VARCHAR2(05) NOT NULL)
18:56:40   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
18:56:40   7   (PARTITION pstreeselector VALUES LESS THAN (2))
18:56:40   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.02
18:56:40 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT05 ON PSTREESELECT05 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_05);

Index created.

Elapsed: 00:00:00.02
18:56:40 SQL> 
18:56:40 SQL> DROP TABLE PSTREESELECT10 PURGE;
DROP TABLE PSTREESELECT10 PURGE
           *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.01
18:56:40 SQL> CREATE TABLE PSTREESELECT10
18:56:40   2  (SELECTOR_NUM INTEGER NOT NULL,
18:56:40   3   TREE_NODE_NUM INTEGER NOT NULL,
18:56:40   4   RANGE_FROM_10 VARCHAR2(10) NOT NULL,
18:56:40   5   RANGE_TO_10   VARCHAR2(10) NOT NULL)
18:56:40   6   PARTITION BY RANGE (SELECTOR_NUM) INTERVAL (1)
18:56:40   7   (PARTITION pstreeselector VALUES LESS THAN (2))
18:56:40   8   NOPARALLEL NOLOGGING;

Table created.

Elapsed: 00:00:00.03
18:56:40 SQL> CREATE UNIQUE INDEX PS_PSTREESELECT10 ON PSTREESELECT10 (SELECTOR_NUM, TREE_NODE_NUM, RANGE_FROM_10);

Index created.

Elapsed: 00:00:00.01
18:56:40 SQL> 
18:56:40 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
18:56:40 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
18:56:40 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT05','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.07
18:56:40 SQL> exec dbms_stats.set_table_prefs('SCOTT','PSTREESELECT10','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS SELECTOR_NUM, (SELECTOR_NUM, TREE_NODE_NUM) SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.03
18:56:40 SQL> 
18:56:40 SQL> @popledger
18:56:40 SQL> REM popledger.sql
18:56:40 SQL> set autotrace off echo on pages 99 lines 200 trimspool on
18:56:40 SQL> 
18:56:40 SQL> truncate table ps_ledger;

Table truncated.

Elapsed: 00:00:00.02
18:56:41 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, LEDGER, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.03
18:56:41 SQL> exec dbms_stats.set_table_prefs('SCOTT','PS_LEDGER','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
18:56:41 SQL> 
18:56:41 SQL> ALTER TABLE PS_LEDGER PARALLEL 8;

Table altered.

Elapsed: 00:00:00.02
18:56:41 SQL> 
18:56:41 SQL> insert /*+APPEND PARALLEL ENABLE_PARALLEL_DML*/ into ps_ledger
18:56:41   2  with n as (
18:56:41   3  SELECT rownum n from dual connect by level <= 1e2
18:56:41   4  ), fy as (
18:56:41   5  SELECT /*+MATERIALIZE*/ 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
18:56:41   6  ), ap as (
18:56:41   7  SELECT /*+MATERIALIZE*/ FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
18:56:41   8  UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
18:56:41   9  UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
18:56:41  10  ), l as (
18:56:41  11  SELECT /*+MATERIALIZE*/ 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
18:56:41  12  UNION ALL SELECT 'BUDGET' FROM DUAL
18:56:41  13  )
18:56:41  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
18:56:41  15  ,      l.ledger
18:56:41  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
18:56:41  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
18:56:41  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
18:56:41  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
18:56:41  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
18:56:41  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
18:56:41  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
18:56:41  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
18:56:41  24  ,      ' ' budget_ref
18:56:41  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
18:56:41  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
18:56:41  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
18:56:41  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
18:56:41  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
18:56:41  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
18:56:41  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
18:56:41  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
18:56:41  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
18:56:41  34  ,      'GBP' currency_cd
18:56:41  35  ,      ' ' statistics_code
18:56:41  36  ,      fy.fiscal_year
18:56:41  37  ,      ap.accounting_period
18:56:41  38  ,      dbms_random.value(0,1e6) posted_total_amt
18:56:41  39  ,      0 posted_base_amt
18:56:41  40  ,      0 posted_tran_amt
18:56:41  41  ,      'GBP' base_currency
18:56:41  42  ,      SYSDATE dttm_stamp_sec
18:56:41  43  ,      0 process_instance
18:56:41  44  FROM   fy,ap, l, n
18:56:41  45  WHERE  l.ledger = 'BUDGET' or (fy.fiscal_year < 2020 or (fy.fiscal_year = 2020 AND ap.accounting_period <= 6))
18:56:41  46  /

2936818 rows created.

Elapsed: 00:08:15.63
19:04:56 SQL> commit;

Commit complete.

Elapsed: 00:00:00.03
19:04:56 SQL> exec dbms_stats.gather_table_stats('SCOTT','PS_LEDGER');

PL/SQL procedure successfully completed.

Elapsed: 00:01:26.22
19:06:22 SQL> 
19:06:22 SQL> CREATE /*UNIQUE*/ INDEX ps_ledger ON ps_ledger
19:06:22   2  (business_unit,ledger,account,altacct,deptid
19:06:22   3  ,operating_unit,product,fund_code,class_fld,program_code
19:06:22   4  ,budget_ref,affiliate,affiliate_intra1,affiliate_intra2,chartfield1
19:06:22   5  ,chartfield2,chartfield3,project_id,book_code,gl_adjust_type
19:06:22   6  /*,date_code*/,currency_cd,statistics_code,fiscal_year,accounting_period
19:06:22   7  ) COMPRESS 2 NOPARALLEL
19:06:22   8  /

Index created.

Elapsed: 00:00:49.75
19:07:12 SQL> 
19:07:12 SQL> CREATE INDEX psxledger ON ps_ledger
19:07:12   2  (ledger, fiscal_year, accounting_period, business_unit, account, chartfield1
19:07:12   3  ) LOCAL COMPRESS 4 PARALLEL
19:07:12   4  /

Index created.

Elapsed: 00:00:12.50
19:07:25 SQL> 
19:07:25 SQL> CREATE INDEX psyledger ON ps_ledger
19:07:25   2  (ledger, fiscal_year, business_unit, account, chartfield1, accounting_period
19:07:25   3  ) LOCAL COMPRESS 3 PARALLEL
19:07:25   4  /

Index created.

Elapsed: 00:00:09.46
19:07:34 SQL> 
19:07:34 SQL> ALTER INDEX ps_ledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.01
19:07:34 SQL> ALTER INDEX psxledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.01
19:07:34 SQL> ALTER INDEX psyledger NOPARALLEL;

Index altered.

Elapsed: 00:00:00.01
19:07:34 SQL> 
19:07:34 SQL> break on report on ledger skip 1
19:07:34 SQL> compute sum of count(*) on report
19:07:34 SQL> set autotrace off
19:07:34 SQL> select ledger, fiscal_year, count(*), max(accounting_period)
19:07:34   2  from ps_ledger
19:07:34   3  group by ledger, fiscal_year
19:07:34   4  order by 1,2
19:07:34   5  /

LEDGER     FISCAL_YEAR   COUNT(*) MAX(ACCOUNTING_PERIOD)
---------- ----------- ---------- ----------------------
ACTUALS           2018    1000000                    999
                  2019    1000000                    999
                  2020     536818                      6

BUDGET            2018     100000                    999
                  2019     100000                    999
                  2020     100000                    999
                  2021     100000                    999

**********             ----------
sum                       2936818

7 rows selected.

Elapsed: 00:00:03.36
19:07:38 SQL> compute sum of count(*) on fiscal_year
19:07:38 SQL> break on report on fiscal_year skip 1 on ledger skip 1
19:07:38 SQL> select ledger, fiscal_year, accounting_period, count(*)
19:07:38   2  from ps_ledger
19:07:38   3  group by ledger, fiscal_year, accounting_period
19:07:38   4  order by 1,2,3
19:07:38   5  /

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
ACTUALS           2018                 0      76999
                                       1      76760
                                       2      76769
                                       3      76426
                                       4      76429
                                       5      76302
                                       6      76728
                                       7      76949
                                       8      76903
                                       9      76892
                                      10      76880
                                      11      76944
                                      12      77019
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2019                 0      76540
                                       1      76891
                                       2      76961
                                       3      76853
                                       4      77051
                                       5      76463
                                       6      76207
                                       7      76951
                                       8      76458
                                       9      77063
                                      10      76924
                                      11      76712
                                      12      76926
                                     998       1000
                                     999       1000

********** ***********                   ----------
           sum                              1000000

ACTUALS           2020                 0      76467
                                       1      77019
                                       2      76336
                                       3      76768
                                       4      76511
                                       5      77232
                                       6      76485

********** ***********                   ----------
           sum                               536818

BUDGET            2018                 0       7691
                                       1       7594
                                       2       7756
                                       3       7735
                                       4       7686
                                       5       7660
                                       6       7483
                                       7       7600
                                       8       7840
                                       9       7837
                                      10       7653
                                      11       7694
                                      12       7571
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2019                 0       7755
                                       1       7698
                                       2       7692
                                       3       7675
                                       4       7847
                                       5       7714
                                       6       7888
                                       7       7505
                                       8       7537
                                       9       7585
                                      10       7567
                                      11       7735
                                      12       7602
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2020                 0       7674
                                       1       7805
                                       2       7688
                                       3       7683
                                       4       7768
                                       5       7556
                                       6       7679
                                       7       7788
                                       8       7607

LEDGER     FISCAL_YEAR ACCOUNTING_PERIOD   COUNT(*)
---------- ----------- ----------------- ----------
BUDGET            2020                 9       7654
                                      10       7785
                                      11       7548
                                      12       7565
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

BUDGET            2021                 0       7721
                                       1       7607
                                       2       7483
                                       3       7491
                                       4       7599
                                       5       7795
                                       6       7643
                                       7       7682
                                       8       7785
                                       9       7817
                                      10       7779
                                      11       7788
                                      12       7610
                                     998        100
                                     999        100

********** ***********                   ----------
           sum                               100000

                                         ----------
sum                                         2936818

97 rows selected.

Elapsed: 00:00:03.25
19:07:41 SQL> break on ledger skip 1 on fiscal_year skip 1
19:07:41 SQL> select ledger, account, count(*)
19:07:41   2  from ps_ledger
19:07:41   3  where 1=2
19:07:41   4  group by ledger, account
19:07:41   5  order by 1,3
19:07:41   6  /

no rows selected

Elapsed: 00:00:00.01
19:07:41 SQL> 
19:07:41 SQL> TRUNCATE TABLE PSTREESELECT05;

Table truncated.

Elapsed: 00:00:00.01
19:07:41 SQL> TRUNCATE TABLE PSTREESELECT10;

Table truncated.

Elapsed: 00:00:00.02
19:07:41 SQL> 
19:07:41 SQL> INSERT INTO PSTREESELECT05
19:07:41   2  WITH x as (SELECT DISTINCT business_unit FROM ps_ledger)
19:07:41   3  , y as (SELECT 30982, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, business_unit FROM x)
19:07:41   4  select y.*, business_unit FROM y
19:07:41   5  /

2 rows created.

Elapsed: 00:00:02.70
19:07:44 SQL> INSERT INTO PSTREESELECT10
19:07:44   2  WITH x as (SELECT DISTINCT account FROM ps_ledger)
19:07:44   3  , y as (SELECT 30984, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, account FROM x)
19:07:44   4  select y.*, account FROM y
19:07:44   5  where mod(tree_node_num,100)<25
19:07:44   6  /

257 rows created.

Elapsed: 00:00:03.43
19:07:47 SQL> INSERT INTO PSTREESELECT10
19:07:47   2  WITH x as (SELECT DISTINCT chartfield1 FROM ps_ledger)
19:07:47   3  , y as (SELECT 30985, FLOOR(DBMS_RANDOM.value(1,1e10)) tree_node_num, chartfield1 FROM x)
19:07:47   4  select y.*, chartfield1 FROM y
19:07:47   5  where mod(tree_node_num,100)<10
19:07:47   6  /

105 rows created.

Elapsed: 00:00:03.40
19:07:50 SQL> commit;

Commit complete.

Elapsed: 00:00:00.02
19:07:50 SQL> 
19:07:50 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT05');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.23
19:07:51 SQL> exec dbms_stats.gather_table_stats('SCOTT','PSTREESELECT10');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.52
19:07:51 SQL> 
19:07:51 SQL> ALTER TABLE PS_LEDGER NOPARALLEL;

Table altered.

Elapsed: 00:00:00.02
19:07:51 SQL> 
19:07:51 SQL> /*explain plan for
19:07:51 SQL> SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:07:51 SQL> FROM   PS_LEDGER A
19:07:51 SQL> ,      PSTREESELECT05 L1
19:07:51 SQL> ,      PSTREESELECT10 L
19:07:51 SQL> ,      PSTREESELECT10 L2
19:07:51 SQL> WHERE  A.LEDGER='ACTUALS'
19:07:51 SQL> AND    A.FISCAL_YEAR=2020
19:07:51 SQL> AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 2
19:07:51 SQL> AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:07:51 SQL> AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:07:51 SQL> AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:07:51 SQL> AND    A.CURRENCY_CD='GBP'
19:07:51 SQL> GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:07:51 SQL> /
19:07:51 SQL> @@xp*/
19:07:51 SQL> 
19:07:51 SQL> /*CREATE MATERIALIZED VIEW mv_ledger_2019
19:07:51 SQL> PARTITION BY RANGE (FISCAL_YEAR)
19:07:51 SQL> (PARTITION ledger_2019 VALUES LESS THAN (2020)
19:07:51 SQL> ,PARTITION ledger_2020 VALUES LESS THAN (2021)
19:07:51 SQL> ) PCTFREE 0 COMPRESS
19:07:51 SQL> REFRESH COMPLETE ON DEMAND
19:07:51 SQL> ENABLE QUERY REWRITE AS
19:07:51 SQL> SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
19:07:51 SQL> sum(posted_total_amt) posted_total_amt
19:07:51 SQL> FROM ps_ledger
19:07:51 SQL> WHERE fiscal_year = 2019
19:07:51 SQL> AND   ledger = 'ACTUALS'
19:07:51 SQL> AND   currency_cd = 'GBP'
19:07:51 SQL> GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
19:07:51 SQL> */
19:07:51 SQL> 
19:07:51 SQL> CREATE MATERIALIZED VIEW mv_ledger_2020
19:07:51   2  PARTITION BY RANGE (FISCAL_YEAR) --INTERVAL (1)
19:07:51   3  SUBPARTITION BY RANGE (ACCOUNTING_PERIOD)
19:07:51   4  SUBPARTITION TEMPLATE
19:07:51   5  (SUBPARTITION ap_bf VALUES LESS THAN (1)
19:07:51   6  ,SUBPARTITION ap_01 VALUES LESS THAN (2)
19:07:51   7  ,SUBPARTITION ap_02 VALUES LESS THAN (3)
19:07:51   8  ,SUBPARTITION ap_03 VALUES LESS THAN (4)
19:07:51   9  ,SUBPARTITION ap_04 VALUES LESS THAN (5)
19:07:51  10  ,SUBPARTITION ap_05 VALUES LESS THAN (6)
19:07:51  11  ,SUBPARTITION ap_06 VALUES LESS THAN (7)
19:07:51  12  ,SUBPARTITION ap_07 VALUES LESS THAN (8)
19:07:51  13  ,SUBPARTITION ap_08 VALUES LESS THAN (9)
19:07:51  14  ,SUBPARTITION ap_09 VALUES LESS THAN (10)
19:07:51  15  ,SUBPARTITION ap_10 VALUES LESS THAN (11)
19:07:51  16  ,SUBPARTITION ap_11 VALUES LESS THAN (12)
19:07:51  17  ,SUBPARTITION ap_12 VALUES LESS THAN (13)
19:07:51  18  ,SUBPARTITION ap_cf VALUES LESS THAN (MAXVALUE))
19:07:51  19  (PARTITION ledger_2019 VALUES LESS THAN (2020)
19:07:51  20  ,PARTITION ledger_2020 VALUES LESS THAN (2021)
19:07:51  21  ) PCTFREE 0 COMPRESS PARALLEL
19:07:51  22  REFRESH COMPLETE ON DEMAND
19:07:51  23  ENABLE QUERY REWRITE AS
19:07:51  24  SELECT business_unit, account, chartfield1, fiscal_year, accounting_period,
19:07:51  25  sum(posted_total_amt) posted_total_amt
19:07:51  26  FROM ps_ledger
19:07:51  27  WHERE fiscal_year >= 2019
19:07:51  28  AND   ledger = 'ACTUALS'
19:07:51  29  AND   currency_cd = 'GBP'
19:07:51  30  GROUP BY business_unit, account, chartfield1, fiscal_year, accounting_period
19:07:51  31  /

Materialized view created.

Elapsed: 00:00:15.96
19:08:07 SQL> 
19:08:07 SQL> @@mvpop
19:08:07 SQL> REM mvpop.sql
19:08:07 SQL> set autotrace off
19:08:07 SQL> break on table_name skip 1 on partition_name
19:08:07 SQL> column table_name format a20
19:08:07 SQL> column mview_name format a20
19:08:07 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.01
19:08:07 SQL> 
19:08:07 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
19:08:07 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);
19:08:07 SQL> 
19:08:07 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'C',atomic_refresh=>FALSE);
19:08:07 SQL> --exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'C',atomic_refresh=>FALSE);
19:08:07 SQL> 
19:08:07 SQL> ALTER MATERIALIZED VIEW mv_ledger_2019 NOPARALLEL;
ALTER MATERIALIZED VIEW mv_ledger_2019 NOPARALLEL
*
ERROR at line 1:
ORA-12003: materialized view or zonemap "SCOTT"."MV_LEDGER_2019" does not exist


Elapsed: 00:00:00.00
19:08:07 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');
BEGIN dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254'); END;

*
ERROR at line 1:
ORA-20000: TABLE "SCOTT"."MV_LEDGER_2019" does not exist or insufficient privileges
ORA-06512: at "SYS.DBMS_STATS", line 52981
ORA-06512: at "SYS.DBMS_STATS", line 9446
ORA-06512: at "SYS.DBMS_STATS", line 52904
ORA-06512: at line 1


Elapsed: 00:00:00.01
19:08:07 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','GRANULARITY','ALL');
BEGIN dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2019','GRANULARITY','ALL'); END;

*
ERROR at line 1:
ORA-20000: TABLE "SCOTT"."MV_LEDGER_2019" does not exist or insufficient privileges
ORA-06512: at "SYS.DBMS_STATS", line 52981
ORA-06512: at "SYS.DBMS_STATS", line 9446
ORA-06512: at "SYS.DBMS_STATS", line 52904
ORA-06512: at line 1


Elapsed: 00:00:00.00
19:08:07 SQL> 
19:08:07 SQL> ALTER MATERIALIZED VIEW mv_ledger_2020 NOPARALLEL;

Materialized view altered.

Elapsed: 00:00:00.01
19:08:07 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','METHOD_OPT','FOR ALL COLUMNS SIZE 1, FOR COLUMNS FISCAL_YEAR, ACCOUNTING_PERIOD, BUSINESS_UNIT SIZE 254');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.02
19:08:07 SQL> exec dbms_stats.set_table_prefs('SCOTT','MV_LEDGER_2020','GRANULARITY','ALL');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.01
19:08:07 SQL> 
19:08:07 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2019');
BEGIN dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2019'); END;

*
ERROR at line 1:
ORA-20000: Unable to analyze TABLE "SCOTT"."MV_LEDGER_2019", insufficient privileges or does not exist
ORA-06512: at "SYS.DBMS_STATS", line 40753
ORA-06512: at "SYS.DBMS_STATS", line 40026
ORA-06512: at "SYS.DBMS_STATS", line 40185
ORA-06512: at "SYS.DBMS_STATS", line 40734
ORA-06512: at line 1


Elapsed: 00:00:00.02
19:08:07 SQL> exec dbms_stats.gather_table_stats('SCOTT','MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:48.29
19:08:56 SQL> @@mvvol
19:08:56 SQL> REM mvvol.sql
19:08:56 SQL> 
19:08:56 SQL> set autotrace off
19:08:56 SQL> break on table_name skip 1 on partition_name
19:08:56 SQL> column table_name format a15
19:08:56 SQL> column column_name format a20
19:08:56 SQL> column mview_name format a20
19:08:56 SQL> column partition_position format 999 heading 'Part|Pos'
19:08:56 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
19:08:56 SQL> column partition_name format a20
19:08:56 SQL> column subpartition_name format a25
19:08:56 SQL> column num_rows format 9999999
19:08:56 SQL> column num_distinct heading 'Num|Distinct' format 9999999
19:08:56 SQL> column num_buckets heading 'Num|Buckets'	format 9999
19:08:56 SQL> column blocks format 99999
19:08:56 SQL> column rpb format 999.9 heading 'Rows|per|Block'
19:08:56 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
19:08:56 SQL> 
19:08:56 SQL> select count(*) from mv_ledger_2019;
select count(*) from mv_ledger_2019
                     *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
19:08:56 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
   1454666

Elapsed: 00:00:00.09
19:08:56 SQL> 
19:08:56 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
19:08:56   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
19:08:56   3  , COALESCE(c.compression, b.compression) compression
19:08:56   4  , COALESCE(c.compress_for, b.compress_for) compress_for
19:08:56   5  from user_tab_statistics a
19:08:56   6  	LEFT OUTER JOIN user_tab_partitions b
19:08:56   7  	  ON a.table_name = b.table_name
19:08:56   8  	  AND a.partition_name = b.partition_name
19:08:56   9  	LEFT OUTER JOIN user_tab_subpartitions c
19:08:56  10  	  ON a.table_name = c.table_name
19:08:56  11  	  AND a.partition_name = c.partition_name
19:08:56  12  	  AND a.subpartition_name = c.subpartition_name
19:08:56  13  where a.table_name like '%LEDGER%'
19:08:56  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
19:08:56  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2020     1 LEDGER_2019                                           946478   3360  281.7 ENABLED  BASIC
                   1                         1 LEDGER_2019_AP_BF            72513    256  283.3 ENABLED  BASIC
                   1                         2 LEDGER_2019_AP_01            72834    256  284.5 ENABLED  BASIC
                   1                         3 LEDGER_2019_AP_02            72863    256  284.6 ENABLED  BASIC
                   1                         4 LEDGER_2019_AP_03            72743    256  284.2 ENABLED  BASIC
                   1                         5 LEDGER_2019_AP_04            72887    256  284.7 ENABLED  BASIC
                   1                         6 LEDGER_2019_AP_05            72378    256  282.7 ENABLED  BASIC
                   1                         7 LEDGER_2019_AP_06            72101    256  281.6 ENABLED  BASIC
                   1                         8 LEDGER_2019_AP_07            72801    256  284.4 ENABLED  BASIC
                   1                         9 LEDGER_2019_AP_08            72386    256  282.8 ENABLED  BASIC
                   1                        10 LEDGER_2019_AP_09            72809    256  284.4 ENABLED  BASIC
                   1                        11 LEDGER_2019_AP_10            72726    256  284.1 ENABLED  BASIC
                   1                        12 LEDGER_2019_AP_11            72624    256  283.7 ENABLED  BASIC
                   1                        13 LEDGER_2019_AP_12            72813    256  284.4 ENABLED  BASIC
                   1                        14 LEDGER_2019_AP_CF             2000     32   62.5 ENABLED  BASIC
                   2 LEDGER_2020                                           508188   1792  283.6 ENABLED  BASIC
                   2                         1 LEDGER_2020_AP_BF            72371    256  282.7 ENABLED  BASIC
                   2                         2 LEDGER_2020_AP_01            72907    256  284.8 ENABLED  BASIC
                   2                         3 LEDGER_2020_AP_02            72207    256  282.1 ENABLED  BASIC
                   2                         4 LEDGER_2020_AP_03            72650    256  283.8 ENABLED  BASIC
                   2                         5 LEDGER_2020_AP_04            72523    256  283.3 ENABLED  BASIC
                   2                         6 LEDGER_2020_AP_05            73026    256  285.3 ENABLED  BASIC
                   2                         7 LEDGER_2020_AP_06            72504    256  283.2 ENABLED  BASIC
                   2                         8 LEDGER_2020_AP_07                0      0        ENABLED  BASIC
                   2                         9 LEDGER_2020_AP_08                0      0        ENABLED  BASIC
                   2                        10 LEDGER_2020_AP_09                0      0        ENABLED  BASIC
                   2                        11 LEDGER_2020_AP_10                0      0        ENABLED  BASIC
                   2                        12 LEDGER_2020_AP_11                0      0        ENABLED  BASIC
                   2                        13 LEDGER_2020_AP_12                0      0        ENABLED  BASIC
                   2                        14 LEDGER_2020_AP_CF                0      0        ENABLED  BASIC
                                                                          1454666   5152  282.3

PS_LEDGER          1 LEDGER_2018                                          1100000  17864   61.6 ENABLED  BASIC
                   1                         1 LEDGER_2018_AP_BF            84690   1374   61.6 ENABLED  BASIC
                   1                         2 LEDGER_2018_AP_01            84354   1368   61.7 ENABLED  BASIC
                   1                         3 LEDGER_2018_AP_02            84525   1371   61.7 ENABLED  BASIC
                   1                         4 LEDGER_2018_AP_03            84161   1366   61.6 ENABLED  BASIC
                   1                         5 LEDGER_2018_AP_04            84115   1365   61.6 ENABLED  BASIC
                   1                         6 LEDGER_2018_AP_05            83962   1363   61.6 ENABLED  BASIC
                   1                         7 LEDGER_2018_AP_06            84211   1366   61.6 ENABLED  BASIC
                   1                         8 LEDGER_2018_AP_07            84549   1372   61.6 ENABLED  BASIC
                   1                         9 LEDGER_2018_AP_08            84743   1375   61.6 ENABLED  BASIC
                   1                        10 LEDGER_2018_AP_09            84729   1374   61.7 ENABLED  BASIC
                   1                        11 LEDGER_2018_AP_10            84533   1371   61.7 ENABLED  BASIC
                   1                        12 LEDGER_2018_AP_11            84638   1373   61.6 ENABLED  BASIC
                   1                        13 LEDGER_2018_AP_12            84590   1373   61.6 ENABLED  BASIC
                   1                        14 LEDGER_2018_AP_CF             2200     53   41.5 ENABLED  BASIC
                   2 LEDGER_2019                                          1100000  17862   61.6 ENABLED  BASIC
                   2                         1 LEDGER_2019_AP_BF            84295   1367   61.7 ENABLED  BASIC
                   2                         2 LEDGER_2019_AP_01            84589   1372   61.7 ENABLED  BASIC
                   2                         3 LEDGER_2019_AP_02            84653   1373   61.7 ENABLED  BASIC
                   2                         4 LEDGER_2019_AP_03            84528   1371   61.7 ENABLED  BASIC
                   2                         5 LEDGER_2019_AP_04            84898   1377   61.7 ENABLED  BASIC
                   2                         6 LEDGER_2019_AP_05            84177   1366   61.6 ENABLED  BASIC
                   2                         7 LEDGER_2019_AP_06            84095   1365   61.6 ENABLED  BASIC
                   2                         8 LEDGER_2019_AP_07            84456   1370   61.6 ENABLED  BASIC
                   2                         9 LEDGER_2019_AP_08            83995   1363   61.6 ENABLED  BASIC
                   2                        10 LEDGER_2019_AP_09            84648   1373   61.7 ENABLED  BASIC
                   2                        11 LEDGER_2019_AP_10            84491   1371   61.6 ENABLED  BASIC
                   2                        12 LEDGER_2019_AP_11            84447   1370   61.6 ENABLED  BASIC
                   2                        13 LEDGER_2019_AP_12            84528   1371   61.7 ENABLED  BASIC
                   2                        14 LEDGER_2019_AP_CF             2200     53   41.5 ENABLED  BASIC
                   3 LEDGER_2020                                           636818  16762   38.0 NONE
                   3                         1 LEDGER_2020_AP_BF            84141   2178   38.6 DISABLED
                   3                         2 LEDGER_2020_AP_01            84824   2224   38.1 DISABLED
                   3                         3 LEDGER_2020_AP_02            84024   2204   38.1 DISABLED
                   3                         4 LEDGER_2020_AP_03            84451   2215   38.1 DISABLED
                   3                         5 LEDGER_2020_AP_04            84279   2210   38.1 DISABLED
                   3                         6 LEDGER_2020_AP_05            84788   2223   38.1 DISABLED
                   3                         7 LEDGER_2020_AP_06            84164   2207   38.1 DISABLED
                   3                         8 LEDGER_2020_AP_07             7788    216   36.1 DISABLED
                   3                         9 LEDGER_2020_AP_08             7607    212   35.9 DISABLED
                   3                        10 LEDGER_2020_AP_09             7654    213   35.9 DISABLED
                   3                        11 LEDGER_2020_AP_10             7785    216   36.0 DISABLED
                   3                        12 LEDGER_2020_AP_11             7548    210   35.9 DISABLED
                   3                        13 LEDGER_2020_AP_12             7565    210   36.0 DISABLED
                   3                        14 LEDGER_2020_AP_CF              200     24    8.3 DISABLED
                   4 LEDGER_2021                                           100000   2790   35.8 NONE
                   4                         1 LEDGER_2021_AP_BF             7721    212   36.4 DISABLED
                   4                         2 LEDGER_2021_AP_01             7607    211   36.1 DISABLED
                   4                         3 LEDGER_2021_AP_02             7483    208   36.0 DISABLED
                   4                         4 LEDGER_2021_AP_03             7491    208   36.0 DISABLED
                   4                         5 LEDGER_2021_AP_04             7599    211   36.0 DISABLED
                   4                         6 LEDGER_2021_AP_05             7795    216   36.1 DISABLED
                   4                         7 LEDGER_2021_AP_06             7643    212   36.1 DISABLED
                   4                         8 LEDGER_2021_AP_07             7682    213   36.1 DISABLED
                   4                         9 LEDGER_2021_AP_08             7785    216   36.0 DISABLED
                   4                        10 LEDGER_2021_AP_09             7817    216   36.2 DISABLED
                   4                        11 LEDGER_2021_AP_10             7779    216   36.0 DISABLED
                   4                        12 LEDGER_2021_AP_11             7788    216   36.1 DISABLED
                   4                        13 LEDGER_2021_AP_12             7610    211   36.1 DISABLED
                   4                        14 LEDGER_2021_AP_CF              200     24    8.3 DISABLED
                                                                          2936818  55278   53.1


92 rows selected.

Elapsed: 00:00:03.17
19:08:59 SQL> 
19:08:59 SQL> column extension format a40
19:08:59 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
19:08:59   2  from user_tab_col_statistics s
19:08:59   3  	LEFT OUTER JOIN user_stat_extensions e
19:08:59   4  	ON e.table_name = s.table_name
19:08:59   5  	AND e.extension_name = s.column_name
19:08:59   6  where s.table_name like 'MV_LEDGER%'
19:08:59   7  order by 1,2
19:08:59   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  ACCOUNT                   999       1 NONE            19:08:28 18/11/2020
                ACCOUNTING_PERIOD          15       1 NONE            19:08:28 18/11/2020
                BUSINESS_UNIT               2       2 FREQUENCY       19:08:28 18/11/2020
                CHARTFIELD1               999       1 NONE            19:08:28 18/11/2020
                FISCAL_YEAR                 2       1 NONE            19:08:28 18/11/2020
                POSTED_TOTAL_AMT      1454666       1 NONE            19:08:28 18/11/2020
                SYS_NC00007$                2       1 NONE            19:08:28 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            19:08:28 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              999       1 NONE            19:08:28 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                2       1 NONE            19:08:28 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            19:08:28 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                          )



11 rows selected.

Elapsed: 00:00:00.11
19:08:59 SQL> column extension format a40
19:08:59 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
19:08:59   2  from user_part_col_statistics s
19:08:59   3  	LEFT OUTER JOIN user_stat_extensions e
19:08:59   4  	ON e.table_name = s.table_name
19:08:59   5  	AND e.extension_name = s.column_name
19:08:59   6  where s.table_name like 'MV_LEDGER%'
19:08:59   7  order by 1,2
19:08:59   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019          BUSINESS_UNIT               2       2 FREQUENCY       19:08:19 18/11/2020
                                     ACCOUNT                   999       1 NONE            19:08:19 18/11/2020
                                     CHARTFIELD1               999       1 NONE            19:08:19 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            19:08:19 18/11/2020
                                     ACCOUNTING_PERIOD          15       1 NONE            19:08:19 18/11/2020
                                     POSTED_TOTAL_AMT       942016       1 NONE            19:08:19 18/11/2020
                                     SYS_NC00007$                2       1 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              999       1 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              999       1 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$               15       1 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )

                LEDGER_2020          BUSINESS_UNIT               2       2 FREQUENCY       19:08:25 18/11/2020
                                     ACCOUNT                   998       1 NONE            19:08:25 18/11/2020
                                     CHARTFIELD1               999       1 NONE            19:08:25 18/11/2020
                                     FISCAL_YEAR                 1       1 NONE            19:08:25 18/11/2020
                                     ACCOUNTING_PERIOD           7       1 NONE            19:08:25 18/11/2020
                                     POSTED_TOTAL_AMT       508188       1 NONE            19:08:25 18/11/2020
                                     SYS_NC00007$                2       1 NONE            19:08:25 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              998       1 NONE            19:08:25 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              999       1 NONE            19:08:25 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            19:08:25 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                7       1 NONE            19:08:25 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                               )



22 rows selected.

Elapsed: 00:00:00.02
19:08:59 SQL> 
19:08:59 SQL> column extension format a40
19:08:59 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
19:08:59   2  from user_subpart_col_statistics s
19:08:59   3  	LEFT OUTER JOIN user_stat_extensions e
19:08:59   4  	ON e.table_name = s.table_name
19:08:59   5  	AND e.extension_name = s.column_name
19:08:59   6  where s.table_name like 'MV_LEDGER%'
19:08:59   7  order by 1,2
19:08:59   8  ;

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019_AP_01         SYS_NC00011$                1       1 NONE            19:08:08 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       19:08:08 18/11/2020
                LEDGER_2019_AP_01         ACCOUNT                   994       1 NONE            19:08:08 18/11/2020
                LEDGER_2019_AP_01         CHARTFIELD1               993       1 NONE            19:08:08 18/11/2020
                LEDGER_2019_AP_01         FISCAL_YEAR                 1       1 NONE            19:08:08 18/11/2020
                LEDGER_2019_AP_01         ACCOUNTING_PERIOD           1       1 NONE            19:08:08 18/11/2020
                LEDGER_2019_AP_01         POSTED_TOTAL_AMT        72834       1 NONE            19:08:08 18/11/2020
                LEDGER_2019_AP_01         SYS_NC00007$                2       1 NONE            19:08:08 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_01         SYS_NC00008$              994       1 NONE            19:08:08 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_01         SYS_NC00009$              993       1 NONE            19:08:08 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_01         SYS_NC00010$                1       1 NONE            19:08:08 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_02         SYS_NC00011$                1       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       19:08:14 18/11/2020
                LEDGER_2019_AP_02         ACCOUNT                   995       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_02         CHARTFIELD1               996       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_02         FISCAL_YEAR                 1       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_02         ACCOUNTING_PERIOD           1       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_02         POSTED_TOTAL_AMT        72863       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_02         SYS_NC00007$                2       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_02         SYS_NC00008$              995       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_02         SYS_NC00009$              996       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_02         SYS_NC00010$                1       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_03         SYS_NC00011$                1       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       19:08:14 18/11/2020
                LEDGER_2019_AP_03         ACCOUNT                   995       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_03         CHARTFIELD1               994       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_03         FISCAL_YEAR                 1       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_03         ACCOUNTING_PERIOD           1       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_03         POSTED_TOTAL_AMT        72024       1 NONE            19:08:14 18/11/2020
                LEDGER_2019_AP_03         SYS_NC00007$                2       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_03         SYS_NC00008$              995       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_03         SYS_NC00009$              994       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_03         SYS_NC00010$                1       1 NONE            19:08:14 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_04         SYS_NC00011$                1       1 NONE            19:08:13 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       19:08:13 18/11/2020
                LEDGER_2019_AP_04         ACCOUNT                   991       1 NONE            19:08:13 18/11/2020
                LEDGER_2019_AP_04         CHARTFIELD1               991       1 NONE            19:08:13 18/11/2020
                LEDGER_2019_AP_04         FISCAL_YEAR                 1       1 NONE            19:08:13 18/11/2020
                LEDGER_2019_AP_04         ACCOUNTING_PERIOD           1       1 NONE            19:08:13 18/11/2020
                LEDGER_2019_AP_04         POSTED_TOTAL_AMT        72887       1 NONE            19:08:13 18/11/2020
                LEDGER_2019_AP_04         SYS_NC00007$                2       1 NONE            19:08:13 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_04         SYS_NC00008$              991       1 NONE            19:08:13 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_04         SYS_NC00009$              991       1 NONE            19:08:13 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_04         SYS_NC00010$                1       1 NONE            19:08:13 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_05         SYS_NC00011$                1       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       19:08:12 18/11/2020
                LEDGER_2019_AP_05         ACCOUNT                   992       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_05         CHARTFIELD1               992       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_05         FISCAL_YEAR                 1       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_05         ACCOUNTING_PERIOD           1       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_05         POSTED_TOTAL_AMT        72378       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_05         SYS_NC00007$                2       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_05         SYS_NC00008$              992       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_05         SYS_NC00009$              992       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_05         SYS_NC00010$                1       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_06         SYS_NC00011$                1       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       19:08:12 18/11/2020
                LEDGER_2019_AP_06         ACCOUNT                   990       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_06         CHARTFIELD1               994       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_06         FISCAL_YEAR                 1       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_06         ACCOUNTING_PERIOD           1       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_06         POSTED_TOTAL_AMT        72101       1 NONE            19:08:12 18/11/2020
                LEDGER_2019_AP_06         SYS_NC00007$                2       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_06         SYS_NC00008$              990       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_06         SYS_NC00009$              994       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_06         SYS_NC00010$                1       1 NONE            19:08:12 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_07         SYS_NC00011$                1       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_07         BUSINESS_UNIT               2       2 FREQUENCY       19:08:11 18/11/2020
                LEDGER_2019_AP_07         ACCOUNT                   989       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_07         CHARTFIELD1               993       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_07         FISCAL_YEAR                 1       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_07         ACCOUNTING_PERIOD           1       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_07         POSTED_TOTAL_AMT        72801       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_07         SYS_NC00007$                2       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_07         SYS_NC00008$              989       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_07         SYS_NC00009$              993       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_07         SYS_NC00010$                1       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_08         SYS_NC00011$                1       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_08         BUSINESS_UNIT               2       2 FREQUENCY       19:08:11 18/11/2020

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019_AP_08         ACCOUNT                   993       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_08         CHARTFIELD1               993       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_08         FISCAL_YEAR                 1       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_08         ACCOUNTING_PERIOD           1       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_08         POSTED_TOTAL_AMT        72386       1 NONE            19:08:11 18/11/2020
                LEDGER_2019_AP_08         SYS_NC00007$                2       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_08         SYS_NC00008$              993       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_08         SYS_NC00009$              993       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_08         SYS_NC00010$                1       1 NONE            19:08:11 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_09         POSTED_TOTAL_AMT        72809       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_09         SYS_NC00007$                2       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_09         SYS_NC00008$              990       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_09         SYS_NC00009$              993       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_09         SYS_NC00010$                1       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_09         SYS_NC00011$                1       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_09         BUSINESS_UNIT               2       2 FREQUENCY       19:08:10 18/11/2020
                LEDGER_2019_AP_09         ACCOUNT                   990       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_09         CHARTFIELD1               993       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_09         FISCAL_YEAR                 1       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_09         ACCOUNTING_PERIOD           1       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_10         SYS_NC00011$                1       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_10         BUSINESS_UNIT               2       2 FREQUENCY       19:08:10 18/11/2020
                LEDGER_2019_AP_10         ACCOUNT                   990       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_10         CHARTFIELD1               994       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_10         FISCAL_YEAR                 1       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_10         ACCOUNTING_PERIOD           1       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_10         POSTED_TOTAL_AMT        72648       1 NONE            19:08:10 18/11/2020
                LEDGER_2019_AP_10         SYS_NC00007$                2       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_10         SYS_NC00008$              990       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_10         SYS_NC00009$              994       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_10         SYS_NC00010$                1       1 NONE            19:08:10 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_11         SYS_NC00011$                1       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_11         BUSINESS_UNIT               2       2 FREQUENCY       19:08:09 18/11/2020
                LEDGER_2019_AP_11         ACCOUNT                   991       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_11         CHARTFIELD1               993       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_11         FISCAL_YEAR                 1       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_11         ACCOUNTING_PERIOD           1       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_11         POSTED_TOTAL_AMT        72624       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_11         SYS_NC00007$                2       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_11         SYS_NC00008$              991       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_11         SYS_NC00009$              993       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_11         SYS_NC00010$                1       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_12         SYS_NC00011$                1       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_12         BUSINESS_UNIT               2       2 FREQUENCY       19:08:09 18/11/2020
                LEDGER_2019_AP_12         ACCOUNT                   992       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_12         CHARTFIELD1               990       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_12         FISCAL_YEAR                 1       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_12         ACCOUNTING_PERIOD           1       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_12         POSTED_TOTAL_AMT        72112       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_12         SYS_NC00007$                2       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_12         SYS_NC00008$              992       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_12         SYS_NC00009$              990       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_12         SYS_NC00010$                1       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_BF         SYS_NC00011$                1       1 NONE            19:08:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       19:08:07 18/11/2020
                LEDGER_2019_AP_BF         ACCOUNT                   993       1 NONE            19:08:07 18/11/2020
                LEDGER_2019_AP_BF         CHARTFIELD1               994       1 NONE            19:08:07 18/11/2020
                LEDGER_2019_AP_BF         FISCAL_YEAR                 1       1 NONE            19:08:07 18/11/2020
                LEDGER_2019_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            19:08:07 18/11/2020
                LEDGER_2019_AP_BF         POSTED_TOTAL_AMT        71176       1 NONE            19:08:07 18/11/2020
                LEDGER_2019_AP_BF         SYS_NC00007$                2       1 NONE            19:08:07 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_BF         SYS_NC00008$              993       1 NONE            19:08:07 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_BF         SYS_NC00009$              994       1 NONE            19:08:07 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_BF         SYS_NC00010$                1       1 NONE            19:08:07 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_CF         SYS_NC00011$                2       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2019_AP_CF         BUSINESS_UNIT               2       2 FREQUENCY       19:08:09 18/11/2020
                LEDGER_2019_AP_CF         ACCOUNT                   752       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_CF         CHARTFIELD1               764       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_CF         FISCAL_YEAR                 1       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_CF         ACCOUNTING_PERIOD           2       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_CF         POSTED_TOTAL_AMT         2000       1 NONE            19:08:09 18/11/2020
                LEDGER_2019_AP_CF         SYS_NC00007$                2       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_CF         SYS_NC00008$              752       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_CF         SYS_NC00009$              764       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_CF         SYS_NC00010$                1       1 NONE            19:08:09 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_01         SYS_NC00011$                1       1 NONE            19:08:18 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       19:08:18 18/11/2020
                LEDGER_2020_AP_01         ACCOUNT                   994       1 NONE            19:08:18 18/11/2020
                LEDGER_2020_AP_01         CHARTFIELD1               994       1 NONE            19:08:18 18/11/2020
                LEDGER_2020_AP_01         FISCAL_YEAR                 1       1 NONE            19:08:18 18/11/2020
                LEDGER_2020_AP_01         ACCOUNTING_PERIOD           1       1 NONE            19:08:18 18/11/2020

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2020_AP_01         POSTED_TOTAL_AMT        72744       1 NONE            19:08:18 18/11/2020
                LEDGER_2020_AP_01         SYS_NC00007$                2       1 NONE            19:08:18 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_01         SYS_NC00008$              994       1 NONE            19:08:18 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_01         SYS_NC00009$              994       1 NONE            19:08:18 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_01         SYS_NC00010$                1       1 NONE            19:08:18 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_02         SYS_NC00011$                1       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       19:08:17 18/11/2020
                LEDGER_2020_AP_02         ACCOUNT                   993       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_02         CHARTFIELD1               998       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_02         FISCAL_YEAR                 1       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_02         ACCOUNTING_PERIOD           1       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_02         POSTED_TOTAL_AMT        72207       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_02         SYS_NC00007$                2       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_02         SYS_NC00008$              993       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_02         SYS_NC00009$              998       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_02         SYS_NC00010$                1       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_03         POSTED_TOTAL_AMT        72650       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_03         SYS_NC00007$                2       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_03         SYS_NC00008$              992       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_03         SYS_NC00009$              992       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_03         SYS_NC00010$                1       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_03         SYS_NC00011$                1       1 NONE            19:08:17 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_03         ACCOUNTING_PERIOD           1       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_03         FISCAL_YEAR                 1       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_03         CHARTFIELD1               992       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_03         ACCOUNT                   992       1 NONE            19:08:17 18/11/2020
                LEDGER_2020_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       19:08:17 18/11/2020
                LEDGER_2020_AP_04         SYS_NC00011$                1       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_04         SYS_NC00010$                1       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_04         SYS_NC00009$              990       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_04         SYS_NC00008$              994       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_04         SYS_NC00007$                2       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_04         POSTED_TOTAL_AMT        72523       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_04         ACCOUNTING_PERIOD           1       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_04         FISCAL_YEAR                 1       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_04         CHARTFIELD1               990       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_04         ACCOUNT                   994       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       19:08:16 18/11/2020
                LEDGER_2020_AP_05         SYS_NC00011$                1       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_05         SYS_NC00010$                1       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_05         SYS_NC00009$              991       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_05         SYS_NC00008$              990       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_05         SYS_NC00007$                2       1 NONE            19:08:16 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_05         POSTED_TOTAL_AMT        73026       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_05         ACCOUNTING_PERIOD           1       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_05         FISCAL_YEAR                 1       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_05         CHARTFIELD1               991       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_05         ACCOUNT                   990       1 NONE            19:08:16 18/11/2020
                LEDGER_2020_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       19:08:16 18/11/2020
                LEDGER_2020_AP_06         SYS_NC00011$                1       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_06         SYS_NC00010$                1       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_06         SYS_NC00009$              993       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_06         SYS_NC00008$              994       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_06         SYS_NC00007$                2       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_06         POSTED_TOTAL_AMT        72488       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_06         ACCOUNTING_PERIOD           1       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_06         FISCAL_YEAR                 1       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_06         CHARTFIELD1               993       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_06         ACCOUNT                   994       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       19:08:15 18/11/2020
                LEDGER_2020_AP_07         SYS_NC00011$                0       0 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_07         BUSINESS_UNIT               0       0 NONE            19:08:19 18/11/2020
                LEDGER_2020_AP_07         ACCOUNT                     0       0 NONE            19:08:19 18/11/2020
                LEDGER_2020_AP_07         CHARTFIELD1                 0       0 NONE            19:08:19 18/11/2020
                LEDGER_2020_AP_07         FISCAL_YEAR                 0       0 NONE            19:08:19 18/11/2020
                LEDGER_2020_AP_07         ACCOUNTING_PERIOD           0       0 NONE            19:08:19 18/11/2020
                LEDGER_2020_AP_07         POSTED_TOTAL_AMT            0       0 NONE            19:08:19 18/11/2020
                LEDGER_2020_AP_07         SYS_NC00007$                0       0 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_07         SYS_NC00008$                0       0 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_07         SYS_NC00009$                0       0 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_07         SYS_NC00010$                0       0 NONE            19:08:19 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_08         SYS_NC00011$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_08         BUSINESS_UNIT               0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_08         ACCOUNT                     0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_08         CHARTFIELD1                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_08         FISCAL_YEAR                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_08         ACCOUNTING_PERIOD           0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_08         POSTED_TOTAL_AMT            0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_08         SYS_NC00007$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_08         SYS_NC00008$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_08         SYS_NC00009$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANALYZED       EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- ------------------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2020_AP_08         SYS_NC00010$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_09         SYS_NC00011$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_09         BUSINESS_UNIT               0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_09         ACCOUNT                     0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_09         CHARTFIELD1                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_09         FISCAL_YEAR                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_09         ACCOUNTING_PERIOD           0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_09         POSTED_TOTAL_AMT            0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_09         SYS_NC00007$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_09         SYS_NC00008$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_09         SYS_NC00009$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_09         SYS_NC00010$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_10         SYS_NC00011$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_10         BUSINESS_UNIT               0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_10         ACCOUNT                     0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_10         CHARTFIELD1                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_10         FISCAL_YEAR                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_10         ACCOUNTING_PERIOD           0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_10         POSTED_TOTAL_AMT            0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_10         SYS_NC00007$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_10         SYS_NC00008$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_10         SYS_NC00009$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_10         SYS_NC00010$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_11         SYS_NC00011$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_11         BUSINESS_UNIT               0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_11         ACCOUNT                     0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_11         CHARTFIELD1                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_11         FISCAL_YEAR                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_11         ACCOUNTING_PERIOD           0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_11         POSTED_TOTAL_AMT            0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_11         SYS_NC00007$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_11         SYS_NC00008$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_11         SYS_NC00009$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_11         SYS_NC00010$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_12         SYS_NC00011$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_12         BUSINESS_UNIT               0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_12         ACCOUNT                     0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_12         CHARTFIELD1                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_12         FISCAL_YEAR                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_12         ACCOUNTING_PERIOD           0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_12         POSTED_TOTAL_AMT            0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_12         SYS_NC00007$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_12         SYS_NC00008$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_12         SYS_NC00009$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_12         SYS_NC00010$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_BF         SYS_NC00011$                1       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       19:08:15 18/11/2020
                LEDGER_2020_AP_BF         ACCOUNT                   994       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_BF         CHARTFIELD1               993       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_BF         FISCAL_YEAR                 1       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_BF         POSTED_TOTAL_AMT        72371       1 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_BF         SYS_NC00007$                2       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_BF         SYS_NC00008$              994       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_BF         SYS_NC00009$              993       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_BF         SYS_NC00010$                1       1 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_CF         SYS_NC00011$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                                    )

                LEDGER_2020_AP_CF         SYS_NC00010$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_CF         SYS_NC00009$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_CF         SYS_NC00008$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_CF         SYS_NC00007$                0       0 NONE            19:08:15 18/11/2020 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_CF         POSTED_TOTAL_AMT            0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_CF         ACCOUNTING_PERIOD           0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_CF         FISCAL_YEAR                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_CF         CHARTFIELD1                 0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_CF         ACCOUNT                     0       0 NONE            19:08:15 18/11/2020
                LEDGER_2020_AP_CF         BUSINESS_UNIT               0       0 NONE            19:08:15 18/11/2020


308 rows selected.

Elapsed: 00:00:00.48
19:08:59 SQL> @@mvsql
19:08:59 SQL> REM mvsql.sql
19:08:59 SQL> set autotrace off
19:08:59 SQL> 
19:08:59 SQL> REM 2018
19:08:59 SQL> set lines 200 pages 999
19:08:59 SQL> explain plan for
19:08:59   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:08:59   3  FROM   PS_LEDGER A
19:08:59   4  ,      PSTREESELECT05 L1
19:08:59   5  ,      PSTREESELECT10 L
19:08:59   6  ,      PSTREESELECT10 L2
19:08:59   7  WHERE  A.LEDGER='ACTUALS'
19:08:59   8  AND    A.FISCAL_YEAR=2018
19:08:59   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
19:08:59  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:08:59  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:08:59  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:08:59  13  AND    A.CURRENCY_CD='GBP'
19:08:59  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:08:59  15  /

Explained.

Elapsed: 00:00:00.18
19:09:00 SQL> @@xp
19:09:00 SQL> REM xp.sql
19:09:00 SQL> REM spool xp
19:09:00 SQL> REM set pages 9999 lines 200 autotrace off
19:09:00 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3827045647

------------------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                   |  1079 |    97K|  2234   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY               |                   |  1079 |    97K|  2234   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                  |                   |  1079 |    97K|  2233   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN          | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                 |                   |  4197 |   303K|  2231   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN     |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN        | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT             |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN       | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE   |                   | 39970 |  1756K|  2228   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR|                   | 39970 |  1756K|  2228   (1)| 00:00:01 |     2 |     7 |
|* 11 |       TABLE ACCESS FULL      | PS_LEDGER         | 39970 |  1756K|  2228   (1)| 00:00:01 |     1 |    14 |
------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDAT
        A[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L
        2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.13
19:09:00 SQL> REM spool off
19:09:00 SQL> 
19:09:00 SQL> REM 2019
19:09:00 SQL> explain plan for
19:09:00   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:00   3  FROM   PS_LEDGER A
19:09:00   4  ,      PSTREESELECT05 L1
19:09:00   5  ,      PSTREESELECT10 L
19:09:00   6  ,      PSTREESELECT10 L2
19:09:00   7  WHERE  A.LEDGER='ACTUALS'
19:09:00   8  AND    A.FISCAL_YEAR=2019
19:09:00   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
19:09:00  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:00  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:00  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:00  13  AND    A.CURRENCY_CD='GBP'
19:09:00  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:00  15  /

Explained.

Elapsed: 00:00:00.27
19:09:00 SQL> @@xp
19:09:00 SQL> REM xp.sql
19:09:00 SQL> REM spool xp
19:09:00 SQL> REM set pages 9999 lines 200 autotrace off
19:09:00 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 589110139

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1860 |   147K|   426   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1860 |   147K|   426   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1860 |   147K|   425   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  7229 |   437K|   423   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 68783 |  2216K|   420   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR     |                   | 68783 |  2216K|   420   (1)| 00:00:01 |     2 |     7 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 68783 |  2216K|   420   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.13
19:09:00 SQL> REM spool off
19:09:00 SQL> 
19:09:00 SQL> REM 2020
19:09:00 SQL> explain plan for
19:09:00   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:00   3  FROM   PS_LEDGER A
19:09:00   4  ,      PSTREESELECT05 L1
19:09:00   5  ,      PSTREESELECT10 L
19:09:00   6  ,      PSTREESELECT10 L2
19:09:00   7  WHERE  A.LEDGER='ACTUALS'
19:09:00   8  AND    A.FISCAL_YEAR=2020
19:09:00   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
19:09:00  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:00  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:00  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:00  13  AND    A.CURRENCY_CD='GBP'
19:09:00  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:00  15  /

Explained.

Elapsed: 00:00:00.25
19:09:00 SQL> @@xp
19:09:00 SQL> REM xp.sql
19:09:00 SQL> REM spool xp
19:09:00 SQL> REM set pages 9999 lines 200 autotrace off
19:09:00 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 589110139

-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   | 13427 |  1062K|       |   683   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   | 13427 |  1062K|  1232K|   683   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   | 13427 |  1062K|       |   427   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   | 52141 |  3156K|       |   424   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   |   496K|    15M|       |   420   (1)| 00:00:01 |     2 |     2 |
|  10 |      PARTITION RANGE ITERATOR     |                   |   496K|    15M|       |   420   (1)| 00:00:01 |     2 |     7 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   496K|    15M|       |   420   (1)| 00:00:01 |    15 |    28 |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2020)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


84 rows selected.

Elapsed: 00:00:00.13
19:09:01 SQL> REM spool off
19:09:01 SQL> 
19:09:01 SQL> explain plan for
19:09:01   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:01   3  FROM   PS_LEDGER A
19:09:01   4  ,      PSTREESELECT05 L1
19:09:01   5  ,      PSTREESELECT10 L
19:09:01   6  ,      PSTREESELECT10 L2
19:09:01   7  WHERE  A.LEDGER='ACTUALS'
19:09:01   8  AND    A.FISCAL_YEAR=2019
19:09:01   9  AND    A.ACCOUNTING_PERIOD = 7
19:09:01  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:01  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:01  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:01  13  AND    A.CURRENCY_CD='GBP'
19:09:01  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:01  15  /

Explained.

Elapsed: 00:00:00.25
19:09:01 SQL> @@xp
19:09:01 SQL> REM xp.sql
19:09:01 SQL> REM spool xp
19:09:01 SQL> REM set pages 9999 lines 200 autotrace off
19:09:01 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3667645850

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  2000 |   158K|    78   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  2000 |   158K|    78   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  2000 |   158K|    76   (0)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  7698 |   466K|    74   (0)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 72801 |  2346K|    71   (0)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE SINGLE       |                   | 72801 |  2346K|    71   (0)| 00:00:01 |     8 |     8 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 72801 |  2346K|    71   (0)| 00:00:01 |     8 |     8 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"=7 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.13
19:09:01 SQL> REM spool off
19:09:01 SQL> 
19:09:01 SQL> REM 2020
19:09:01 SQL> explain plan for
19:09:01   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:01   3  FROM   PS_LEDGER A
19:09:01   4  ,      PSTREESELECT05 L1
19:09:01   5  ,      PSTREESELECT10 L
19:09:01   6  ,      PSTREESELECT10 L2
19:09:01   7  WHERE  A.LEDGER='ACTUALS'
19:09:01   8  AND    A.FISCAL_YEAR=2020
19:09:01   9  AND    (A.ACCOUNTING_PERIOD = 7)
19:09:01  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:01  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:01  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:01  13  AND    A.CURRENCY_CD='GBP'
19:09:01  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:01  15  /

Explained.

Elapsed: 00:00:00.23
19:09:01 SQL> @@xp
19:09:01 SQL> REM xp.sql
19:09:01 SQL> REM spool xp
19:09:01 SQL> REM set pages 9999 lines 200 autotrace off
19:09:01 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1850895979

--------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
--------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                         |                   |     1 |   105 |     6  (17)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                           |                   |     1 |   105 |     6  (17)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                              |                   |     1 |   105 |     5   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                          |                   |     1 |   105 |     5   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                 |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                           |                   |     1 |    86 |     4   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                       |                   |     1 |    86 |     4   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR              |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                        |                   |     1 |    68 |     3   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                    |                   |     1 |    68 |     3   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR           |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE        |                   |     1 |    57 |     2   (0)| 00:00:01 |     2 |     2 |
|    12 |             PARTITION RANGE SINGLE       |                   |     1 |    57 |     2   (0)| 00:00:01 |     8 |     8 |
|  * 13 |              MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |     1 |    57 |     2   (0)| 00:00:01 |    22 |    22 |
|  * 14 |           INDEX RANGE SCAN               | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 15 |          INDEX RANGE SCAN                | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 16 |        INDEX RANGE SCAN                  | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 17 |       INDEX RANGE SCAN                   | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 18 |     INDEX RANGE SCAN                     | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 19 |    INDEX RANGE SCAN                      | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
--------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
  13 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4
  14 - SEL$1E60250C / L1@SEL$1
  15 - SEL$1E60250C / L1@SEL$1
  16 - SEL$1E60250C / L@SEL$1
  17 - SEL$1E60250C / L@SEL$1
  18 - SEL$1E60250C / L2@SEL$1
  19 - SEL$1E60250C / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      USE_NL(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L"@"SEL$1")
      USE_NL(@"SEL$1E60250C" "L1"@"SEL$1")
      LEADING(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"=7 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2020)
  14 - access("L1"."SELECTOR_NUM"=30982 AND "MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  15 - access("L1"."SELECTOR_NUM"=30982)
  16 - access("L"."SELECTOR_NUM"=30985 AND "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
  17 - access("L"."SELECTOR_NUM"=30985)
  18 - access("L2"."SELECTOR_NUM"=30984 AND "MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
  19 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_
        2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s
        ></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]>
        </s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDAT
        A[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></
        h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v></
        o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><!
        [CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></f><
        /q>


104 rows selected.

Elapsed: 00:00:00.18
19:09:01 SQL> REM spool off
19:09:01 SQL> 
19:09:01 SQL> set autotrace off
19:09:01 SQL> 
19:09:01 SQL> @@pop2020m7
19:09:01 SQL> REM pop2020m7.sql
19:09:01 SQL> set autotrace off
19:09:01 SQL> insert into ps_ledger
19:09:01   2  with n as (
19:09:01   3  SELECT rownum n from dual connect by level <= 1e6/13
19:09:01   4  --), fy as (
19:09:01   5  --SELECT 2017+rownum fiscal_year FROM dual CONNECT BY level <= 4
19:09:01   6  --), ap as (
19:09:01   7  --SELECT FLOOR(dbms_random.value(0,13)) accounting_period FROM dual connect by level <= 998
19:09:01   8  --UNION ALL SELECT 998 FROM DUAL CONNECT BY LEVEL <= 1
19:09:01   9  --UNION ALL SELECT 999 FROM DUAL CONNECT BY LEVEL <= 1
19:09:01  10  --), l as (
19:09:01  11  --SELECT 'ACTUALS' ledger FROM DUAL CONNECT BY LEVEL <= 10
19:09:01  12  --UNION ALL SELECT 'BUDGET' FROM DUAL
19:09:01  13  )
19:09:01  14  select 'BU'||LTRIM(TO_CHAR(CASE WHEN dbms_random.value <= .9 THEN 1 ELSE 2 END,'000')) business_unit
19:09:01  15  ,      'ACTUALS' ledger
19:09:01  16  ,      'ACC'||LTRIM(TO_CHAR(999*SQRT(dbms_random.value),'000')) account
19:09:01  17  ,      'ALTACCT'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) altacct
19:09:01  18  ,      'DEPT'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) deptid
19:09:01  19  ,      'OPUNIT'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) operating_unit
19:09:01  20  ,      'P'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) product
19:09:01  21  ,      'FUND'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) fund_code
19:09:01  22  ,      'CLAS'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) class_fld
19:09:01  23  ,      'PROD'||LTRIM(TO_CHAR(9*dbms_random.value,'0')) program_code
19:09:01  24  ,      ' ' budget_ref
19:09:01  25  ,      'AF'||LTRIM(TO_CHAR(999*dbms_random.value,'000')) affiliate
19:09:01  26  ,      'AFI'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) affiliate_intra1
19:09:01  27  ,      'AFI'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) affiliate_intra2
19:09:01  28  ,      'CF'||LTRIM(TO_CHAR(  999*SQRT(dbms_random.value),'000')) chartfield1
19:09:01  29  ,      'CF'||LTRIM(TO_CHAR(99999*dbms_random.value,'00000')) chartfield2
19:09:01  30  ,      'CF'||LTRIM(TO_CHAR( 9999*dbms_random.value,'0000')) chartfield3
19:09:01  31  ,      'PRJ'||LTRIM(TO_CHAR(9999*dbms_random.value,'0000')) project_id
19:09:01  32  ,      'BK'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) book_code
19:09:01  33  ,      'GL'||LTRIM(TO_CHAR(99*dbms_random.value,'00')) gl_adjust_type
19:09:01  34  ,      'GBP' currency_cd
19:09:01  35  ,      ' ' statistics_code
19:09:01  36  ,      2020 fiscal_year
19:09:01  37  ,      7 accounting_period
19:09:01  38  ,      dbms_random.value(0,1e6) posted_total_amt
19:09:01  39  ,      0 posted_base_amt
19:09:01  40  ,      0 posted_tran_amt
19:09:01  41  ,      'GBP' base_currency
19:09:01  42  ,      SYSDATE dttm_stamp_sec
19:09:01  43  ,      0 process_instance
19:09:01  44  FROM   n
19:09:01  45  --WHERE  l.ledger = 'ACTUALS'
19:09:01  46  --AND    fy.fiscal_year = 2020
19:09:01  47  --AND    ap.accounting_period = 7
19:09:01  48  /

76923 rows created.

Elapsed: 00:00:48.43
19:09:50 SQL> set lines 200 pages 999 autotrace off
19:09:50 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               COMPLETE VALID

Elapsed: 00:00:00.00
19:09:50 SQL> commit;

Commit complete.

Elapsed: 00:00:00.03
19:09:50 SQL> column owner format a10
19:09:50 SQL> column table_name format a15
19:09:50 SQL> column mview_name format a15
19:09:50 SQL> column detailobj_owner format a10 heading 'Detailobj|Owner'
19:09:50 SQL> column detailobj_name  format a15
19:09:50 SQL> column detailobj_alias format a20
19:09:50 SQL> column detail_partition_name format a20
19:09:50 SQL> column detail_subpartition_name format a20
19:09:50 SQL> column parent_table_partition format a20
19:09:50 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME      STALENESS           LAST_REF COMPILE_STATE
--------------- ------------------- -------- -------------------
MV_LEDGER_2020  NEEDS_COMPILE       COMPLETE NEEDS_COMPILE

Elapsed: 00:00:00.01
19:09:50 SQL> select * from user_mview_detail_relations;

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAILOBJ DETAILOBJ_ALIAS      D NUM_FRESH_PCT_PARTITIONS NUM_STALE_PCT_PARTITIONS
---------- --------------- ---------- --------------- --------- -------------------- - ------------------------ ------------------------
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       TABLE     PS_LEDGER            Y                       55                        1

Elapsed: 00:00:06.32
19:09:56 SQL> select * from user_mview_detail_partition;

no rows selected

Elapsed: 00:00:00.00
19:09:56 SQL> select * from user_mview_detail_subpartition where freshness != 'FRESH';

                           Detailobj
OWNER      MVIEW_NAME      Owner      DETAILOBJ_NAME  DETAIL_PARTITION_NAM DETAIL_SUBPARTITION_ DETAIL_SUBPARTITION_POSITION FRESH
---------- --------------- ---------- --------------- -------------------- -------------------- ---------------------------- -----
SCOTT      MV_LEDGER_2020  SCOTT      PS_LEDGER       LEDGER_2020          LEDGER_2020_AP_07                               8 STALE

Elapsed: 00:00:00.01
19:09:56 SQL> 
19:09:56 SQL> @@mvsql
19:09:56 SQL> REM mvsql.sql
19:09:56 SQL> set autotrace off
19:09:56 SQL> 
19:09:56 SQL> REM 2018
19:09:56 SQL> set lines 200 pages 999
19:09:56 SQL> explain plan for
19:09:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:56   3  FROM   PS_LEDGER A
19:09:56   4  ,      PSTREESELECT05 L1
19:09:56   5  ,      PSTREESELECT10 L
19:09:56   6  ,      PSTREESELECT10 L2
19:09:56   7  WHERE  A.LEDGER='ACTUALS'
19:09:56   8  AND    A.FISCAL_YEAR=2018
19:09:56   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
19:09:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:56  13  AND    A.CURRENCY_CD='GBP'
19:09:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:56  15  /

Explained.

Elapsed: 00:00:00.16
19:09:56 SQL> @@xp
19:09:56 SQL> REM xp.sql
19:09:56 SQL> REM spool xp
19:09:56 SQL> REM set pages 9999 lines 200 autotrace off
19:09:56 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3827045647

------------------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                   |  1079 |    97K|  2234   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY               |                   |  1079 |    97K|  2234   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                  |                   |  1079 |    97K|  2233   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN          | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                 |                   |  4197 |   303K|  2231   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN     |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN        | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT             |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN       | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE   |                   | 39970 |  1756K|  2228   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR|                   | 39970 |  1756K|  2228   (1)| 00:00:01 |     2 |     7 |
|* 11 |       TABLE ACCESS FULL      | PS_LEDGER         | 39970 |  1756K|  2228   (1)| 00:00:01 |     1 |    14 |
------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDAT
        A[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L
        2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.11
19:09:56 SQL> REM spool off
19:09:56 SQL> 
19:09:56 SQL> REM 2019
19:09:56 SQL> explain plan for
19:09:56   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:56   3  FROM   PS_LEDGER A
19:09:56   4  ,      PSTREESELECT05 L1
19:09:56   5  ,      PSTREESELECT10 L
19:09:56   6  ,      PSTREESELECT10 L2
19:09:56   7  WHERE  A.LEDGER='ACTUALS'
19:09:56   8  AND    A.FISCAL_YEAR=2019
19:09:56   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
19:09:56  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:56  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:56  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:56  13  AND    A.CURRENCY_CD='GBP'
19:09:56  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:56  15  /

Explained.

Elapsed: 00:00:00.25
19:09:57 SQL> @@xp
19:09:57 SQL> REM xp.sql
19:09:57 SQL> REM spool xp
19:09:57 SQL> REM set pages 9999 lines 200 autotrace off
19:09:57 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 589110139

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1860 |   147K|   426   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1860 |   147K|   426   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1860 |   147K|   425   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  7229 |   437K|   423   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 68783 |  2216K|   420   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR     |                   | 68783 |  2216K|   420   (1)| 00:00:01 |     2 |     7 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 68783 |  2216K|   420   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.14
19:09:57 SQL> REM spool off
19:09:57 SQL> 
19:09:57 SQL> REM 2020
19:09:57 SQL> explain plan for
19:09:57   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:57   3  FROM   PS_LEDGER A
19:09:57   4  ,      PSTREESELECT05 L1
19:09:57   5  ,      PSTREESELECT10 L
19:09:57   6  ,      PSTREESELECT10 L2
19:09:57   7  WHERE  A.LEDGER='ACTUALS'
19:09:57   8  AND    A.FISCAL_YEAR=2020
19:09:57   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
19:09:57  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:57  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:57  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:57  13  AND    A.CURRENCY_CD='GBP'
19:09:57  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:57  15  /

Explained.

Elapsed: 00:00:00.24
19:09:57 SQL> @@xp
19:09:57 SQL> REM xp.sql
19:09:57 SQL> REM spool xp
19:09:57 SQL> REM set pages 9999 lines 200 autotrace off
19:09:57 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 589110139

-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   | 13427 |  1062K|       |   683   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   | 13427 |  1062K|  1232K|   683   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   | 13427 |  1062K|       |   427   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   | 52141 |  3156K|       |   424   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   |   496K|    15M|       |   420   (1)| 00:00:01 |     2 |     2 |
|  10 |      PARTITION RANGE ITERATOR     |                   |   496K|    15M|       |   420   (1)| 00:00:01 |     2 |     7 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   496K|    15M|       |   420   (1)| 00:00:01 |    15 |    28 |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2020)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


84 rows selected.

Elapsed: 00:00:00.14
19:09:57 SQL> REM spool off
19:09:57 SQL> 
19:09:57 SQL> explain plan for
19:09:57   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:57   3  FROM   PS_LEDGER A
19:09:57   4  ,      PSTREESELECT05 L1
19:09:57   5  ,      PSTREESELECT10 L
19:09:57   6  ,      PSTREESELECT10 L2
19:09:57   7  WHERE  A.LEDGER='ACTUALS'
19:09:57   8  AND    A.FISCAL_YEAR=2019
19:09:57   9  AND    A.ACCOUNTING_PERIOD = 7
19:09:57  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:57  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:57  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:57  13  AND    A.CURRENCY_CD='GBP'
19:09:57  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:57  15  /

Explained.

Elapsed: 00:00:00.24
19:09:57 SQL> @@xp
19:09:57 SQL> REM xp.sql
19:09:57 SQL> REM spool xp
19:09:57 SQL> REM set pages 9999 lines 200 autotrace off
19:09:57 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3667645850

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  2000 |   158K|    78   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  2000 |   158K|    78   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  2000 |   158K|    76   (0)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  7698 |   466K|    74   (0)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 72801 |  2346K|    71   (0)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE SINGLE       |                   | 72801 |  2346K|    71   (0)| 00:00:01 |     8 |     8 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 72801 |  2346K|    71   (0)| 00:00:01 |     8 |     8 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"=7 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.13
19:09:58 SQL> REM spool off
19:09:58 SQL> 
19:09:58 SQL> REM 2020
19:09:58 SQL> explain plan for
19:09:58   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:09:58   3  FROM   PS_LEDGER A
19:09:58   4  ,      PSTREESELECT05 L1
19:09:58   5  ,      PSTREESELECT10 L
19:09:58   6  ,      PSTREESELECT10 L2
19:09:58   7  WHERE  A.LEDGER='ACTUALS'
19:09:58   8  AND    A.FISCAL_YEAR=2020
19:09:58   9  AND    (A.ACCOUNTING_PERIOD = 7)
19:09:58  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:09:58  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:09:58  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:09:58  13  AND    A.CURRENCY_CD='GBP'
19:09:58  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:09:58  15  /

Explained.

Elapsed: 00:00:00.14
19:09:58 SQL> @@xp
19:09:58 SQL> REM xp.sql
19:09:58 SQL> REM spool xp
19:09:58 SQL> REM set pages 9999 lines 200 autotrace off
19:09:58 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1321682226

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|    12 |             PARTITION RANGE SINGLE                    |                   |     1 |    44 |     3   (0)| 00:00:01 |     8 |     8 |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    36 |    36 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    36 |    36 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.17
19:09:58 SQL> REM spool off
19:09:58 SQL> 
19:09:58 SQL> set autotrace off
19:09:58 SQL> 
19:09:58 SQL> @@mvtrc
19:09:58 SQL> REM mvtrc.sql
19:09:58 SQL> disconnect
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.9.0.0.0
19:09:58 SQL> connect scott/tiger@oracle_pdb
Connected.
19:09:58 SQL> 
19:09:58 SQL> column name format a20
19:09:58 SQL> column value format a70
19:09:58 SQL> select * from v$diag_info where name like '%Trace%';

   INST_ID NAME                 VALUE                                                                      CON_ID
---------- -------------------- ---------------------------------------------------------------------- ----------
         1 Diag Trace           /u01/app/oracle/diag/rdbms/oracle/oracle/trace                                  0
         1 Default Trace File   /u01/app/oracle/diag/rdbms/oracle/oracle/trace/oracle_ora_15829.trc             0

Elapsed: 00:00:00.01
19:09:58 SQL> 
19:09:58 SQL> alter session set tracefile_identifier=PCT;

Session altered.

Elapsed: 00:00:00.00
19:09:58 SQL> alter session set sql_trace = true;

Session altered.

Elapsed: 00:00:00.00
19:09:58 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
BEGIN dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE); END;

*
ERROR at line 1:
ORA-20000: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3020
ORA-06512: at "SYS.DBMS_IREFRESH", line 186
ORA-06512: at "SYS.DBMS_ISNAPSHOT", line 189
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 2852
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3263
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3295
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 16
ORA-06512: at line 1


Elapsed: 00:00:00.01
19:09:58 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:24.78
19:10:23 SQL> alter session set sql_trace = false;

Session altered.

Elapsed: 00:00:00.00
19:10:23 SQL> 
19:10:23 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE);
BEGIN dbms_mview.refresh(list=>'MV_LEDGER_2019',method=>'P',atomic_refresh=>FALSE); END;

*
ERROR at line 1:
ORA-20000: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3020
ORA-06512: at "SYS.DBMS_IREFRESH", line 186
ORA-06512: at "SYS.DBMS_ISNAPSHOT", line 189
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 2852
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3263
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3295
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 16
ORA-06512: at line 1


Elapsed: 00:00:00.00
19:10:23 SQL> exec dbms_mview.refresh(list=>'MV_LEDGER_2020',method=>'P',atomic_refresh=>FALSE);

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.19
19:10:23 SQL> 
19:10:23 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2019');
BEGIN dbms_stats.gather_Table_stats(user,'MV_LEDGER_2019'); END;

*
ERROR at line 1:
ORA-20000: Unable to analyze TABLE "SCOTT"."MV_LEDGER_2019", insufficient privileges or does not exist
ORA-06512: at "SYS.DBMS_STATS", line 40753
ORA-06512: at "SYS.DBMS_STATS", line 40026
ORA-06512: at "SYS.DBMS_STATS", line 40185
ORA-06512: at "SYS.DBMS_STATS", line 40734
ORA-06512: at line 1


Elapsed: 00:00:00.02
19:10:23 SQL> exec dbms_stats.gather_Table_stats(user,'MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:51.08
19:11:14 SQL> 
19:11:14 SQL> @@mvvol
19:11:14 SQL> REM mvvol.sql
19:11:14 SQL> 
19:11:14 SQL> set autotrace off
19:11:14 SQL> break on table_name skip 1 on partition_name
19:11:14 SQL> column table_name format a15
19:11:14 SQL> column column_name format a20
19:11:14 SQL> column mview_name format a20
19:11:14 SQL> column partition_position format 999 heading 'Part|Pos'
19:11:14 SQL> column subpartition_position format 999 heading 'Sub-|Part|Pos'
19:11:14 SQL> column partition_name format a20
19:11:14 SQL> column subpartition_name format a25
19:11:14 SQL> column num_rows format 9999999
19:11:14 SQL> column num_distinct heading 'Num|Distinct' format 9999999
19:11:14 SQL> column num_buckets heading 'Num|Buckets'	format 9999
19:11:14 SQL> column blocks format 99999
19:11:14 SQL> column rpb format 999.9 heading 'Rows|per|Block'
19:11:14 SQL> SELECT MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE FROM USER_MVIEWS ORDER BY MVIEW_NAME;

MVIEW_NAME           STALENESS           LAST_REF COMPILE_STATE
-------------------- ------------------- -------- -------------------
MV_LEDGER_2020       FRESH               FAST_PCT VALID

Elapsed: 00:00:00.00
19:11:14 SQL> 
19:11:14 SQL> select count(*) from mv_ledger_2019;
select count(*) from mv_ledger_2019
                     *
ERROR at line 1:
ORA-00942: table or view does not exist


Elapsed: 00:00:00.00
19:11:14 SQL> select count(*) from mv_ledger_2020;

  COUNT(*)
----------
   1527494

Elapsed: 00:00:00.09
19:11:14 SQL> 
19:11:14 SQL> select a.table_name, a.partition_position, a.partition_name, a.subpartition_position, a.subpartition_name
19:11:14   2  , a.num_rows, a.blocks, a.num_rows/nullif(a.blocks,0) rpb
19:11:14   3  , COALESCE(c.compression, b.compression) compression
19:11:14   4  , COALESCE(c.compress_for, b.compress_for) compress_for
19:11:14   5  from user_tab_statistics a
19:11:14   6  	LEFT OUTER JOIN user_tab_partitions b
19:11:14   7  	  ON a.table_name = b.table_name
19:11:14   8  	  AND a.partition_name = b.partition_name
19:11:14   9  	LEFT OUTER JOIN user_tab_subpartitions c
19:11:14  10  	  ON a.table_name = c.table_name
19:11:14  11  	  AND a.partition_name = c.partition_name
19:11:14  12  	  AND a.subpartition_name = c.subpartition_name
19:11:14  13  where a.table_name like '%LEDGER%'
19:11:14  14  order by a.table_name, a.partition_position, a.subpartition_position nulls first
19:11:14  15  /

                                          Sub-                                             Rows
                Part                      Part                                              per
TABLE_NAME       Pos PARTITION_NAME        Pos SUBPARTITION_NAME         NUM_ROWS BLOCKS  Block COMPRESS COMPRESS_FOR
--------------- ---- -------------------- ---- ------------------------- -------- ------ ------ -------- ------------------------------
MV_LEDGER_2020     1 LEDGER_2019                                           946478   3360  281.7 ENABLED  BASIC
                   1                         1 LEDGER_2019_AP_BF            72513    256  283.3 ENABLED  BASIC
                   1                         2 LEDGER_2019_AP_01            72834    256  284.5 ENABLED  BASIC
                   1                         3 LEDGER_2019_AP_02            72863    256  284.6 ENABLED  BASIC
                   1                         4 LEDGER_2019_AP_03            72743    256  284.2 ENABLED  BASIC
                   1                         5 LEDGER_2019_AP_04            72887    256  284.7 ENABLED  BASIC
                   1                         6 LEDGER_2019_AP_05            72378    256  282.7 ENABLED  BASIC
                   1                         7 LEDGER_2019_AP_06            72101    256  281.6 ENABLED  BASIC
                   1                         8 LEDGER_2019_AP_07            72801    256  284.4 ENABLED  BASIC
                   1                         9 LEDGER_2019_AP_08            72386    256  282.8 ENABLED  BASIC
                   1                        10 LEDGER_2019_AP_09            72809    256  284.4 ENABLED  BASIC
                   1                        11 LEDGER_2019_AP_10            72726    256  284.1 ENABLED  BASIC
                   1                        12 LEDGER_2019_AP_11            72624    256  283.7 ENABLED  BASIC
                   1                        13 LEDGER_2019_AP_12            72813    256  284.4 ENABLED  BASIC
                   1                        14 LEDGER_2019_AP_CF             2000     32   62.5 ENABLED  BASIC
                   2 LEDGER_2020                                           581016   2016  288.2 ENABLED  BASIC
                   2                         1 LEDGER_2020_AP_BF            72371    251  288.3 ENABLED  BASIC
                   2                         2 LEDGER_2020_AP_01            72907    253  288.2 ENABLED  BASIC
                   2                         3 LEDGER_2020_AP_02            72207    251  287.7 ENABLED  BASIC
                   2                         4 LEDGER_2020_AP_03            72650    252  288.3 ENABLED  BASIC
                   2                         5 LEDGER_2020_AP_04            72523    252  287.8 ENABLED  BASIC
                   2                         6 LEDGER_2020_AP_05            73026    253  288.6 ENABLED  BASIC
                   2                         7 LEDGER_2020_AP_06            72504    252  287.7 ENABLED  BASIC
                   2                         8 LEDGER_2020_AP_07            72828    252  289.0 ENABLED  BASIC
                   2                         9 LEDGER_2020_AP_08                0      0        ENABLED  BASIC
                   2                        10 LEDGER_2020_AP_09                0      0        ENABLED  BASIC
                   2                        11 LEDGER_2020_AP_10                0      0        ENABLED  BASIC
                   2                        12 LEDGER_2020_AP_11                0      0        ENABLED  BASIC
                   2                        13 LEDGER_2020_AP_12                0      0        ENABLED  BASIC
                   2                        14 LEDGER_2020_AP_CF                0      0        ENABLED  BASIC
                                                                          1527494   5376  284.1

PS_LEDGER          1 LEDGER_2018                                          1100000  17864   61.6 ENABLED  BASIC
                   1                         1 LEDGER_2018_AP_BF            84690   1374   61.6 ENABLED  BASIC
                   1                         2 LEDGER_2018_AP_01            84354   1368   61.7 ENABLED  BASIC
                   1                         3 LEDGER_2018_AP_02            84525   1371   61.7 ENABLED  BASIC
                   1                         4 LEDGER_2018_AP_03            84161   1366   61.6 ENABLED  BASIC
                   1                         5 LEDGER_2018_AP_04            84115   1365   61.6 ENABLED  BASIC
                   1                         6 LEDGER_2018_AP_05            83962   1363   61.6 ENABLED  BASIC
                   1                         7 LEDGER_2018_AP_06            84211   1366   61.6 ENABLED  BASIC
                   1                         8 LEDGER_2018_AP_07            84549   1372   61.6 ENABLED  BASIC
                   1                         9 LEDGER_2018_AP_08            84743   1375   61.6 ENABLED  BASIC
                   1                        10 LEDGER_2018_AP_09            84729   1374   61.7 ENABLED  BASIC
                   1                        11 LEDGER_2018_AP_10            84533   1371   61.7 ENABLED  BASIC
                   1                        12 LEDGER_2018_AP_11            84638   1373   61.6 ENABLED  BASIC
                   1                        13 LEDGER_2018_AP_12            84590   1373   61.6 ENABLED  BASIC
                   1                        14 LEDGER_2018_AP_CF             2200     53   41.5 ENABLED  BASIC
                   2 LEDGER_2019                                          1100000  17862   61.6 ENABLED  BASIC
                   2                         1 LEDGER_2019_AP_BF            84295   1367   61.7 ENABLED  BASIC
                   2                         2 LEDGER_2019_AP_01            84589   1372   61.7 ENABLED  BASIC
                   2                         3 LEDGER_2019_AP_02            84653   1373   61.7 ENABLED  BASIC
                   2                         4 LEDGER_2019_AP_03            84528   1371   61.7 ENABLED  BASIC
                   2                         5 LEDGER_2019_AP_04            84898   1377   61.7 ENABLED  BASIC
                   2                         6 LEDGER_2019_AP_05            84177   1366   61.6 ENABLED  BASIC
                   2                         7 LEDGER_2019_AP_06            84095   1365   61.6 ENABLED  BASIC
                   2                         8 LEDGER_2019_AP_07            84456   1370   61.6 ENABLED  BASIC
                   2                         9 LEDGER_2019_AP_08            83995   1363   61.6 ENABLED  BASIC
                   2                        10 LEDGER_2019_AP_09            84648   1373   61.7 ENABLED  BASIC
                   2                        11 LEDGER_2019_AP_10            84491   1371   61.6 ENABLED  BASIC
                   2                        12 LEDGER_2019_AP_11            84447   1370   61.6 ENABLED  BASIC
                   2                        13 LEDGER_2019_AP_12            84528   1371   61.7 ENABLED  BASIC
                   2                        14 LEDGER_2019_AP_CF             2200     53   41.5 ENABLED  BASIC
                   3 LEDGER_2020                                           636818  16762   38.0 NONE
                   3                         1 LEDGER_2020_AP_BF            84141   2178   38.6 DISABLED
                   3                         2 LEDGER_2020_AP_01            84824   2224   38.1 DISABLED
                   3                         3 LEDGER_2020_AP_02            84024   2204   38.1 DISABLED
                   3                         4 LEDGER_2020_AP_03            84451   2215   38.1 DISABLED
                   3                         5 LEDGER_2020_AP_04            84279   2210   38.1 DISABLED
                   3                         6 LEDGER_2020_AP_05            84788   2223   38.1 DISABLED
                   3                         7 LEDGER_2020_AP_06            84164   2207   38.1 DISABLED
                   3                         8 LEDGER_2020_AP_07             7788    216   36.1 DISABLED
                   3                         9 LEDGER_2020_AP_08             7607    212   35.9 DISABLED
                   3                        10 LEDGER_2020_AP_09             7654    213   35.9 DISABLED
                   3                        11 LEDGER_2020_AP_10             7785    216   36.0 DISABLED
                   3                        12 LEDGER_2020_AP_11             7548    210   35.9 DISABLED
                   3                        13 LEDGER_2020_AP_12             7565    210   36.0 DISABLED
                   3                        14 LEDGER_2020_AP_CF              200     24    8.3 DISABLED
                   4 LEDGER_2021                                           100000   2790   35.8 NONE
                   4                         1 LEDGER_2021_AP_BF             7721    212   36.4 DISABLED
                   4                         2 LEDGER_2021_AP_01             7607    211   36.1 DISABLED
                   4                         3 LEDGER_2021_AP_02             7483    208   36.0 DISABLED
                   4                         4 LEDGER_2021_AP_03             7491    208   36.0 DISABLED
                   4                         5 LEDGER_2021_AP_04             7599    211   36.0 DISABLED
                   4                         6 LEDGER_2021_AP_05             7795    216   36.1 DISABLED
                   4                         7 LEDGER_2021_AP_06             7643    212   36.1 DISABLED
                   4                         8 LEDGER_2021_AP_07             7682    213   36.1 DISABLED
                   4                         9 LEDGER_2021_AP_08             7785    216   36.0 DISABLED
                   4                        10 LEDGER_2021_AP_09             7817    216   36.2 DISABLED
                   4                        11 LEDGER_2021_AP_10             7779    216   36.0 DISABLED
                   4                        12 LEDGER_2021_AP_11             7788    216   36.1 DISABLED
                   4                        13 LEDGER_2021_AP_12             7610    211   36.1 DISABLED
                   4                        14 LEDGER_2021_AP_CF              200     24    8.3 DISABLED
                                                                          2936818  55278   53.1


92 rows selected.

Elapsed: 00:00:00.07
19:11:14 SQL> 
19:11:14 SQL> column extension format a40
19:11:14 SQL> select s.table_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
19:11:14   2  from user_tab_col_statistics s
19:11:14   3  	LEFT OUTER JOIN user_stat_extensions e
19:11:14   4  	ON e.table_name = s.table_name
19:11:14   5  	AND e.extension_name = s.column_name
19:11:14   6  where s.table_name like 'MV_LEDGER%'
19:11:14   7  order by 1,2
19:11:14   8  ;

                                          Num     Num
TABLE_NAME      COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2020  ACCOUNT                   999       1 NONE            18-NOV-20
                ACCOUNTING_PERIOD          15       1 NONE            18-NOV-20
                BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                CHARTFIELD1               999       1 NONE            18-NOV-20
                FISCAL_YEAR                 2       1 NONE            18-NOV-20
                POSTED_TOTAL_AMT      1527494       1 NONE            18-NOV-20
                SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                SYS_NC00008$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                SYS_NC00009$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                SYS_NC00010$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                SYS_NC00011$               15       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                )



11 rows selected.

Elapsed: 00:00:00.01
19:11:14 SQL> column extension format a40
19:11:14 SQL> select s.table_name, s.partition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
19:11:14   2  from user_part_col_statistics s
19:11:14   3  	LEFT OUTER JOIN user_stat_extensions e
19:11:14   4  	ON e.table_name = s.table_name
19:11:14   5  	AND e.extension_name = s.column_name
19:11:14   6  where s.table_name like 'MV_LEDGER%'
19:11:14   7  order by 1,2
19:11:14   8  ;

                                                               Num     Num
TABLE_NAME      PARTITION_NAME       COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- -------------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019          BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   999       1 NONE            18-NOV-20
                                     CHARTFIELD1               999       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD          15       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT       942016       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$               15       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )

                LEDGER_2020          BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                                     ACCOUNT                   998       1 NONE            18-NOV-20
                                     CHARTFIELD1               999       1 NONE            18-NOV-20
                                     FISCAL_YEAR                 1       1 NONE            18-NOV-20
                                     ACCOUNTING_PERIOD           8       1 NONE            18-NOV-20
                                     POSTED_TOTAL_AMT       579520       1 NONE            18-NOV-20
                                     SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                                     SYS_NC00008$              998       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                                     SYS_NC00009$              999       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                                     SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                                     SYS_NC00011$                8       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                     )



22 rows selected.

Elapsed: 00:00:00.28
19:11:14 SQL> 
19:11:14 SQL> column extension format a40
19:11:14 SQL> select s.table_name, s.subpartition_name, s.column_name, s.num_distinct, s.num_buckets, s.histogram, s.last_analyzed, e.extension
19:11:14   2  from user_subpart_col_statistics s
19:11:14   3  	LEFT OUTER JOIN user_stat_extensions e
19:11:14   4  	ON e.table_name = s.table_name
19:11:14   5  	AND e.extension_name = s.column_name
19:11:14   6  where s.table_name like 'MV_LEDGER%'
19:11:14   7  order by 1,2
19:11:14   8  ;

                                                                    Num     Num
TABLE_NAME      SUBPARTITION_NAME         COLUMN_NAME          Distinct Buckets HISTOGRAM       LAST_ANAL EXTENSION
--------------- ------------------------- -------------------- -------- ------- --------------- --------- ----------------------------------------
MV_LEDGER_2020  LEDGER_2019_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_01         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         POSTED_TOTAL_AMT        72834       1 NONE            18-NOV-20
                LEDGER_2019_AP_01         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_01         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_01         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_01         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_01         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_02         ACCOUNT                   995       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         CHARTFIELD1               996       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         POSTED_TOTAL_AMT        72863       1 NONE            18-NOV-20
                LEDGER_2019_AP_02         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_02         SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_02         SYS_NC00009$              996       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_02         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_02         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_03         ACCOUNT                   995       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         POSTED_TOTAL_AMT        72024       1 NONE            18-NOV-20
                LEDGER_2019_AP_03         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_03         SYS_NC00008$              995       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_03         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_03         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_03         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_04         ACCOUNT                   991       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         CHARTFIELD1               991       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         POSTED_TOTAL_AMT        72887       1 NONE            18-NOV-20
                LEDGER_2019_AP_04         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_04         SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_04         SYS_NC00009$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_04         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_04         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_05         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         POSTED_TOTAL_AMT        72378       1 NONE            18-NOV-20
                LEDGER_2019_AP_05         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_05         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_05         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_05         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_05         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_06         ACCOUNT                   990       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         POSTED_TOTAL_AMT        72101       1 NONE            18-NOV-20
                LEDGER_2019_AP_06         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_06         SYS_NC00008$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_06         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_06         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_06         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_07         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_07         ACCOUNT                   989       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         POSTED_TOTAL_AMT        72801       1 NONE            18-NOV-20
                LEDGER_2019_AP_07         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_07         SYS_NC00008$              989       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_07         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_07         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_07         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_08         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_08         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         POSTED_TOTAL_AMT        72386       1 NONE            18-NOV-20
                LEDGER_2019_AP_08         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_08         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_08         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_08         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_08         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_09         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_09         ACCOUNT                   990       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         POSTED_TOTAL_AMT        72809       1 NONE            18-NOV-20
                LEDGER_2019_AP_09         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_09         SYS_NC00008$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_09         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_09         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_09         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_10         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_10         ACCOUNT                   990       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         POSTED_TOTAL_AMT        72648       1 NONE            18-NOV-20
                LEDGER_2019_AP_10         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_10         SYS_NC00008$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_10         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_10         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_10         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_11         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_11         ACCOUNT                   991       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         POSTED_TOTAL_AMT        72624       1 NONE            18-NOV-20
                LEDGER_2019_AP_11         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_11         SYS_NC00008$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_11         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_11         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_11         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_12         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_12         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         CHARTFIELD1               990       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         POSTED_TOTAL_AMT        72112       1 NONE            18-NOV-20
                LEDGER_2019_AP_12         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_12         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_12         SYS_NC00009$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_12         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_12         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_BF         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         POSTED_TOTAL_AMT        71176       1 NONE            18-NOV-20
                LEDGER_2019_AP_BF         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_BF         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_BF         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_BF         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_BF         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2019_AP_CF         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2019_AP_CF         ACCOUNT                   752       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         CHARTFIELD1               764       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         ACCOUNTING_PERIOD           2       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         POSTED_TOTAL_AMT         2000       1 NONE            18-NOV-20
                LEDGER_2019_AP_CF         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2019_AP_CF         SYS_NC00008$              752       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2019_AP_CF         SYS_NC00009$              764       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2019_AP_CF         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2019_AP_CF         SYS_NC00011$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_01         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_01         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         POSTED_TOTAL_AMT        72744       1 NONE            18-NOV-20
                LEDGER_2020_AP_01         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_01         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_01         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_01         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_01         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_02         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_02         ACCOUNT                   993       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         CHARTFIELD1               998       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         POSTED_TOTAL_AMT        72207       1 NONE            18-NOV-20
                LEDGER_2020_AP_02         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_02         SYS_NC00008$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_02         SYS_NC00009$              998       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_02         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_02         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_03         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_03         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         CHARTFIELD1               992       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         POSTED_TOTAL_AMT        72650       1 NONE            18-NOV-20
                LEDGER_2020_AP_03         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_03         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_03         SYS_NC00009$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_03         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_03         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_04         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_04         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         CHARTFIELD1               990       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         POSTED_TOTAL_AMT        72523       1 NONE            18-NOV-20
                LEDGER_2020_AP_04         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_04         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_04         SYS_NC00009$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_04         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_04         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_05         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_05         ACCOUNT                   990       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         CHARTFIELD1               991       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         POSTED_TOTAL_AMT        73026       1 NONE            18-NOV-20
                LEDGER_2020_AP_05         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_05         SYS_NC00008$              990       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_05         SYS_NC00009$              991       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_05         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_05         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_06         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_06         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         POSTED_TOTAL_AMT        72488       1 NONE            18-NOV-20
                LEDGER_2020_AP_06         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_06         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_06         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_06         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_06         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_07         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_07         ACCOUNT                   992       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         CHARTFIELD1               994       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         POSTED_TOTAL_AMT        71992       1 NONE            18-NOV-20
                LEDGER_2020_AP_07         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_07         SYS_NC00008$              992       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_07         SYS_NC00009$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_07         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_07         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_08         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_08         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_08         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_08         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_08         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_08         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_09         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_09         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_09         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_09         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_09         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_09         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_10         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_10         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_10         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_10         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_10         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_10         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_11         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_11         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_11         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_11         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_11         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_11         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_12         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_12         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_12         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_12         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_12         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_12         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_BF         BUSINESS_UNIT               2       2 FREQUENCY       18-NOV-20
                LEDGER_2020_AP_BF         ACCOUNT                   994       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         CHARTFIELD1               993       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         FISCAL_YEAR                 1       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         ACCOUNTING_PERIOD           1       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         POSTED_TOTAL_AMT        72371       1 NONE            18-NOV-20
                LEDGER_2020_AP_BF         SYS_NC00007$                2       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_BF         SYS_NC00008$              994       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_BF         SYS_NC00009$              993       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_BF         SYS_NC00010$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_BF         SYS_NC00011$                1       1 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )

                LEDGER_2020_AP_CF         BUSINESS_UNIT               0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         ACCOUNT                     0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         CHARTFIELD1                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         FISCAL_YEAR                 0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         ACCOUNTING_PERIOD           0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         POSTED_TOTAL_AMT            0       0 NONE            18-NOV-20
                LEDGER_2020_AP_CF         SYS_NC00007$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("BUSINESS_UNIT"))
                LEDGER_2020_AP_CF         SYS_NC00008$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNT"))
                LEDGER_2020_AP_CF         SYS_NC00009$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("CHARTFIELD1"))
                LEDGER_2020_AP_CF         SYS_NC00010$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("FISCAL_YEAR"))
                LEDGER_2020_AP_CF         SYS_NC00011$                0       0 NONE            18-NOV-20 (SYS_OP_MAP_NONNULL("ACCOUNTING_PERIOD")
                                                                                                          )



308 rows selected.

Elapsed: 00:00:00.19
19:11:15 SQL> @@mvsql
19:11:15 SQL> REM mvsql.sql
19:11:15 SQL> set autotrace off
19:11:15 SQL> 
19:11:15 SQL> REM 2018
19:11:15 SQL> set lines 200 pages 999
19:11:15 SQL> explain plan for
19:11:15   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:11:15   3  FROM   PS_LEDGER A
19:11:15   4  ,      PSTREESELECT05 L1
19:11:15   5  ,      PSTREESELECT10 L
19:11:15   6  ,      PSTREESELECT10 L2
19:11:15   7  WHERE  A.LEDGER='ACTUALS'
19:11:15   8  AND    A.FISCAL_YEAR=2018
19:11:15   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
19:11:15  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:11:15  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:11:15  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:11:15  13  AND    A.CURRENCY_CD='GBP'
19:11:15  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:11:15  15  /

Explained.

Elapsed: 00:00:00.15
19:11:15 SQL> @@xp
19:11:15 SQL> REM xp.sql
19:11:15 SQL> REM spool xp
19:11:15 SQL> REM set pages 9999 lines 200 autotrace off
19:11:15 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3827045647

------------------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                   |  1079 |    97K|  2234   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY               |                   |  1079 |    97K|  2234   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                  |                   |  1079 |    97K|  2233   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN          | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                 |                   |  4197 |   303K|  2231   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN     |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN        | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT             |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN       | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE   |                   | 39970 |  1756K|  2228   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR|                   | 39970 |  1756K|  2228   (1)| 00:00:01 |     2 |     7 |
|* 11 |       TABLE ACCESS FULL      | PS_LEDGER         | 39970 |  1756K|  2228   (1)| 00:00:01 |     1 |    14 |
------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
   3 - SEL$1 / L2@SEL$1
   6 - SEL$1 / L1@SEL$1
   8 - SEL$1 / L@SEL$1
  11 - SEL$1 / A@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      SWAP_JOIN_INPUTS(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "L2"@"SEL$1")
      USE_HASH(@"SEL$1" "A"@"SEL$1")
      USE_MERGE_CARTESIAN(@"SEL$1" "L"@"SEL$1")
      LEADING(@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "A"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1" "A"@"SEL$1")
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("A"."ACCOUNTING_PERIOD"<=6 AND "A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2018 AND
              "A"."CURRENCY_CD"='GBP')

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDAT
        A[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L
        2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


72 rows selected.

Elapsed: 00:00:00.14
19:11:15 SQL> REM spool off
19:11:15 SQL> 
19:11:15 SQL> REM 2019
19:11:15 SQL> explain plan for
19:11:15   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:11:15   3  FROM   PS_LEDGER A
19:11:15   4  ,      PSTREESELECT05 L1
19:11:15   5  ,      PSTREESELECT10 L
19:11:15   6  ,      PSTREESELECT10 L2
19:11:15   7  WHERE  A.LEDGER='ACTUALS'
19:11:15   8  AND    A.FISCAL_YEAR=2019
19:11:15   9  AND    A.ACCOUNTING_PERIOD BETWEEN 1 AND 6
19:11:15  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:11:15  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:11:15  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:11:15  13  AND    A.CURRENCY_CD='GBP'
19:11:15  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:11:15  15  /

Explained.

Elapsed: 00:00:00.24
19:11:15 SQL> @@xp
19:11:15 SQL> REM xp.sql
19:11:15 SQL> REM spool xp
19:11:15 SQL> REM set pages 9999 lines 200 autotrace off
19:11:15 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 589110139

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  1860 |   147K|   426   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  1860 |   147K|   426   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  1860 |   147K|   425   (1)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  7229 |   437K|   423   (1)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 68783 |  2216K|   420   (1)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE ITERATOR     |                   | 68783 |  2216K|   420   (1)| 00:00:01 |     2 |     7 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 68783 |  2216K|   420   (1)| 00:00:01 |     1 |    14 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.13
19:11:15 SQL> REM spool off
19:11:15 SQL> 
19:11:15 SQL> REM 2020
19:11:15 SQL> explain plan for
19:11:15   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:11:15   3  FROM   PS_LEDGER A
19:11:15   4  ,      PSTREESELECT05 L1
19:11:15   5  ,      PSTREESELECT10 L
19:11:15   6  ,      PSTREESELECT10 L2
19:11:15   7  WHERE  A.LEDGER='ACTUALS'
19:11:15   8  AND    A.FISCAL_YEAR=2020
19:11:15   9  AND    (A.ACCOUNTING_PERIOD BETWEEN 1 AND 6)
19:11:15  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:11:15  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:11:15  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:11:15  13  AND    A.CURRENCY_CD='GBP'
19:11:15  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:11:15  15  /

Explained.

Elapsed: 00:00:00.32
19:11:16 SQL> @@xp
19:11:16 SQL> REM xp.sql
19:11:16 SQL> REM spool xp
19:11:16 SQL> REM set pages 9999 lines 200 autotrace off
19:11:16 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 589110139

-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   | 15164 |  1199K|       |   711   (1)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   | 15164 |  1199K|  1392K|   711   (1)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   | 15164 |  1199K|       |   422   (2)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |       |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   | 58887 |  3565K|       |   420   (2)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |       |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |       |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |       |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |       |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   |   560K|    17M|       |   415   (1)| 00:00:01 |     2 |     2 |
|  10 |      PARTITION RANGE ITERATOR     |                   |   560K|    17M|       |   415   (1)| 00:00:01 |     2 |     7 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    |   560K|    17M|       |   415   (1)| 00:00:01 |    15 |    28 |
-------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"<=6 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2020)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER
        _2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]><
        /s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4
        ]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDA
        TA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s>
        </h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020]]></v><
        /o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t>
        <![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[SEL$5272D5B4]]></s></h></
        f></q>


84 rows selected.

Elapsed: 00:00:00.14
19:11:16 SQL> REM spool off
19:11:16 SQL> 
19:11:16 SQL> explain plan for
19:11:16   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:11:16   3  FROM   PS_LEDGER A
19:11:16   4  ,      PSTREESELECT05 L1
19:11:16   5  ,      PSTREESELECT10 L
19:11:16   6  ,      PSTREESELECT10 L2
19:11:16   7  WHERE  A.LEDGER='ACTUALS'
19:11:16   8  AND    A.FISCAL_YEAR=2019
19:11:16   9  AND    A.ACCOUNTING_PERIOD = 7
19:11:16  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:11:16  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:11:16  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:11:16  13  AND    A.CURRENCY_CD='GBP'
19:11:16  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:11:16  15  /

Explained.

Elapsed: 00:00:00.27
19:11:16 SQL> @@xp
19:11:16 SQL> REM xp.sql
19:11:16 SQL> REM spool xp
19:11:16 SQL> REM set pages 9999 lines 200 autotrace off
19:11:16 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 3667645850

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                   |  2000 |   158K|    78   (3)| 00:00:01 |       |       |
|   1 |  HASH GROUP BY                    |                   |  2000 |   158K|    78   (3)| 00:00:01 |       |       |
|*  2 |   HASH JOIN                       |                   |  2000 |   158K|    76   (0)| 00:00:01 |       |       |
|*  3 |    INDEX RANGE SCAN               | PS_PSTREESELECT10 |   257 |  4883 |     2   (0)| 00:00:01 |       |       |
|*  4 |    HASH JOIN                      |                   |  7698 |   466K|    74   (0)| 00:00:01 |       |       |
|   5 |     MERGE JOIN CARTESIAN          |                   |   210 |  6090 |     3   (0)| 00:00:01 |       |       |
|*  6 |      INDEX RANGE SCAN             | PS_PSTREESELECT05 |     2 |    22 |     1   (0)| 00:00:01 |       |       |
|   7 |      BUFFER SORT                  |                   |   105 |  1890 |     2   (0)| 00:00:01 |       |       |
|*  8 |       INDEX RANGE SCAN            | PS_PSTREESELECT10 |   105 |  1890 |     1   (0)| 00:00:01 |       |       |
|   9 |     PARTITION RANGE SINGLE        |                   | 72801 |  2346K|    71   (0)| 00:00:01 |     1 |     1 |
|  10 |      PARTITION RANGE SINGLE       |                   | 72801 |  2346K|    71   (0)| 00:00:01 |     8 |     8 |
|* 11 |       MAT_VIEW REWRITE ACCESS FULL| MV_LEDGER_2020    | 72801 |  2346K|    71   (0)| 00:00:01 |     8 |     8 |
-----------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1E60250C
   3 - SEL$1E60250C / L2@SEL$1
   6 - SEL$1E60250C / L1@SEL$1
   8 - SEL$1E60250C / L@SEL$1
  11 - SEL$1E60250C / MV_LEDGER_2020@SEL$5272D5B4

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1E60250C")
      SWAP_JOIN_INPUTS(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "L2"@"SEL$1")
      USE_HASH(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      USE_MERGE_CARTESIAN(@"SEL$1E60250C" "L"@"SEL$1")
      LEADING(@"SEL$1E60250C" "L1"@"SEL$1" "L"@"SEL$1" "MV_LEDGER_2020"@"SEL$5272D5B4" "L2"@"SEL$1")
      INDEX(@"SEL$1E60250C" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      FULL(@"SEL$1E60250C" "MV_LEDGER_2020"@"SEL$5272D5B4")
      INDEX(@"SEL$1E60250C" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM"
              "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1E60250C" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM"
              "PSTREESELECT05"."RANGE_FROM_05"))
      OUTLINE(@"SEL$1")
      REWRITE(@"SEL$1" "MV_LEDGER_2020")
      OUTLINE(@"SEL$68C95E58")
      REWRITE(@"SEL$68C95E58" "MV_LEDGER_2020")
      OUTLINE_LEAF(@"SEL$1E60250C")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("MV_LEDGER_2020"."ACCOUNT"="L2"."RANGE_FROM_10")
   3 - access("L2"."SELECTOR_NUM"=30984)
   4 - access("MV_LEDGER_2020"."BUSINESS_UNIT"="L1"."RANGE_FROM_05" AND
              "MV_LEDGER_2020"."CHARTFIELD1"="L"."RANGE_FROM_10")
   6 - access("L1"."SELECTOR_NUM"=30982)
   8 - access("L"."SELECTOR_NUM"=30985)
  11 - filter("MV_LEDGER_2020"."ACCOUNTING_PERIOD"=7 AND "MV_LEDGER_2020"."FISCAL_YEAR"=2019)

Query Block Registry:
---------------------

  <q o="6" f="y" h="y"><n><![CDATA[SEL$1E60250C]]></n><p><![CDATA[SEL$68C95E58]]></p><i><o><t>MV</t><v><![CDATA[M
        V_LEDGER_2020]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><!
        [CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t>
        <s><![CDATA[SEL$5272D5B4]]></s></h></f></q>
  <q o="2"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><
        s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CD
        ATA[SEL$1]]></s></h></f></q>
  <q o="6" h="y"><n><![CDATA[SEL$68C95E58]]></n><p><![CDATA[SEL$1]]></p><i><o><t>MV</t><v><![CDATA[MV_LEDGER_2020
        ]]></v></o></i><f><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]
        ]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[MV_LEDGER_2020]]></t><s><![CDATA[S
        EL$5272D5B4]]></s></h></f></q>


84 rows selected.

Elapsed: 00:00:00.16
19:11:16 SQL> REM spool off
19:11:16 SQL> 
19:11:16 SQL> REM 2020
19:11:16 SQL> explain plan for
19:11:16   2  SELECT L.TREE_NODE_NUM,L2.TREE_NODE_NUM,SUM(A.POSTED_TOTAL_AMT)
19:11:16   3  FROM   PS_LEDGER A
19:11:16   4  ,      PSTREESELECT05 L1
19:11:16   5  ,      PSTREESELECT10 L
19:11:16   6  ,      PSTREESELECT10 L2
19:11:16   7  WHERE  A.LEDGER='ACTUALS'
19:11:16   8  AND    A.FISCAL_YEAR=2020
19:11:16   9  AND    (A.ACCOUNTING_PERIOD = 7)
19:11:16  10  AND    L1.SELECTOR_NUM=30982 AND A.BUSINESS_UNIT=L1.RANGE_FROM_05
19:11:16  11  AND    L.SELECTOR_NUM=30985 AND A.CHARTFIELD1=L.RANGE_FROM_10
19:11:16  12  AND    L2.SELECTOR_NUM=30984 AND A.ACCOUNT=L2.RANGE_FROM_10
19:11:16  13  AND    A.CURRENCY_CD='GBP'
19:11:16  14  GROUP BY L.TREE_NODE_NUM,L2.TREE_NODE_NUM
19:11:16  15  /

Explained.

Elapsed: 00:00:00.28
19:11:17 SQL> @@xp
19:11:17 SQL> REM xp.sql
19:11:17 SQL> REM spool xp
19:11:17 SQL> REM set pages 9999 lines 200 autotrace off
19:11:17 SQL> select * from table(dbms_xplan.display(null,null,'ADVANCED -PROJECTION +ADAPTIVE'));

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Plan hash value: 1321682226

---------------------------------------------------------------------------------------------------------------------------------------------
|   Id  | Operation                                             | Name              | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------------------------
|     0 | SELECT STATEMENT                                      |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|     1 |  HASH GROUP BY                                        |                   |     1 |    92 |     7  (15)| 00:00:01 |       |       |
|- *  2 |   HASH JOIN                                           |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|     3 |    NESTED LOOPS                                       |                   |     1 |    92 |     6   (0)| 00:00:01 |       |       |
|-    4 |     STATISTICS COLLECTOR                              |                   |       |       |            |          |       |       |
|- *  5 |      HASH JOIN                                        |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|     6 |       NESTED LOOPS                                    |                   |     1 |    73 |     5   (0)| 00:00:01 |       |       |
|-    7 |        STATISTICS COLLECTOR                           |                   |       |       |            |          |       |       |
|- *  8 |         HASH JOIN                                     |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|     9 |          NESTED LOOPS                                 |                   |     1 |    55 |     4   (0)| 00:00:01 |       |       |
|-   10 |           STATISTICS COLLECTOR                        |                   |       |       |            |          |       |       |
|    11 |            PARTITION RANGE SINGLE                     |                   |     1 |    44 |     3   (0)| 00:00:01 |     3 |     3 |
|    12 |             PARTITION RANGE SINGLE                    |                   |     1 |    44 |     3   (0)| 00:00:01 |     8 |     8 |
|  * 13 |              TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| PS_LEDGER         |     1 |    44 |     3   (0)| 00:00:01 |    36 |    36 |
|  * 14 |               INDEX RANGE SCAN                        | PSXLEDGER         |     1 |       |     2   (0)| 00:00:01 |    36 |    36 |
|  * 15 |           INDEX RANGE SCAN                            | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|- * 16 |          INDEX RANGE SCAN                             | PS_PSTREESELECT05 |     1 |    11 |     1   (0)| 00:00:01 |       |       |
|  * 17 |        INDEX RANGE SCAN                               | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|- * 18 |       INDEX RANGE SCAN                                | PS_PSTREESELECT10 |     1 |    18 |     1   (0)| 00:00:01 |       |       |
|  * 19 |     INDEX RANGE SCAN                                  | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
|- * 20 |    INDEX RANGE SCAN                                   | PS_PSTREESELECT10 |     1 |    19 |     1   (0)| 00:00:01 |       |       |
---------------------------------------------------------------------------------------------------------------------------------------------

Query Block Name / Object Alias (identified by operation id):
-------------------------------------------------------------

   1 - SEL$1
  13 - SEL$1 / A@SEL$1
  14 - SEL$1 / A@SEL$1
  15 - SEL$1 / L1@SEL$1
  16 - SEL$1 / L1@SEL$1
  17 - SEL$1 / L@SEL$1
  18 - SEL$1 / L@SEL$1
  19 - SEL$1 / L2@SEL$1
  20 - SEL$1 / L2@SEL$1

Outline Data
-------------

  /*+
      BEGIN_OUTLINE_DATA
      USE_HASH_AGGREGATION(@"SEL$1")
      USE_NL(@"SEL$1" "L2"@"SEL$1")
      USE_NL(@"SEL$1" "L"@"SEL$1")
      USE_NL(@"SEL$1" "L1"@"SEL$1")
      LEADING(@"SEL$1" "A"@"SEL$1" "L1"@"SEL$1" "L"@"SEL$1" "L2"@"SEL$1")
      INDEX(@"SEL$1" "L2"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L"@"SEL$1" ("PSTREESELECT10"."SELECTOR_NUM" "PSTREESELECT10"."TREE_NODE_NUM" "PSTREESELECT10"."RANGE_FROM_10"))
      INDEX(@"SEL$1" "L1"@"SEL$1" ("PSTREESELECT05"."SELECTOR_NUM" "PSTREESELECT05"."TREE_NODE_NUM" "PSTREESELECT05"."RANGE_FROM_05"))
      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1" "A"@"SEL$1")
      INDEX_RS_ASC(@"SEL$1" "A"@"SEL$1" ("PS_LEDGER"."LEDGER" "PS_LEDGER"."FISCAL_YEAR" "PS_LEDGER"."ACCOUNTING_PERIOD"
              "PS_LEDGER"."BUSINESS_UNIT" "PS_LEDGER"."ACCOUNT" "PS_LEDGER"."CHARTFIELD1"))
      OUTLINE_LEAF(@"SEL$1")
      ALL_ROWS
      DB_VERSION('19.1.0')
      OPTIMIZER_FEATURES_ENABLE('19.1.0')
      IGNORE_OPTIM_EMBEDDED_HINTS
      END_OUTLINE_DATA
  */

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("A"."ACCOUNT"="L2"."RANGE_FROM_10")
   5 - access("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
   8 - access("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  13 - filter("A"."CURRENCY_CD"='GBP')
  14 - access("A"."LEDGER"='ACTUALS' AND "A"."FISCAL_YEAR"=2020 AND "A"."ACCOUNTING_PERIOD"=7)
  15 - access("L1"."SELECTOR_NUM"=30982 AND "A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
       filter("A"."BUSINESS_UNIT"="L1"."RANGE_FROM_05")
  16 - access("L1"."SELECTOR_NUM"=30982)
  17 - access("L"."SELECTOR_NUM"=30985 AND "A"."CHARTFIELD1"="L"."RANGE_FROM_10")
       filter("A"."CHARTFIELD1"="L"."RANGE_FROM_10")
  18 - access("L"."SELECTOR_NUM"=30985)
  19 - access("L2"."SELECTOR_NUM"=30984 AND "A"."ACCOUNT"="L2"."RANGE_FROM_10")
       filter("A"."ACCOUNT"="L2"."RANGE_FROM_10")
  20 - access("L2"."SELECTOR_NUM"=30984)

Note
-----
   - this is an adaptive plan (rows marked '-' are inactive)

Query Block Registry:
---------------------

  <q o="2" f="y"><n><![CDATA[SEL$1]]></n><f><h><t><![CDATA[A]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L]]></t><s><![CDATA[SEL$1
        ]]></s></h><h><t><![CDATA[L1]]></t><s><![CDATA[SEL$1]]></s></h><h><t><![CDATA[L2]]></t><s><![CDATA[SEL$1]]></s></h></f></q>


93 rows selected.

Elapsed: 00:00:00.18
19:11:17 SQL> REM spool off
19:11:17 SQL> 
19:11:17 SQL> set autotrace off
19:11:17 SQL> @@mvcap
19:11:17 SQL> REM mvcap.sql
19:11:17 SQL> REM spool mvcap
19:11:17 SQL> set autotrace off
19:11:17 SQL> create table MV_CAPABILITIES_TABLE
19:11:17   2  (
19:11:17   3  	statement_id	  varchar(30) ,
19:11:17   4  	mvowner 	  varchar(30) ,
19:11:17   5  	mvname		  varchar(30) ,
19:11:17   6  	capability_name   varchar(30) ,
19:11:17   7  	possible	  character(1) ,
19:11:17   8  	related_text	  varchar(2000) ,
19:11:17   9  	related_num	  number ,
19:11:17  10  	msgno		  integer ,
19:11:17  11  	msgtxt		  varchar(2000) ,
19:11:17  12  	seq		  number
19:11:17  13  ) ;
create table MV_CAPABILITIES_TABLE
             *
ERROR at line 1:
ORA-00955: name is already used by an existing object


Elapsed: 00:00:00.00
19:11:17 SQL> 
19:11:17 SQL> truncate table MV_CAPABILITIES_TABLE;

Table truncated.

Elapsed: 00:00:00.04
19:11:17 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2019');
BEGIN DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2019'); END;

*
ERROR at line 1:
ORA-20000: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_IREFRESH", line 186
ORA-06512: at "SYS.DBMS_SNAPSHOT_KKXRCA", line 3952
ORA-06512: at "SYS.DBMS_SNAPSHOT", line 234
ORA-06512: at line 1


Elapsed: 00:00:00.00
19:11:17 SQL> EXECUTE DBMS_MVIEW.EXPLAIN_MVIEW ('SCOTT.MV_LEDGER_2020');

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.39
19:11:17 SQL> break on mvname skip 1
19:11:17 SQL> column rel_text format a20
19:11:17 SQL> column msgtxt format a60
19:11:17 SQL> SELECT mvname, capability_name,  possible, SUBSTR(related_text,1,20) AS rel_text, SUBSTR(msgtxt,1,60) AS msgtxt
19:11:17   2  FROM MV_CAPABILITIES_TABLE
19:11:17   3  WHERE mvname like 'MV_LEDGER_20%'
19:11:17   4  ORDER BY mvname, seq;

MVNAME                         CAPABILITY_NAME                P REL_TEXT             MSGTXT
------------------------------ ------------------------------ - -------------------- ------------------------------------------------------------
MV_LEDGER_2020                 PCT                            Y
                               REFRESH_COMPLETE               Y
                               REFRESH_FAST                   Y
                               REWRITE                        Y
                               PCT_TABLE                      Y PS_LEDGER
                               REFRESH_FAST_AFTER_INSERT      N SCOTT.PS_LEDGER      the detail table does not have a materialized view log
                               REFRESH_FAST_AFTER_ONETAB_DML  N POSTED_TOTAL_AMT     SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      see the reason why REFRESH_FAST_AFTER_INSERT is disabled
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      COUNT(*) is not present in the select list
                               REFRESH_FAST_AFTER_ONETAB_DML  N                      SUM(expr) without COUNT(expr)
                               REFRESH_FAST_AFTER_ANY_DML     N                      see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
                               REFRESH_FAST_PCT               Y
                               REWRITE_FULL_TEXT_MATCH        Y
                               REWRITE_PARTIAL_TEXT_MATCH     Y
                               REWRITE_GENERAL                Y
                               REWRITE_PCT                    Y
                               PCT_TABLE_REWRITE              Y PS_LEDGER


17 rows selected.

Elapsed: 00:00:00.01
19:11:17 SQL> 
19:11:17 SQL> REM spool off
19:11:17 SQL> SPOOL OFF
